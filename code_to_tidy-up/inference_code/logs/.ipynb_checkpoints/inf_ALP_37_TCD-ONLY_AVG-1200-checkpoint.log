unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/37.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/37.txt
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T11:22:01.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0.zip
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:22:01.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:22:01.831    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094906-049_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0/SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0.zip
run script
2024-01-09T11:23:01.914    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:01.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0.zip
2024-01-09T11:23:01.915    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:01.916    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094916-106_L1C_049-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0/SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T11:23:36.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:36.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0.zip
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:36.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094921-520_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0/SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0.zip
run script
2024-01-09T11:24:07.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0.zip
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:07.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:07.118    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:07.118    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:07.118    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:24:31.905    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 52). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094943-647_L1C_050-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0/SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0.zip
run script
2024-01-09T11:24:35.475    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0.zip
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:35.476    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:35.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:35.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:35.477    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120402-094945-452_L1C_050-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0/SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0.zip
run script
2024-01-09T11:24:58.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:58.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0.zip
2024-01-09T11:24:58.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:58.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:25:28.961    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 67). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094943-494_L1C_050-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0/SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T11:25:32.449    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0.zip
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:25:32.450    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:25:32.451    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:25:32.451    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:25:32.451    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094946-376_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/02/SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0/SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0.zip
run script
2024-01-09T11:26:01.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:26:01.692    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0.zip
2024-01-09T11:26:01.692    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:26:01.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:26:01.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:26:01.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:26:01.693    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:26:01.693    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:26:01.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:26:01.693    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120402-094950-888_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T11:26:21.071    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0.zip
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:26:21.072    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093256-145_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0/SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0.zip
run script
2024-01-09T11:27:08.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:08.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0.zip
2024-01-09T11:27:08.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:08.116    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:08.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:08.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:08.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:08.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:08.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:08.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093319-233_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:28:12.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:12.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:12.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:12.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:12.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093321-134_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T11:29:05.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:06.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0.zip
2024-01-09T11:29:06.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:06.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:06.001    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093329-361_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T11:29:52.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:52.361    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0.zip
2024-01-09T11:29:52.361    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:52.362    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093337-597_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T11:30:21.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0.zip
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:21.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:21.894    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:21.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:21.894    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093356-305_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T11:30:25.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0.zip
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:25.609    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093356-154_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0/SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0.zip
run script
2024-01-09T11:30:28.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:28.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0.zip
2024-01-09T11:30:28.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:28.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:28.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:28.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:28.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:28.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:28.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:28.665    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093251-267_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T11:30:31.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0.zip
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:31.801    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:31.802    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:31.802    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:31.802    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093254-949_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0/SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0.zip
run script
2024-01-09T11:31:27.846    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:27.846    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0.zip
2024-01-09T11:31:27.846    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:27.846    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:27.846    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:27.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:27.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:27.847    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:27.847    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:27.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120604-093304-057_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:34:27.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:34:27.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:34:27.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:36:22.814    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 247). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093319-750_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:36:25.886    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:25.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:36:25.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:25.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:25.888    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093327-986_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/04/SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0/SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T11:38:57.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0.zip
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:38:57.878    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:40:50.844    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (202 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120604-093337-130_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/06/07/SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0/SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T11:40:54.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0.zip
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:40:54.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101515-955_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/07/SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T11:43:17.768    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0.zip
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:43:17.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:43:17.770    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101519-008_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/07/SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T11:46:03.972    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0.zip
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:03.974    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:47:52.926    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (168 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101527-478_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/06/07/SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:47:56.943    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:56.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101535-952_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/07/SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T11:49:24.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0.zip
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:24.138    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:24.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120607-101544-431_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/10/SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0/SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0.zip
run script
2024-01-09T11:50:24.120    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:50:24.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0.zip
2024-01-09T11:50:24.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:50:24.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:50:24.122    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093816-324_L1C_049-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/10/SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:51:58.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:51:58.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:53:35.227    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 918). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093833-933_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/07/10/SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0/SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T11:53:38.819    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0.zip
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:38.820    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120710-093835-738_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0/SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0.zip
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:55:25.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:55:25.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:55:25.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:55:25.023    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092925-170_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T11:56:56.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0.zip
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:56:56.958    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092911-531_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0/SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0.zip
run script
2024-01-09T11:57:01.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0.zip
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:01.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:01.349    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:01.349    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:01.349    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092915-141_L1C_050-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T11:57:05.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0.zip
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:05.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092942-350_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:59:59.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:59.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:59:59.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:59.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:59.223    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:01:55.385    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 248). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-092944-257_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0/SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T12:01:59.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0.zip
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:59.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:59.917    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:03:45.958    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (400 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-613_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:50.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:05:35.190    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (400 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093000-734_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:05:39.561    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:39.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:05:39.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:39.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:39.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:39.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:39.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:39.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:39.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:39.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120726-093008-985_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0/SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0.zip
run script
2024-01-09T12:07:23.274    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0.zip
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:23.275    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:23.276    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-456_L1C_052-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T12:09:46.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0.zip
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:09:46.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092942-570_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/26/SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0/SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0.zip
run script
2024-01-09T12:12:09.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0.zip
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:09.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120726-092943-472_L1C_052-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0/SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0.zip
run script
2024-01-09T12:14:29.200    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0.zip
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:29.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095758-617_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:15:17.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:17.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095805-102_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:15:49.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:49.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:15:49.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:49.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:49.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095813-401_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:16:05.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:05.686    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095821-709_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T12:16:09.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:09.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0.zip
2024-01-09T12:16:09.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:09.229    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095823-514_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:16:12.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:12.665    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120317-095839-759_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/17/SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:16:16.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:16.301    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120317-095839-600_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0/SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0.zip
run script
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0.zip
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:19.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093844-440_L1C_049-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:17:01.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:01.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:01.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:01.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:01.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093850-871_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:17:35.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:35.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:17:35.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:35.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:35.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093859-116_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0/SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T12:17:53.219    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0.zip
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:53.221    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093901-823_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:18:07.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:07.839    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120514-093917-435_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/14/SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:18:11.473    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:11.474    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:11.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:11.475    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:11.475    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120514-093917-288_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/28/SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0/SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0.zip
run script
2024-01-09T12:18:15.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0.zip
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:15.312    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100844-302_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/28/SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:19:21.066    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:19:21.067    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100845-496_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/28/SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:20:22.627    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:22.629    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100853-916_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/28/SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:20:59.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:59.539    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120528-100912-797_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/28/SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:21:03.144    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:03.146    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120528-100912-572_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/04/11/SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:21:06.343    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:06.344    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:06.345    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:06.345    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:06.345    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101548-565_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/11/SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T12:21:46.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:46.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0.zip
2024-01-09T12:21:46.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:46.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:46.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:46.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:46.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:46.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:46.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:46.429    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120411-101553-077_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/01/SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0/SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T12:22:11.088    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0.zip
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:11.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093636-919_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/01/SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:22:42.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:42.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093639-779_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/01/SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:23:05.745    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:05.747    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121001-093658-307_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/10/01/SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:23:09.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:09.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:23:09.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:09.132    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121001-093658-156_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/11/16/SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0/SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0.zip
run script
2024-01-09T12:23:12.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:12.557    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0.zip
2024-01-09T12:23:12.557    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:12.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:12.558    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094828-545_L1C_049-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/16/SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:23:35.070    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:35.071    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:23:35.071    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:35.071    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:35.072    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:23:37.451    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (914 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094835-094_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2012/11/16/SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0/SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T12:23:40.923    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:40.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0.zip
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:40.925    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121116-094837-801_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/11/11/SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0/SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0.zip
run script
2024-01-09T12:23:44.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0.zip
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:44.314    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121111-094514-812_L1C_049-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0/SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0.zip
run script
2024-01-09T12:23:47.874    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0.zip
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:47.876    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095010-786_L1C_049-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0/SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0.zip
run script
2024-01-09T12:23:58.524    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0.zip
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:23:58.525    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:23:58.526    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:23:58.526    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:23:58.526    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-582_L1C_049-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0/SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:24:18.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:18.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:24:18.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:18.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:18.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095011-054_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0/SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T12:24:29.525    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0.zip
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:29.526    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:29.527    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:29.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:29.527    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095010-855_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:24:47.622    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:47.623    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121217-095019-452_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/17/SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:24:51.069    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:51.070    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121217-095019-254_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T12:24:56.214    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:56.215    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0.zip
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:56.216    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101032-089_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0/SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T12:24:59.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0.zip
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:59.592    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101036-134_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:25:02.873    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:02.874    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101037-036_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:25:06.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:06.235    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101035-046_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:25:09.598    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:09.600    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120109-101036-850_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:25:13.185    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:13.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:25:13.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:13.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:13.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:25:45.322    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 230). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101012-771_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/01/09/SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T12:25:48.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0.zip
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:48.799    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120109-101021-194_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/19/SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0/SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0.zip
run script
2024-01-09T12:28:49.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0.zip
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:49.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:49.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:49.605    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094245-281_L1C_049-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/19/SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:28:53.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:53.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:28:53.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:53.034    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120519-094247-239_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/08/SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0/SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:28:56.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:56.466    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-658_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/08/SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:28:59.964    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:59.965    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-507_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/08/SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:03.476    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:03.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:03.478    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:03.478    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:03.478    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121208-092357-796_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/08/SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:06.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:06.943    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092357-646_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/08/SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:29:10.360    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:10.361    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:29:10.361    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:10.361    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:10.362    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121208-092359-450_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0/SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:29:13.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:13.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:29:13.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:13.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:13.909    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-598_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:29:17.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:17.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:29:17.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:17.639    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-412_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:21.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:21.136    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094650-845_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:24.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:24.498    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121212-094650-664_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T12:29:27.967    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0.zip
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:27.969    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094542-279_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/12/SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0/SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0.zip
run script
2024-01-09T12:29:31.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:31.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0.zip
2024-01-09T12:29:31.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:31.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:31.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:31.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:31.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:31.697    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:31.697    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:31.697    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121212-094546-791_L1C_051-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/18/SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0/SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:35.791    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-442_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/18/SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T12:29:39.170    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:39.171    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0.zip
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:39.172    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-292_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/18/SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:42.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:42.540    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:42.541    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121218-093056-607_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/18/SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:29:45.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:45.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:45.978    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093056-457_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/18/SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:29:49.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:49.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:49.408    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121218-093058-262_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/04/SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:29:52.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:52.988    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100701-466_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/04/SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T12:29:56.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0.zip
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:56.270    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100700-391_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/04/SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:59.820    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:59.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:59.821    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120104-100701-293_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/04/SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:30:03.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:30:03.220    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:30:03.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:30:03.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:30:03.221    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100637-767_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/01/04/SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T12:32:27.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0.zip
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:32:27.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120104-100646-156_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/01/25/SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:35:14.180    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:14.181    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:35:14.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:14.182    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120125-100159-666_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/25/SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:35:17.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:17.849    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100159-506_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/25/SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T12:35:21.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0.zip
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:21.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:21.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120125-100142-295_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/01/30/SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:36:50.946    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:50.948    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120130-100533-486_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/01/30/SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:36:54.352    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:54.353    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:54.354    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:54.354    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:54.354    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120130-100533-314_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/02/09/SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:36:57.687    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:57.688    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:36:57.688    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:57.688    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:57.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:57.689    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:57.689    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:57.689    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:57.689    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:57.689    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120209-101239-899_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/02/09/SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0/SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T12:37:01.182    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0.zip
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:01.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:01.184    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101238-798_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/02/09/SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0/SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0.zip
run script
2024-01-09T12:37:04.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0.zip
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:04.631    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120209-101240-603_L1C_049-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/02/10/SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:37:07.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:07.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:07.923    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120210-095318-040_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/02/10/SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:37:11.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:11.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:37:11.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:11.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:11.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:11.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:11.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:11.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:11.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:11.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120210-095317-886_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/06/SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:37:15.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:15.544    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120306-101059-610_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/06/SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:37:18.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:18.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:18.930    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:18.930    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:18.930    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120306-101059-411_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:37:22.350    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:22.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:22.352    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101430-530_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T12:37:25.900    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:25.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0.zip
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:25.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101357-385_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:39:54.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:39:54.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:39:54.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:39:54.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:41:51.916    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (866 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101402-204_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:41:55.919    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:41:55.920    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:41:55.920    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:41:55.921    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101410-639_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0/SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0.zip
run script
2024-01-09T12:43:23.449    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0.zip
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:43:23.451    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120311-101414-248_L1C_050-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0/SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0.zip
run script
2024-01-09T12:44:48.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0.zip
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:48.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:48.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:48.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-454_L1C_053-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T12:48:08.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0.zip
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:08.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101357-809_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:51:35.999    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:51:36.000    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:51:36.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:51:36.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:51:36.001    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:52:36.560    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 102). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101406-292_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/03/11/SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0.zip
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:52:41.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120311-101414-778_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/12/SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:14.668    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:14.669    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:14.669    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:14.669    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:14.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:14.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:14.670    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:14.670    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:14.670    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:14.670    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120312-095508-980_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/12/SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:18.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:18.767    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:18.767    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:18.767    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:18.767    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120312-095508-826_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/27/SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:22.557    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:22.558    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:22.558    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:22.558    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:22.558    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:22.558    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:22.559    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:22.559    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:22.559    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:22.559    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120327-100540-089_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/27/SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:26.592    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:26.594    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120327-100539-905_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/28/SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:31.270    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:31.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:31.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:31.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:31.271    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120328-094616-795_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/03/28/SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:35.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:35.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:35.550    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120328-094616-645_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/29/SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:39.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:39.978    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094950-848_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/29/SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:56:44.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:44.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:44.419    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120529-094950-691_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/05/29/SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T12:56:48.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0.zip
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:48.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:48.521    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:48.521    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:48.521    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120529-094932-930_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/07/30/SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:32.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:32.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:32.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:32.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:32.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:32.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:32.942    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:32.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:32.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:32.942    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120730-095315-972_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/07/30/SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:36.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:36.766    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120730-095315-797_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/08/05/SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:40.945    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:40.947    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120805-093723-163_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/08/05/SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:44.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:44.714    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120805-093723-016_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/08/09/SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:49.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:49.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:49.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:49.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:49.050    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120809-100016-288_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/08/09/SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:53.078    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:53.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:53.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:53.080    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120809-100016-086_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/09/10/SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:57:57.573    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:57.574    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120910-094226-080_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/09/10/SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:58:01.909    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:01.910    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:01.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:01.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:01.911    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120910-094225-926_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/09/25/SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:58:05.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:05.921    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:05.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:05.922    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120925-095250-049_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/09/25/SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:58:10.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:10.130    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095249-866_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/09/25/SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0/SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0.zip
run script
2024-01-09T12:58:13.856    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0.zip
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:13.857    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095210-507_L1C_051-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/09/25/SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:01:34.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:34.242    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:03:27.437    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 456). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095212-558_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/09/25/SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:03:31.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:03:31.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120925-095220-929_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/05/SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:16.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:16.223    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121005-095951-123_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/10/05/SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:19.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:19.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:19.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:19.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:19.927    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121005-095950-897_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/10/10/SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:24.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:24.113    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121010-100320-459_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/10/10/SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:28.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:28.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:28.175    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:28.175    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:28.175    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:06:32.163    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1874 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100320-203_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2012/10/10/SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0/SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0.zip
run script
2024-01-09T13:06:36.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:36.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0.zip
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:36.239    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121010-100321-106_L1C_049-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/01/SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:06:40.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:40.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:06:40.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:40.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:40.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121201-095913-702_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/03/SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:44.662    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:44.663    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:44.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:44.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:44.664    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121203-092029-711_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/12/03/SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T13:06:49.235    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0.zip
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:49.237    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121203-092029-561_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/06/29/SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T13:06:53.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0.zip
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:53.777    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095020-106_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/06/29/SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0/SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0.zip
run script
2024-01-09T13:06:57.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0.zip
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:57.738    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120629-095022-813_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/07/21/SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T13:07:01.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0.zip
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:01.579    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120721-092539-704_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/11/17/SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T13:07:05.681    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0.zip
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:05.683    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092819-261_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2012/11/17/SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0/SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T13:07:09.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0.zip
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:09.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092913-008_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/17/SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:09:21.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:21.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:21.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:11:18.055    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (454 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092916-777_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/11/17/SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0/SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0.zip
run script
2024-01-09T13:11:22.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:22.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0.zip
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:22.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121117-092923-094_L1C_051-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/06/SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T13:12:59.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0.zip
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:59.745    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101205-126_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/06/SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T13:15:14.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:14.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0.zip
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:14.166    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101232-079_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/06/SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0/SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0.zip
run script
2024-01-09T13:16:12.617    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0.zip
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:16:12.618    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:16:12.619    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:16:12.619    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:16:12.619    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120406-101235-689_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/04/22/SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0/SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0.zip
run script
2024-01-09T13:17:02.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0.zip
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:17:02.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120422-100315-077_L1C_050-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/04/SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0/SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T13:20:33.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0.zip
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:20:33.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093133-598_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/05/04/SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0/SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T13:23:34.097    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0.zip
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:23:34.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:23:34.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:23:34.099    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:25:37.415    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 267). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120504-093136-305_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/08/04/SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0/SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T13:25:40.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0.zip
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:25:40.900    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:25:40.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095642-496_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/08/04/SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0/SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0.zip
run script
2024-01-09T13:26:51.834    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:26:51.835    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0.zip
2024-01-09T13:26:51.835    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:26:51.836    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:29:08.605    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 232). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095624-560_L1C_051-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/08/04/SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:29:12.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:29:12.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:29:12.242    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:31:05.185    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (418 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095625-721_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/08/04/SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:31:09.388    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:09.389    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:31:09.389    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:09.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:09.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:09.390    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:09.390    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:09.390    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:09.390    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:09.390    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120804-095634-107_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:32:50.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:50.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:50.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:50.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101550-247_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:36:14.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:14.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:36:14.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:14.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:14.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:14.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:14.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:14.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:14.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:14.917    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101558-712_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T13:39:30.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0.zip
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:30.679    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101607-179_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0/SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0.zip
run script
2024-01-09T13:42:01.834    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0.zip
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:42:01.836    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101612-593_L1C_051-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0/SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T13:43:24.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:24.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0.zip
2024-01-09T13:43:24.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:24.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:24.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:24.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:24.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:24.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:24.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:24.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-449_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T13:47:11.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0.zip
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:47:11.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120214-101541-786_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T13:51:30.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0.zip
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:51:30.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:52:19.732    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 164). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101548-027_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0/SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T13:52:23.388    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:52:23.389    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0.zip
2024-01-09T13:52:23.389    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:52:23.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:52:23.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:52:23.389    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:52:23.390    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:52:23.390    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:52:23.390    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:52:23.390    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101556-519_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 0 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 0]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0/SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T13:55:56.287    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0.zip
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:56.288    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101605-010_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/14/SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0/SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0.zip
run script
2024-01-09T13:59:05.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0.zip
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:59:05.349    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:59:05.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:59:05.350    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120214-101613-132_L1C_053-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/02/SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0/SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T14:00:41.443    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:00:41.444    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0.zip
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:00:41.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093946-892_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/02/SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0/SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0.zip
run script
2024-01-09T14:02:29.239    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0.zip
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:02:29.241    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121202-093947-795_L1C_051-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/12/SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T14:04:10.895    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0.zip
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:10.896    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092438-362_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/12/SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T14:04:54.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:54.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0.zip
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:54.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121012-092439-414_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/12/SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T14:05:28.100    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0.zip
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:05:28.102    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121012-092428-040_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/25/SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0/SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T14:07:10.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0.zip
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:07:10.212    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120225-100317-828_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/23/SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0/SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0.zip
run script
2024-01-09T14:10:00.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0.zip
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:10:00.081    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:10:01.912    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 322). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100641-397_L1C_052-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2012/06/23/SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0/SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T14:10:05.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0.zip
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:10:05.544    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100647-145_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/06/23/SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0/SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0.zip
run script
2024-01-09T14:13:40.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0.zip
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:40.298    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:40.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:40.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120623-100648-048_L1C_052-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/27/SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0/SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0.zip
run script
2024-01-09T14:17:28.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0.zip
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:28.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093436-381_L1C_052-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/27/SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T14:20:09.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0.zip
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:20:09.374    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093441-077_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/27/SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T14:22:33.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0.zip
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:33.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:33.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093449-391_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/27/SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T14:25:17.283    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0.zip
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:25:17.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121027-093457-711_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/02/SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0/SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0.zip
run script
2024-01-09T14:27:33.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0.zip
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:33.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:33.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:33.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091844-341_L1C_052-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/02/SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0/SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T14:30:04.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0.zip
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:30:04.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091852-712_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 1 0]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/02/SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T14:32:51.809    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:32:51.810    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0.zip
2024-01-09T14:32:51.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:32:51.810    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:32:51.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:32:51.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:32:51.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:32:51.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:32:51.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:32:51.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121102-091900-972_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/12/24/SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0/SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T14:35:15.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0.zip
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:35:15.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:35:15.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:35:15.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:35:15.081    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20121224-091433-299_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T14:38:16.462    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0.zip
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:38:16.463    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095627-916_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T14:40:23.380    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0.zip
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:40:23.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:40:23.382    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:40:23.382    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095636-257_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T14:43:04.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0.zip
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:43:04.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095644-607_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0/SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0.zip
run script
2024-01-09T14:46:14.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0.zip
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:14.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120215-095652-961_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T14:47:18.685    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0.zip
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:18.687    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095634-243_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 1 1]
 [2 2 2 ... 0 1 1]
 [2 2 2 ... 0 0 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/02/15/SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T14:48:35.657    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:48:35.658    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0.zip
2024-01-09T14:48:35.658    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:48:35.658    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:48:35.659    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20120215-095642-608_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/13/SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0/SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0.zip
run script
2024-01-09T14:50:13.753    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0.zip
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:50:13.755    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-274_L1C_053-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/13/SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T14:52:36.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:52:36.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0.zip
2024-01-09T14:52:36.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:52:36.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:52:36.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:52:36.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:52:36.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:52:36.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:52:36.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:52:36.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093538-415_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/03/13/SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0/SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0.zip
run script
2024-01-09T14:54:57.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0.zip
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:54:57.699    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR1-XS_20120313-093545-634_L1C_053-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/23/SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0/SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0.zip
run script
2024-01-09T14:56:14.920    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:56:14.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0.zip
2024-01-09T14:56:14.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:56:14.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:56:14.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:56:14.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:56:14.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:56:14.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:56:14.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:56:14.922    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-635_L1C_054-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/23/SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T14:58:13.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:13.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0.zip
2024-01-09T14:58:13.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:13.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:13.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:13.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:13.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:13.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:13.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:13.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091153-753_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/10/23/SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T15:00:37.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0.zip
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:00:37.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121023-091202-004_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2012/11/21/SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0/SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0.zip
run script
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0.zip
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:02:47.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:02:47.080    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:02:50.125    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (255 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-072_L1C_054-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2012/11/21/SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T15:02:53.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:02:53.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0.zip
2024-01-09T15:02:53.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:02:53.430    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:02:53.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:02:57.010    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (253 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121121-095209-427_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2012/10/28/SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T15:03:00.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:00.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0.zip
2024-01-09T15:03:00.325    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:00.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:00.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:00.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:00.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:00.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:00.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:00.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:03:03.671    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (225 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT4-HRVIR2-XS_20121028-091531-108_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/07/24/SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0/SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0.zip
run script
2024-01-09T15:03:08.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0.zip
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:08.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:08.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:08.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:08.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105238-968_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/24/SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0/SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T15:03:48.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0.zip
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:48.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100724-105239-185_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/30/SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0/SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0.zip
run script
2024-01-09T15:04:25.561    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0.zip
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:25.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:25.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:25.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:25.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104511-996_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/30/SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0/SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T15:05:00.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0.zip
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:00.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100930-104512-189_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/09/SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0/SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T15:05:38.557    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:05:38.558    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0.zip
2024-01-09T15:05:38.558    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:05:38.558    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:05:38.559    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100909-104911-316_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/01/12/SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0/SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T15:06:49.004    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:06:49.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0.zip
2024-01-09T15:06:49.010    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:06:49.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:06:49.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:06:49.018    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:06:49.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:06:49.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:06:49.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:06:49.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:06:56.167    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (175 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110135-978_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/01/12/SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0/SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T15:07:02.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:07:02.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0.zip
2024-01-09T15:07:02.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:07:02.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:07:02.334    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110207-357_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/12/SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0/SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T15:08:09.986    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0.zip
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:09.987    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100112-110210-076_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/17/SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0/SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T15:08:16.607    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0.zip
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:16.608    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110530-494_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/01/17/SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0/SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T15:08:32.961    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0.zip
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:32.962    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110534-417_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/17/SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0/SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0.zip
run script
2024-01-09T15:08:39.236    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0.zip
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:39.238    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100117-110539-831_L1C_047-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/18/SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0/SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0.zip
run script
2024-01-09T15:08:45.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0.zip
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:45.101    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104618-114_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/18/SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0/SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T15:08:50.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0.zip
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:50.687    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104621-002_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/18/SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0/SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T15:08:56.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:56.700    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0.zip
2024-01-09T15:08:56.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:56.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:56.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:56.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:56.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:56.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:56.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:56.701    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104649-111_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/18/SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0/SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T15:09:02.410    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0.zip
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:02.412    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100118-104651-806_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/05/SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0/SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T15:09:08.427    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0.zip
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:08.429    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110610-595_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/04/05/SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0/SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0.zip
run script
2024-01-09T15:09:27.644    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0.zip
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:27.646    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:09:35.443    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (946 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100405-110613-314_L1C_047-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/05/27/SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0/SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0.zip
run script
2024-01-09T15:09:39.504    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0.zip
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:39.505    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:39.506    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:39.506    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:39.506    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100527-110641-996_L1C_047-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0/SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T15:09:45.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:45.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0.zip
2024-01-09T15:09:45.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:45.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:45.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:45.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:45.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:45.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:45.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:45.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-537_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T15:10:09.384    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:10:09.385    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0.zip
2024-01-09T15:10:09.385    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:10:09.385    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:10:09.385    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:10:09.385    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:10:09.386    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:10:09.386    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:10:09.386    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:10:09.386    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103629-658_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0/SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T15:10:32.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0.zip
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:10:32.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:10:32.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103631-462_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0/SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T15:10:50.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:10:50.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0.zip
2024-01-09T15:10:50.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:10:50.788    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-349_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0/SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T15:10:57.385    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0.zip
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:10:57.387    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103654-494_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0/SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T15:11:03.585    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0.zip
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:11:03.586    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100920-103656-298_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0/SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0.zip
run script
2024-01-09T15:11:09.220    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:11:09.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0.zip
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:11:09.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103629-288_L1C_052-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0/SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T15:14:22.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0.zip
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:14:22.206    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:14:22.207    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103632-151_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 0 0]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0/SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T15:17:45.904    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:45.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0.zip
2024-01-09T15:17:45.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:45.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:45.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:45.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:45.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:45.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:45.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:45.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103640-477_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/20/SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0/SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0.zip
run script
2024-01-09T15:21:09.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0.zip
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:21:09.407    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:23:18.220    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 404). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100920-103643-172_L1C_052-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2010/01/19/SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0/SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T15:23:22.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0.zip
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:22.988    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:22.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:22.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:22.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:23:28.182    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1882 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100119-102704-741_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/01/24/SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0/SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0.zip
run script
2024-01-09T15:23:32.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:32.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0.zip
2024-01-09T15:23:32.777    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:32.778    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103107-800_L1C_047-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/24/SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:23:37.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:37.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:37.313    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100124-103109-725_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/17/SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0/SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0.zip
run script
2024-01-09T15:23:43.224    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0.zip
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:43.225    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:43.226    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:43.226    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-178_L1C_047-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/17/SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:23:49.362    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:49.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:49.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:49.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:49.364    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103543-322_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/17/SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:23:55.315    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:55.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:23:55.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:55.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:55.317    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103545-127_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/17/SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0/SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0.zip
run script
2024-01-09T15:24:00.776    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:00.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0.zip
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:00.778    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103518-537_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/17/SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0/SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0.zip
run script
2024-01-09T15:24:07.149    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0.zip
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:07.151    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100417-103521-232_L1C_049-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0/SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T15:24:12.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0.zip
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:12.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:12.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:12.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:12.589    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103945-568_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:24:18.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:18.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:24:18.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:18.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:18.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:18.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:18.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:18.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:18.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:18.420    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-103952-931_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0/SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T15:24:23.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:23.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0.zip
2024-01-09T15:24:23.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:23.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:23.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:23.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:23.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:23.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:23.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:23.883    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104001-234_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0/SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T15:24:29.331    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0.zip
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:29.333    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104003-038_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0/SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0.zip
run script
2024-01-09T15:24:34.735    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:34.736    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0.zip
2024-01-09T15:24:34.736    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:34.736    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:34.736    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:34.737    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:34.737    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:34.737    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:34.737    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:34.737    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104034-288_L1C_051-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/18/SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0/SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0.zip
run script
2024-01-09T15:25:49.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0.zip
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:25:49.153    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100518-104036-983_L1C_051-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0/SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T15:26:38.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:38.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0.zip
2024-01-09T15:26:38.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:38.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:38.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:38.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:38.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:38.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:38.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:38.131    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104338-237_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:26:43.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:43.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:43.910    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104345-625_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0/SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T15:26:49.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:49.618    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0.zip
2024-01-09T15:26:49.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:49.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:49.619    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104353-927_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0/SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T15:26:58.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0.zip
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:58.162    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100523-104355-731_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0/SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0.zip
run script
2024-01-09T15:27:04.026    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:04.027    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0.zip
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:04.028    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104404-786_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/23/SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0/SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T15:27:10.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0.zip
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:10.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:10.284    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:10.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:10.284    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100523-104408-396_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0/SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T15:27:16.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:16.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0.zip
2024-01-09T15:27:16.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:16.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:16.120    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102421-003_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:27:33.894    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:33.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:33.896    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:33.896    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102428-342_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0/SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T15:27:40.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0.zip
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:40.278    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102436-572_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0/SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T15:27:46.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0.zip
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:46.602    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102439-291_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0/SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T15:27:52.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0.zip
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:52.675    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102449-344_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0/SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T15:27:59.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:59.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0.zip
2024-01-09T15:27:59.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:59.396    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100524-102452-064_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0/SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0.zip
run script
2024-01-09T15:28:05.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0.zip
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:28:05.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:28:05.372    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102403-586_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0/SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0.zip
run script
2024-01-09T15:28:11.409    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0.zip
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:28:11.410    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:28:11.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:28:11.411    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:28:14.827    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1858). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102406-306_L1C_049-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0/SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T15:28:20.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:28:20.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0.zip
2024-01-09T15:28:20.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:28:20.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:28:20.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:28:20.521    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:28:20.521    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:28:20.521    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:28:20.521    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:28:20.521    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102433-777_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/24/SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0/SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T15:31:14.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:31:14.487    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0.zip
2024-01-09T15:31:14.487    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:31:14.487    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:31:14.488    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100524-102436-497_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 0 0 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/30/SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0/SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0.zip
run script
2024-01-09T15:34:14.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0.zip
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:14.595    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:14.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:14.596    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103622-633_L1C_047-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/30/SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:34:20.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:20.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:20.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:20.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:20.041    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103625-472_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/30/SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0/SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T15:34:25.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0.zip
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:25.065    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103633-750_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/30/SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0/SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0.zip
run script
2024-01-09T15:34:30.029    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0.zip
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:30.030    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100730-103636-446_L1C_048-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/04/SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0/SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0.zip
run script
2024-01-09T15:34:35.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:35.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0.zip
2024-01-09T15:34:35.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:35.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:35.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:35.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:35.705    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:35.705    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:35.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:35.705    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104016-202_L1C_047-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/04/SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:34:41.182    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:41.184    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104019-066_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/04/SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0/SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0.zip
run script
2024-01-09T15:34:46.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0.zip
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:46.856    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100804-104021-761_L1C_047-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/23/SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:51.807    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105023-331_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/23/SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:34:56.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:34:56.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:34:56.577    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105025-136_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/01/23/SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0/SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T15:35:01.812    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:01.813    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0.zip
2024-01-09T15:35:01.813    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:01.813    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:01.813    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:01.813    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:01.814    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:01.814    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:01.814    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:01.814    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100123-105022-224_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/13/SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:35:06.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:06.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:35:06.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:06.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:06.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:06.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:06.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:06.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:06.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:06.555    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104645-817_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/13/SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:35:10.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:10.692    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:10.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:10.693    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104647-622_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/13/SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0/SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T15:35:15.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0.zip
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:15.185    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:15.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:15.186    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100213-104644-710_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/18/SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0/SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:35:20.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:20.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:35:20.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:20.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:20.885    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:20.885    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:20.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:20.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:20.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:20.886    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105039-430_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/18/SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0/SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:35:26.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:26.803    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:26.804    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105041-234_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/18/SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0/SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T15:35:32.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0.zip
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:32.006    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100218-105038-323_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/28/SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0/SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:35:37.490    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:37.492    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105825-590_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/28/SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0/SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:35:42.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:42.454    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105827-395_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/28/SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0/SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T15:35:47.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0.zip
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:47.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:35:53.308    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (82 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100228-105824-411_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/03/16/SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0/SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T15:35:58.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:58.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0.zip
2024-01-09T15:35:58.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:58.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:58.952    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105049-390_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/03/16/SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0/SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T15:36:04.250    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0.zip
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:04.251    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105051-195_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/03/16/SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0/SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T15:36:09.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:09.666    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0.zip
2024-01-09T15:36:09.666    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:09.667    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100316-105048-283_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0/SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0.zip
run script
2024-01-09T15:36:15.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0.zip
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:15.008    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102449-966_L1C_047-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0/SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0.zip
run script
2024-01-09T15:36:20.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0.zip
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:20.639    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102451-867_L1C_047-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0/SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0.zip
run script
2024-01-09T15:36:26.729    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0.zip
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:26.730    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102503-749_L1C_047-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0/SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T15:36:32.887    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:32.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0.zip
2024-01-09T15:36:32.888    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:32.889    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG1-XS_20100715-102506-468_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0/SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0.zip
run script
2024-01-09T15:36:38.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0.zip
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:38.167    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:38.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102447-638_L1C_051-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/15/SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0/SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0.zip
/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0.zip
run script
2024-01-09T15:39:51.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0.zip
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:39:51.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016143/INPUT/SPOT5-HRG2-XS_20100715-102450-357_L1C_051-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016143/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 15:43:09.727860369+00:00] cnes_level2/barrouz/4016143:  Account (env) = cnes_level2
[2024-01-09 15:43:09.729186881+00:00] cnes_level2/barrouz/4016143:     User (env) = barrouz
[2024-01-09 15:43:09.730594183+00:00] cnes_level2/barrouz/4016143:        GroupId = cesbio(426000053)
[2024-01-09 15:43:09.731928805+00:00] cnes_level2/barrouz/4016143:         UserId = barrouz(9134)
[2024-01-09 15:43:09.733173136+00:00] cnes_level2/barrouz/4016143:        Account = cnes_level2
[2024-01-09 15:43:09.734517188+00:00] cnes_level2/barrouz/4016143:        Account = cnes_level2
[2024-01-09 15:43:09.735759240+00:00] cnes_level2/barrouz/4016143:      Partition = cpu2022
[2024-01-09 15:43:09.737146232+00:00] cnes_level2/barrouz/4016143:            QOS = cpu_2022_1280
[2024-01-09 15:43:09.738413294+00:00] cnes_level2/barrouz/4016143:        JobName = inf_ALP_37_TCD-ONLY_AVG-1200
[2024-01-09 15:43:09.739681716+00:00] cnes_level2/barrouz/4016143:     SubmitTime = 2024-01-09T10:51:19
[2024-01-09 15:43:09.740963137+00:00] cnes_level2/barrouz/4016143:        RunTime = 04:21:18
[2024-01-09 15:43:09.742282189+00:00] cnes_level2/barrouz/4016143:      TimeLimit = 1-16:00:00
[2024-01-09 15:43:09.743574861+00:00] cnes_level2/barrouz/4016143:   EligibleTime = 2024-01-09T10:51:19
[2024-01-09 15:43:09.744833473+00:00] cnes_level2/barrouz/4016143:      StartTime = 2024-01-09T11:21:51
[2024-01-09 15:43:09.746190695+00:00] cnes_level2/barrouz/4016143:        EndTime = 2024-01-09T15:43:09
[2024-01-09 15:43:09.747520326+00:00] cnes_level2/barrouz/4016143:       ExitCode = 0:0
[2024-01-09 15:43:09.748908578+00:00] cnes_level2/barrouz/4016143:       NodeList = trex010
[2024-01-09 15:43:09.750217690+00:00] cnes_level2/barrouz/4016143:      BatchHost = trex010
[2024-01-09 15:43:09.751492762+00:00] cnes_level2/barrouz/4016143:           TRES = 
[2024-01-09 15:43:09.752860644+00:00] cnes_level2/barrouz/4016143:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 15:43:09.754214636+00:00] cnes_level2/barrouz/4016143:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 15:43:09.755559028+00:00] cnes_level2/barrouz/4016143:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_37_TCD-ONLY_AVG-1200.log
[2024-01-09 15:43:09.756798849+00:00] cnes_level2/barrouz/4016143:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_37_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016143
JobID                : 4016143
JobName              : inf_ALP_37_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex010 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:19
Start time           : 2024-01-09T11:21:51
End time             : 2024-01-09T15:43:09
Elapsed time         : 04:21:18  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 1 day, 10:50:24
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_37_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_37_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T11:21:51 2024-01-09T15:43:09 04:21:18  18:40:42   1-10:50:24        0.1275M  138720.14M    65453.46M  96874552K          0    trex010      1 12:03:12   trex010
   extern  | extern       COMPLETED   0:0    2024-01-09T11:21:51 2024-01-09T15:43:09 04:21:18  00:00.001  1-10:50:24        0.1275M       0.00M        0.00M      1668K          0    trex010      1 00:00.001  trex010

