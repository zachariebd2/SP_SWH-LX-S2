unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/59.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/59.txt
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0/SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0.zip
run script
2024-01-09T16:24:31.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0.zip
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:31.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000918-103526-021_L1C_050-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0/SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0.zip
run script
2024-01-09T16:25:49.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0.zip
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:49.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:25:51.839    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 626). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103507-014_L1C_051-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T16:25:55.058    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0.zip
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:55.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:55.060    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:55.060    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:55.060    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103511-694_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0/SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T16:28:39.383    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:28:39.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0.zip
2024-01-09T16:28:39.384    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:28:39.385    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000918-103520-896_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/08/SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:30:55.009    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:30:55.010    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101947-035_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/08/SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:32:58.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:58.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101955-271_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/08/SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0/SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0.zip
run script
2024-01-09T16:34:29.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0.zip
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:34:29.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000708-101957-979_L1C_050-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/08/SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T16:35:58.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0.zip
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:58.563    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000708-102008-839_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/05/SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:38:10.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:38:10.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102736-242_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/05/SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0.zip
run script
2024-01-09T16:39:04.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0.zip
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:39:04.203    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:39:04.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:39:04.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:39:05.949    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 109). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000405-102738-047_L1C_050-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0/SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0.zip
run script
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0.zip
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:39:09.198    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:39:09.199    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:39:09.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:39:09.199    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103405-047_L1C_051-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T16:39:41.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:39:41.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0.zip
2024-01-09T16:39:41.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:39:41.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:39:41.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:39:41.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:39:41.529    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:39:41.529    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:39:41.529    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:39:41.529    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103406-082_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T16:40:27.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0.zip
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:40:27.337    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103422-620_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T16:43:21.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:43:21.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0.zip
2024-01-09T16:43:21.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:43:21.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:43:21.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:43:21.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:43:21.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:43:21.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:43:21.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:43:21.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:44:47.546    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 376). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103430-901_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0.zip
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:44:50.833    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103439-191_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 1 ... 2 2 2]
 [1 1 2 ... 2 2 2]
 [1 1 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T16:47:33.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0.zip
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:47:33.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103447-487_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T16:49:36.988    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0.zip
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:49:36.990    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103455-792_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:51:36.759    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:36.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103504-103_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/02/SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:53:13.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:13.249    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000102-103512-423_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/08/SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T16:53:52.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0.zip
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:52.528    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000108-101837-248_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T16:53:55.792    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0.zip
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:55.793    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:55.794    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101904-670_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T16:53:59.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:59.536    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0.zip
2024-01-09T16:53:59.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:59.536    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:59.536    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:59.536    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:59.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:59.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:59.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:59.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101912-857_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T16:54:57.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0.zip
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:54:57.043    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:54:57.044    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101928-213_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T16:57:31.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0.zip
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:31.680    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101936-440_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T16:59:59.315    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0.zip
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:59.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000924-101944-676_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:02:58.326    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:58.328    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:58.329    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-101959-740_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/24/SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:04:46.822    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:04:46.823    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:04:46.824    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:04:50.208    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (446 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000924-102008-009_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0/SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0.zip
run script
2024-01-09T17:04:53.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0.zip
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:04:53.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102656-737_L1C_051-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0/SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T17:05:44.630    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0.zip
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:44.631    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102715-466_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 2 2]
 [2 2 2 ... 1 1 2]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:08:42.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:42.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:08:42.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:42.914    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:10:01.321    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 322). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102721-004_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0/SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0.zip
run script
2024-01-09T17:10:04.632    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:10:04.633    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0.zip
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:10:04.634    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001004-102730-163_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T17:12:55.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0.zip
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:12:55.675    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:12:55.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:12:55.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:12:55.676    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:12:57.730    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (382 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102727-525_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/04/SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0/SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0.zip
run script
2024-01-09T17:13:01.180    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0.zip
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:13:01.181    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:13:01.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:13:01.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001004-102730-232_L1C_053-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0/SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0.zip
run script
2024-01-09T17:14:59.669    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0.zip
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:59.670    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-558_L1C_051-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T17:17:54.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0.zip
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:54.795    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101924-637_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T17:20:53.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:20:53.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0.zip
2024-01-09T17:20:53.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:53.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:53.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:20:53.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:53.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:53.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:53.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:53.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101932-848_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 0 1]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:24:10.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:24:10.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:24:10.653    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:25:50.108    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000829-101941-069_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:25:53.615    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102003-574_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:27:58.030    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:27:58.031    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:27:58.031    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:27:58.031    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:27:58.031    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:27:58.032    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:27:58.032    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:27:58.032    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:27:58.032    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:27:58.032    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000829-102011-846_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/21/SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T17:30:01.003    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:30:01.004    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0.zip
2024-01-09T17:30:01.004    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:30:01.004    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:30:01.004    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:30:01.004    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:30:01.005    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:30:01.005    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:30:01.005    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:30:01.005    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000421-101919-308_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0/SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0.zip
run script
2024-01-09T17:32:59.868    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0.zip
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:32:59.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101919-534_L1C_051-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:36:09.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:09.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:37:30.220    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 662). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101927-845_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0/SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T17:37:33.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0.zip
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:33.732    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001115-101942-516_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T17:40:07.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:40:07.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0.zip
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:40:07.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101927-273_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:43:34.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:43:34.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:43:34.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:43:34.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:45:28.562    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 255). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-101935-494_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0/SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T17:45:31.905    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:45:31.906    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0.zip
2024-01-09T17:45:31.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:45:31.906    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:45:31.907    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000517-102005-621_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/06/SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0/SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0.zip
run script
2024-01-09T17:47:28.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:47:28.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0.zip
2024-01-09T17:47:28.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:47:28.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:47:28.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:47:28.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:47:28.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:47:28.212    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:47:28.212    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:47:28.212    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105808-220_L1C_051-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 1 1]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 1 1 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/06/SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T17:51:03.598    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0.zip
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:51:03.599    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105818-472_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/06/SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T17:54:39.704    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:54:39.705    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0.zip
2024-01-09T17:54:39.705    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:54:39.705    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:54:39.705    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:54:39.705    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:54:39.706    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:54:39.706    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:54:39.706    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:54:39.706    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105821-510_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/06/SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T17:58:22.771    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0.zip
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:58:22.772    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:58:22.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:58:22.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000706-105829-965_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0/SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T18:01:31.898    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0.zip
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:01:31.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:01:31.900    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:01:31.900    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103501-773_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T18:04:34.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0.zip
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:04:34.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:04:34.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:05:52.680    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 316). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103507-350_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0/SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0.zip
run script
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0.zip
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:05:56.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:05:56.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103516-542_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0/SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0.zip
run script
2024-01-09T18:08:49.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0.zip
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:08:49.514    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:08:49.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000728-103549-487_L1C_051-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T18:09:22.576    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0.zip
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:22.577    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103513-796_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0/SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0.zip
run script
2024-01-09T18:11:23.244    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0.zip
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:23.246    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103516-503_L1C_053-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0/SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T18:13:30.215    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0.zip
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:30.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:13:33.336    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (458 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103535-610_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0/SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0.zip
run script
2024-01-09T18:13:36.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0.zip
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:36.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000728-103538-534_L1C_054-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0/SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0.zip
run script
2024-01-09T18:15:24.828    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0.zip
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:15:24.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:15:24.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:15:24.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:15:24.830    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105428-472_L1C_051-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T18:18:53.136    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0.zip
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:18:53.138    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105437-195_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T18:21:36.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:36.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0.zip
2024-01-09T18:21:36.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:36.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:36.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:36.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:36.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:36.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:36.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:36.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105445-624_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0/SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0.zip
run script
2024-01-09T18:24:18.454    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0.zip
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:24:18.455    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000917-105448-331_L1C_051-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T18:26:53.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0.zip
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:26:53.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:26:53.155    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:26:53.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105441-479_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T18:29:03.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:29:03.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0.zip
2024-01-09T18:29:03.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:29:03.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:29:03.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:29:03.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:29:03.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:29:03.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:29:03.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:29:03.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105449-955_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/17/SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0/SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0.zip
run script
2024-01-09T18:31:38.761    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:31:38.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0.zip
2024-01-09T18:31:38.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:31:38.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:31:38.763    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000917-105454-467_L1C_054-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/03/SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0/SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T18:33:42.890    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:33:42.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0.zip
2024-01-09T18:33:42.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:33:42.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104702-226_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/03/SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T18:36:08.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0.zip
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:36:08.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104705-183_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/03/SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:38:28.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:38:28.612    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001003-104713-560_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/19/SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T18:40:12.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0.zip
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:40:12.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105836-212_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/19/SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0/SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0.zip
run script
2024-01-09T18:43:00.321    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:43:00.322    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0.zip
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:43:00.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000419-105843-432_L1C_051-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:44:55.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:44:55.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:44:55.116    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000415-103532-173_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/11/SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:46:24.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:46:24.062    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:46:24.062    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:46:24.062    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:46:24.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103939-446_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/11/SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0/SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0.zip
run script
2024-01-09T18:48:02.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:48:02.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0.zip
2024-01-09T18:48:02.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:48:02.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:48:02.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:48:02.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:48:02.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:48:02.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:48:02.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:48:02.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000611-103942-153_L1C_051-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T18:49:34.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0.zip
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:49:34.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101539-938_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 0]
 [0 0 0 ... 1 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T18:51:54.035    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0.zip
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:51:54.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101548-156_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T18:54:36.939    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0.zip
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:54:36.941    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101612-093_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T18:57:00.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0.zip
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:00.124    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000824-101620-353_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/21/SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T18:59:15.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0.zip
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:59:15.266    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101529-787_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/21/SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T19:01:32.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0.zip
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:01:32.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101538-017_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/21/SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0/SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0.zip
run script
2024-01-09T19:04:38.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0.zip
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:04:38.710    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101600-947_L1C_054-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/21/SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T19:06:46.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0.zip
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:06:46.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101601-987_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/21/SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0/SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0.zip
run script
2024-01-09T19:08:58.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0.zip
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:58.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:58.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000321-101603-792_L1C_054-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/29/SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0.zip
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:11:12.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:11:12.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:11:12.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:11:12.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:11:12.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101545-140_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/29/SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0/SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T19:13:42.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0.zip
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:13:42.619    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101600-587_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/29/SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0/SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T19:16:24.811    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0.zip
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:24.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101615-133_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/29/SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T19:18:28.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0.zip
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:28.205    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000729-101617-076_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/20/SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0/SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0.zip
run script
2024-01-09T19:20:32.376    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:20:32.377    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0.zip
2024-01-09T19:20:32.377    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:32.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:32.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:20:32.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:32.378    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:32.378    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:32.378    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:32.378    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:20:34.578    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 234). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101930-359_L1C_052-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/20/SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0/SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:20:37.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:20:37.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:20:37.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:37.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:37.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101934-982_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/20/SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0/SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T19:23:31.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0.zip
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:23:31.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:24:46.879    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 316). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001020-101942-201_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/20/SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0/SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0.zip
run script
2024-01-09T19:24:50.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0.zip
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:24:50.487    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001020-102007-062_L1C_052-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/24/SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0/SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0.zip
run script
2024-01-09T19:26:11.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:26:11.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0.zip
2024-01-09T19:26:11.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:26:11.693    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:26:11.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104253-249_L1C_052-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/24/SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:28:58.644    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:28:58.646    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104257-992_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/24/SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0/SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0.zip
run script
2024-01-09T19:31:27.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:31:27.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0.zip
2024-01-09T19:31:27.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:27.093    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:27.093    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:31:27.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:27.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:27.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:27.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:27.094    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20001024-104300-700_L1C_052-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/24/SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0/SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0.zip
run script
2024-01-09T19:34:02.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:34:02.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0.zip
2024-01-09T19:34:02.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:02.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:02.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001024-104311-101_L1C_054-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/01/SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T19:35:48.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0.zip
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:35:48.695    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103133-442_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/01/SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T19:38:10.669    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0.zip
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:38:10.671    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000601-103141-738_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/03/SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T19:40:44.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:40:44.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0.zip
2024-01-09T19:40:44.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:44.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:44.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:40:44.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:44.697    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:44.697    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:44.697    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:44.697    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000103-101535-382_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/04/SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0/SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0.zip
run script
2024-01-09T19:43:41.505    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:43:41.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0.zip
2024-01-09T19:43:41.506    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:43:41.506    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:43:41.506    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:43:41.507    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:43:41.507    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:43:41.507    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:43:41.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:43:41.507    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104318-873_L1C_052-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/04/SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T19:44:38.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:44:38.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0.zip
2024-01-09T19:44:38.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:44:38.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:44:38.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:44:38.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:44:38.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:44:38.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:44:38.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:44:38.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000304-104320-016_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/04/SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0/SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0.zip
run script
2024-01-09T19:45:23.193    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0.zip
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:45:23.194    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:45:23.195    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:45:23.195    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:45:23.195    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104255-894_L1C_053-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/04/SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0/SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0.zip
run script
2024-01-09T19:47:52.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0.zip
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:52.430    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:52.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:52.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:52.431    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000304-104257-699_L1C_053-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/19/SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0/SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0.zip
run script
2024-01-09T19:50:29.997    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0.zip
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:50:29.998    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101554-091_L1C_053-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/19/SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T19:53:24.795    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:53:24.796    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0.zip
2024-01-09T19:53:24.796    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:53:24.796    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:53:24.797    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101558-717_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/19/SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T19:55:59.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0.zip
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:55:59.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:55:59.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000919-101606-965_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/19/SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T19:58:50.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:58:50.268    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0.zip
2024-01-09T19:58:50.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:50.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:50.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:58:50.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:50.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:50.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:50.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:50.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101605-776_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/19/SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:00:34.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:00:34.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000919-101614-039_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/28/SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T20:02:21.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:02:21.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0.zip
2024-01-09T20:02:21.083    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:02:21.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:02:21.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:02:21.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:02:21.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:02:21.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:02:21.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:02:21.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104312-756_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/28/SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T20:04:55.576    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0.zip
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:55.578    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000928-104321-127_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/03/SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T20:07:12.162    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0.zip
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:07:12.163    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000703-101613-827_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0/SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T20:09:35.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0.zip
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:09:35.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103917-614_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T20:11:20.424    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0.zip
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:11:20.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103918-751_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:13:08.830    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:08.831    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:13:12.005    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (454 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000923-103927-110_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/02/SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0/SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T20:13:15.259    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:13:15.260    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0.zip
2024-01-09T20:13:15.260    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:15.260    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:15.261    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:13:18.560    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (229 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103923-825_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/02/SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0.zip
run script
2024-01-09T20:13:21.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:13:21.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0.zip
2024-01-09T20:13:21.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:21.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:21.549    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000802-103926-772_L1C_054-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/03/SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0/SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T20:15:09.978    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0.zip
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:15:09.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102003-753_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/03/SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0.zip
run script
2024-01-09T20:17:00.783    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0.zip
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:17:00.784    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:17:00.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:17:00.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000803-102006-608_L1C_054-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/29/SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0/SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T20:18:52.936    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0.zip
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:52.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104704-568_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/29/SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:20:45.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:20:45.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:20:45.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:20:45.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:20:45.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:20:45.883    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:20:45.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:20:45.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:20:45.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:20:45.883    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:20:49.943    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (470 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20001029-104706-664_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/03/30/SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T20:20:53.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:20:53.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0.zip
2024-01-09T20:20:53.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:20:53.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:20:53.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:20:53.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:20:53.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:20:53.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:20:53.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:20:53.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000330-104302-392_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 1 1]
 [2 2 2 ... 0 1 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/02/SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T20:21:40.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0.zip
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:21:40.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:21:40.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000602-101219-359_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T20:22:44.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:22:44.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0.zip
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:44.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101218-625_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T20:23:47.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0.zip
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:23:47.541    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR2-XS_20000819-101226-882_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/14/SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T20:25:00.203    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:25:00.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0.zip
2024-01-09T20:25:00.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:00.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:00.205    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT4-HRVIR1-XS_20000914-101209-930_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/26/SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T20:25:51.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0.zip
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:51.132    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020126-104253-866_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/26/SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0/SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0.zip
run script
2024-01-09T20:26:31.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0.zip
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:26:31.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104147-991_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/26/SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T20:28:33.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0.zip
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:28:33.508    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104150-869_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/26/SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:30:56.971    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:30:56.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:30:56.972    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:56.973    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104159-171_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/26/SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:33:16.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:33:16.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:33:16.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:33:16.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:33:16.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:33:16.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:33:16.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:33:16.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:33:16.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:33:16.076    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:34:46.236    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 854). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020126-104207-480_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/01/31/SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T20:34:49.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:34:49.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0.zip
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:34:49.268    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104653-678_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/31/SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0/SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0.zip
run script
2024-01-09T20:35:31.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0.zip
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:31.846    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:31.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104550-661_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/31/SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T20:35:39.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:39.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0.zip
2024-01-09T20:35:39.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:39.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:39.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:39.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:39.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:39.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:39.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:39.143    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104553-533_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/01/31/SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T20:35:42.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0.zip
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:42.197    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104601-826_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/01/31/SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0/SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0.zip
run script
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0.zip
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:45.224    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020131-104608-143_L1C_047-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/03/28/SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0/SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0.zip
run script
2024-01-09T20:35:48.281    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0.zip
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:48.282    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020328-111034-994_L1C_046-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/01/SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T20:37:24.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0.zip
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:24.498    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020701-104343-448_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/01/SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0/SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0.zip
run script
2024-01-09T20:38:11.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0.zip
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:38:11.638    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:38:11.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:38:11.639    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104241-642_L1C_051-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/01/SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0/SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0.zip
run script
2024-01-09T20:40:51.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:40:51.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0.zip
2024-01-09T20:40:51.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:40:51.439    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:40:51.439    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:40:51.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:40:51.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:40:51.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:40:51.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:40:51.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:40:53.860    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 173). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020701-104243-447_L1C_051-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/09/16/SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0/SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0.zip
run script
2024-01-09T20:40:57.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:40:57.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0.zip
2024-01-09T20:40:57.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:40:57.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020916-110259-267_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/28/SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0/SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0.zip
run script
2024-01-09T20:41:54.736    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:41:54.737    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0.zip
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:41:54.738    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102307-729_L1C_048-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/28/SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T20:42:12.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:42:12.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0.zip
2024-01-09T20:42:12.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:42:12.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:42:12.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:42:12.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:42:12.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:42:12.014    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:42:12.014    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:42:12.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102309-600_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/28/SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0.zip
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:42:43.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:42:43.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:42:43.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:42:43.922    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102317-800_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/28/SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0/SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0.zip
run script
2024-01-09T20:43:57.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0.zip
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:43:57.604    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020728-102325-019_L1C_049-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/28/SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0.zip
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:04.624    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:04.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105401-783_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/28/SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T20:45:19.510    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:45:19.511    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0.zip
2024-01-09T20:45:19.511    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:19.511    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:19.511    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:45:19.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:19.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:19.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:19.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:19.512    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105410-124_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/28/SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0/SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0.zip
run script
2024-01-09T20:45:36.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0.zip
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:36.187    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021028-105411-026_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/04/SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0/SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T20:45:51.101    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0.zip
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:51.102    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110502-494_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/04/SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:46:26.539    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:26.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:46:51.814    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 45). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020104-110504-642_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/01/25/SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T20:46:56.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:46:56.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0.zip
2024-01-09T20:46:56.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:56.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:56.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:46:56.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:56.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:56.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:56.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:56.160    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110117-497_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/25/SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:47:58.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:47:58.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:47:58.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:47:58.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:47:58.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:47:58.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:47:58.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:47:58.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:47:58.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:47:58.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:48:33.935    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 134). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110125-928_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/01/25/SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0/SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0.zip
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:37.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:37.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:37.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110126-831_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/25/SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0/SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T20:49:11.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:49:11.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0.zip
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:49:11.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020125-110114-483_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/04/03/SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0/SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T20:50:25.704    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:50:25.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0.zip
2024-01-09T20:50:25.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:25.705    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105420-991_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/04/03/SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T20:50:47.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0.zip
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:47.469    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:47.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105423-043_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/04/03/SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:51:00.929    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:00.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:00.931    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020403-105431-414_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/01/01/SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0/SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0.zip
run script
2024-01-09T20:51:03.840    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0.zip
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:03.842    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102242-541_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/01/SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:51:24.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:24.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:24.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102247-158_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/01/SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:51:36.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:36.678    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102255-394_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/01/01/SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:51:42.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:42.048    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020101-102303-639_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/04/04/SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0/SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0.zip
run script
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0.zip
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:45.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103506-027_L1C_048-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/04/04/SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0/SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0.zip
run script
2024-01-09T20:52:00.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:00.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0.zip
2024-01-09T20:52:00.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:00.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:00.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:00.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:00.220    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:00.220    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:00.220    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:00.220    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:52:03.017    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (72 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020404-103511-441_L1C_048-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/05/30/SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0/SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0.zip
run script
2024-01-09T20:52:06.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:06.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0.zip
2024-01-09T20:52:06.249    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:06.249    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:06.249    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:06.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:06.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:06.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:06.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:06.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:52:09.136    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (21 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105820-491_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/05/30/SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:52:12.474    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:12.475    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105825-282_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/30/SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:52:15.728    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:15.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:15.730    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:15.730    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105833-687_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/30/SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:18.820    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020530-105842-097_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/31/SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T20:52:22.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:22.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0.zip
2024-01-09T20:52:22.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:22.202    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103906-797_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/31/SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T20:52:25.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:25.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0.zip
2024-01-09T20:52:25.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:25.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:25.259    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103915-084_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/31/SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:28.265    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020531-103923-377_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/06/05/SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0/SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0.zip
run script
2024-01-09T20:52:31.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:31.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0.zip
2024-01-09T20:52:31.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:31.125    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104308-270_L1C_048-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/06/05/SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0/SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:34.067    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020605-104312-075_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/20/SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0/SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0.zip
run script
2024-01-09T20:52:37.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0.zip
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:37.055    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020520-105105-840_L1C_048-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/06/15/SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0/SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0.zip
run script
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0.zip
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:40.134    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105102-863_L1C_048-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/06/15/SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0/SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0.zip
run script
2024-01-09T20:52:43.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0.zip
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:43.124    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020615-105103-765_L1C_048-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/09/11/SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0/SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0.zip
run script
2024-01-09T20:52:46.175    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:46.176    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0.zip
2024-01-09T20:52:46.176    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:46.177    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020911-105853-036_L1C_048-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/09/12/SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0/SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T20:52:49.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:49.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0.zip
2024-01-09T20:52:49.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:49.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:49.121    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020912-103931-861_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/11/03/SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0/SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0.zip
run script
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0.zip
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:52.295    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021103-103925-133_L1C_048-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/08/02/SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0/SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0.zip
run script
2024-01-09T20:52:55.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0.zip
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:55.648    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102651-701_L1C_049-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/08/02/SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0/SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T20:52:58.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0.zip
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:52:58.939    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102659-004_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/02/SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T20:53:43.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:53:43.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0.zip
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:53:43.430    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102707-219_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/02/SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T20:55:54.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:55:54.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0.zip
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:55:54.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102715-443_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/02/SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0/SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0.zip
run script
2024-01-09T20:57:53.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0.zip
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:53.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020802-102718-150_L1C_049-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/22/SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0/SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T20:59:39.133    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:59:39.134    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0.zip
2024-01-09T20:59:39.134    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:59:39.135    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103849-964_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/22/SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T21:00:44.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0.zip
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:44.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103856-428_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/22/SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T21:01:47.927    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0.zip
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:47.929    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103904-707_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/22/SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0/SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0.zip
run script
2024-01-09T21:02:28.623    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0.zip
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:28.624    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020722-103905-609_L1C_049-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/27/SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0/SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T21:03:09.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0.zip
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:03:09.466    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:04:31.915    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (406 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104239-660_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/07/27/SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0/SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0.zip
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:04:35.010    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020727-104243-269_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/07/SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T21:05:58.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:05:58.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0.zip
2024-01-09T21:05:58.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:58.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:58.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020807-103112-122_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/02/16/SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T21:07:14.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:14.825    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0.zip
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:14.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103839-053_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/02/16/SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T21:07:33.573    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:33.574    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0.zip
2024-01-09T21:07:33.574    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:33.574    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:33.575    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020216-103847-343_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/04/09/SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0/SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0.zip
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:36.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:07:38.381    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (36 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103918-020_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/04/09/SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T21:07:41.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:41.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0.zip
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:41.029    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103923-615_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/04/09/SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:44.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:44.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:44.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:44.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:44.197    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103931-926_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/04/09/SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:47.384    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:47.385    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:47.385    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:47.385    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:47.385    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020409-103823-034_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/02/01/SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T21:07:50.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0.zip
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:50.799    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102720-495_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/02/01/SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:07:53.957    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:53.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:07:53.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:53.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:53.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:53.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:53.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:53.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:53.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:53.958    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102723-344_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/02/01/SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0/SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T21:07:57.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:57.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0.zip
2024-01-09T21:07:57.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:57.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:57.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:57.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:57.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:57.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:57.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:57.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020201-102637-481_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/06/SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0/SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T21:10:54.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:10:54.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0.zip
2024-01-09T21:10:54.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:10:54.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:10:54.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:10:54.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:10:54.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:10:54.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:10:54.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:10:54.338    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104720-419_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/06/SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:10:57.911    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020706-104723-352_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/17/SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T21:11:00.946    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:00.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0.zip
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:00.947    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103539-162_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/17/SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:04.201    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020717-103547-452_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/06/10/SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0/SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0.zip
run script
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0.zip
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:07.674    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:07.675    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020610-104714-331_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/11/09/SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0.zip
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:11.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021109-102402-910_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/10/SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:11:22.882    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:22.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:22.885    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104910-719_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/01/10/SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0/SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0.zip
run script
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0.zip
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:25.979    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020110-104913-426_L1C_051-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/21/SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:11:29.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:29.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:29.040    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103040-776_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/05/21/SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0/SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T21:11:32.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:11:32.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0.zip
2024-01-09T21:11:32.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:32.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:32.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020521-103102-665_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/07/SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0/SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:14:24.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:14:24.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:24.150    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020707-102655-152_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/12/SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T21:14:27.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:14:27.426    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0.zip
2024-01-09T21:14:27.426    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:27.426    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:27.427    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103047-037_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/12/SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0.zip
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:30.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103055-273_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/12/SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T21:15:14.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0.zip
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:15:14.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:15:14.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:15:14.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103111-769_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 1 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/12/SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T21:18:03.726    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0.zip
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:18:03.727    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:19:22.892    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 368). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103120-032_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/07/12/SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0/SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0.zip
run script
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0.zip
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:19:26.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:19:26.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:19:26.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:19:26.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:19:26.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020712-103122-739_L1C_051-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/08/SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0/SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0.zip
run script
2024-01-09T21:21:55.020    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:21:55.021    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0.zip
2024-01-09T21:21:55.021    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:21:55.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:21:55.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:21:55.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:21:55.022    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:21:55.022    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:21:55.022    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:21:55.022    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104224-544_L1C_051-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/08/SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0/SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0.zip
run script
2024-01-09T21:23:09.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0.zip
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:23:09.119    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021108-104232-849_L1C_051-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/06/SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0/SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0.zip
run script
2024-01-09T21:25:48.849    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:25:48.850    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0.zip
2024-01-09T21:25:48.850    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:48.851    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:25:51.306    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 137). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102616-190_L1C_051-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/01/06/SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0.zip
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:25:54.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102619-917_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 1 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/06/SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0/SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T21:28:52.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:28:52.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0.zip
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:52.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102625-331_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/06/SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0/SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T21:31:45.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0.zip
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:45.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:45.350    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:45.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:45.350    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102640-930_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/06/SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0/SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0.zip
run script
2024-01-09T21:34:27.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:34:27.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0.zip
2024-01-09T21:34:27.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:34:27.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:34:27.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:34:27.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:34:27.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:34:27.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:34:27.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:34:27.058    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:36:53.744    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 105). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020106-102642-735_L1C_051-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T21:36:56.755    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0.zip
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:36:56.756    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103108-429_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T21:39:46.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0.zip
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:39:46.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:41:11.850    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 202). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103116-689_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T21:41:15.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:41:15.491    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0.zip
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:41:15.492    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103124-958_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:43:56.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:43:56.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103133-236_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:45:56.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:45:56.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:45:56.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:45:56.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103141-520_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T21:47:53.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:47:53.778    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0.zip
2024-01-09T21:47:53.778    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:53.778    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:53.779    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103149-813_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/24/SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T21:49:28.755    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0.zip
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:49:28.757    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20021024-103158-115_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/23/SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0/SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0.zip
run script
2024-01-09T21:50:09.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:50:09.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0.zip
2024-01-09T21:50:09.187    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:50:09.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:52:44.314    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 86). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101956-284_L1C_051-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/07/23/SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0/SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:52:47.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:52:47.828    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-101958-206_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/23/SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:55:11.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:11.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020723-102006-454_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/03/25/SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0/SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T21:57:38.749    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:57:38.750    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0.zip
2024-01-09T21:57:38.750    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:57:38.751    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102725-617_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/03/25/SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:59:45.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:59:45.984    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102732-986_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 1 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/03/25/SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0/SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0.zip
run script
2024-01-09T22:01:59.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:01:59.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0.zip
2024-01-09T22:01:59.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:01:59.556    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020325-102739-303_L1C_051-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/21/SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0/SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0.zip
run script
2024-01-09T22:03:37.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0.zip
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:03:37.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:03:37.885    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:03:37.885    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:03:37.885    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105838-457_L1C_051-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/07/21/SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0/SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T22:06:34.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:06:34.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0.zip
2024-01-09T22:06:34.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:34.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:34.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020721-105841-164_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/05/SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0/SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0.zip
run script
2024-01-09T22:09:22.591    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:09:22.592    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0.zip
2024-01-09T22:09:22.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:09:22.593    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:09:25.341    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 43). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020105-104547-292_L1C_053-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/06/25/SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0/SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0.zip
run script
2024-01-09T22:09:28.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0.zip
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:09:28.731    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105829-985_L1C_053-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/06/25/SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0/SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T22:12:42.666    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0.zip
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:12:42.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:12:42.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:12:42.668    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:12:42.668    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:13:26.149    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 150). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105833-059_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/06/25/SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0/SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:13:29.552    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:13:29.553    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020625-105841-551_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/05/25/SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0/SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:16:47.314    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:16:47.315    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:16:47.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105445-078_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/05/25/SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0/SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:19:50.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:19:50.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:19:50.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:19:50.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105453-536_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/05/25/SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0/SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0.zip
run script
2024-01-09T22:22:30.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0.zip
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:22:30.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020525-105502-001_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/05/04/SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0/SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:23:42.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:23:42.600    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:23:42.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:23:42.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:23:42.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020504-105838-061_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/15/SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:26:32.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:26:32.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105359-950_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/01/15/SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0/SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0.zip
run script
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0.zip
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:28:51.948    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020115-105403-560_L1C_054-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/08/SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:31:31.140    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:31:31.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101219-890_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/08/SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T22:33:04.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0.zip
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:04.478    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:04.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:04.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:04.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020808-101228-144_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/17/SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:34:41.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:34:41.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:34:41.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:34:41.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:34:41.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:34:41.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:34:41.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:34:41.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:34:41.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:34:41.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103929-239_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/17/SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0/SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0.zip
run script
2024-01-09T22:36:13.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:36:13.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0.zip
2024-01-09T22:36:13.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:13.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:13.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:36:13.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:13.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:13.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:13.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:13.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV2-XS_20020817-103931-044_L1C_054-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/22/SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:37:55.042    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:37:55.043    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:37:55.043    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:37:55.043    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:37:55.044    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104322-241_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/22/SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0/SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0.zip
run script
2024-01-09T22:39:32.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0.zip
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:39:32.403    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20020822-104328-558_L1C_054-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/19/SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:41:09.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:41:09.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:41:09.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102750-987_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/19/SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0/SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0.zip
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:42:57.495    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:42:57.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:42:57.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:42:57.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016166/INPUT/SPOT2-HRV1-XS_20021019-102759-286_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016166/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 22:44:41.537694080+00:00] cnes_level2/barrouz/4016166:  Account (env) = cnes_level2
[2024-01-09 22:44:41.538904281+00:00] cnes_level2/barrouz/4016166:     User (env) = barrouz
[2024-01-09 22:44:41.540062532+00:00] cnes_level2/barrouz/4016166:        GroupId = cesbio(426000053)
[2024-01-09 22:44:41.541170213+00:00] cnes_level2/barrouz/4016166:         UserId = barrouz(9134)
[2024-01-09 22:44:41.542227565+00:00] cnes_level2/barrouz/4016166:        Account = cnes_level2
[2024-01-09 22:44:41.543346886+00:00] cnes_level2/barrouz/4016166:        Account = cnes_level2
[2024-01-09 22:44:41.544379398+00:00] cnes_level2/barrouz/4016166:      Partition = cpu2022
[2024-01-09 22:44:41.545489880+00:00] cnes_level2/barrouz/4016166:            QOS = cpu_2022_1280
[2024-01-09 22:44:41.546619761+00:00] cnes_level2/barrouz/4016166:        JobName = inf_ALP_59_TCD-ONLY_AVG-1200
[2024-01-09 22:44:41.547812642+00:00] cnes_level2/barrouz/4016166:     SubmitTime = 2024-01-09T10:51:21
[2024-01-09 22:44:41.549004623+00:00] cnes_level2/barrouz/4016166:        RunTime = 06:20:16
[2024-01-09 22:44:41.550208334+00:00] cnes_level2/barrouz/4016166:      TimeLimit = 1-16:00:00
[2024-01-09 22:44:41.551313295+00:00] cnes_level2/barrouz/4016166:   EligibleTime = 2024-01-09T10:51:21
[2024-01-09 22:44:41.552924803+00:00] cnes_level2/barrouz/4016166:      StartTime = 2024-01-09T16:24:25
[2024-01-09 22:44:41.554432871+00:00] cnes_level2/barrouz/4016166:        EndTime = 2024-01-09T22:44:41
[2024-01-09 22:44:41.555931789+00:00] cnes_level2/barrouz/4016166:       ExitCode = 0:0
[2024-01-09 22:44:41.557311669+00:00] cnes_level2/barrouz/4016166:       NodeList = trex032
[2024-01-09 22:44:41.558473050+00:00] cnes_level2/barrouz/4016166:      BatchHost = trex032
[2024-01-09 22:44:41.559566651+00:00] cnes_level2/barrouz/4016166:           TRES = 
[2024-01-09 22:44:41.560678043+00:00] cnes_level2/barrouz/4016166:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 22:44:41.561731445+00:00] cnes_level2/barrouz/4016166:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 22:44:41.563082214+00:00] cnes_level2/barrouz/4016166:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_59_TCD-ONLY_AVG-1200.log
[2024-01-09 22:44:41.564659992+00:00] cnes_level2/barrouz/4016166:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_59_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016166
JobID                : 4016166
JobName              : inf_ALP_59_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex032 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:21
Start time           : 2024-01-09T16:24:25
End time             : 2024-01-09T22:44:41
Elapsed time         : 06:20:16  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 2:42:08
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_59_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_59_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T16:24:25 2024-01-09T22:44:41 06:20:16  1-05:39:50 2-02:42:08       0.18125M  193066.84M    83557.12M  99019696K          0    trex032      1 19:59:10   trex032
   extern  | extern       COMPLETED   0:0    2024-01-09T16:24:25 2024-01-09T22:44:41 06:20:16  00:00:00   2-02:42:08       0.18125M       0.00M        0.00M      1708K          0    trex032      1 00:00:00   trex032

