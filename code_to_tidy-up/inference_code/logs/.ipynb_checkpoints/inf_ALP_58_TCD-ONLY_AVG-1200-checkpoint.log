unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/58.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/58.txt
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
run script
2024-01-09T16:22:59.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:22:59.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip
2024-01-09T16:22:59.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:22:59.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000621-104737-181_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
run script
2024-01-09T16:24:01.863    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:01.864    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip
2024-01-09T16:24:01.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:01.865    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104641-998_L1C_048-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T16:24:05.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:05.421    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104643-078_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T16:24:08.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:08.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip
2024-01-09T16:24:08.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:08.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:08.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:08.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:08.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:08.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:08.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:08.996    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104651-383_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T16:24:12.382    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:12.384    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104653-188_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T16:24:15.840    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:15.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:15.842    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104615-040_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
run script
2024-01-09T16:24:19.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:19.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:19.480    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104710-320_L1C_051-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T16:26:47.466    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:26:47.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:26:47.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:26:47.468    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104711-475_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:29:03.678    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:29:03.680    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104719-852_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/21/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
run script
2024-01-09T16:30:53.206    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:30:53.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:30:53.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000621-104723-462_L1C_051-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
run script
2024-01-09T16:32:30.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:30.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip
2024-01-09T16:32:30.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:30.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:30.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000625-111039-562_L1C_046-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T16:33:19.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:19.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:33:22.349    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (108 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110948-670_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T16:33:25.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:25.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip
2024-01-09T16:33:25.632    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:25.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:25.633    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110957-152_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T16:33:29.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:29.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:29.128    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:29.128    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:29.128    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110958-957_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
run script
2024-01-09T16:33:32.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:32.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip
2024-01-09T16:33:32.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:32.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:32.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:32.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:32.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:32.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:32.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:32.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000625-110944-699_L1C_048-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
run script
2024-01-09T16:33:57.710    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:57.711    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103202-427_L1C_046-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T16:34:44.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:34:44.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:34:44.679    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:34:44.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:34:44.679    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103203-477_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
run script
2024-01-09T16:35:45.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:45.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:45.869    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103049-515_L1C_049-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T16:35:49.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:49.546    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000627-103054-120_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
run script
2024-01-09T16:36:26.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:36:26.714    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103105-042_L1C_050-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T16:38:53.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:38:53.133    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103108-652_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T16:41:31.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:41:31.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103122-804_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:43:59.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:43:59.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:43:59.302    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:43:59.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:43:59.309    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:43:59.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:43:59.315    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:43:59.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:43:59.321    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:43:59.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0ERROR 1: /tmp/slurm-4016165/OUTPUT/SPOT4/2000/6/27/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_C_V1-0/32TLR/FSC_20000627T103125_SPOT4_32TLR/nodata.tif, band 1: Split bands are read-only.
...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103125-653_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:46:17.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:46:17.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:46:17.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:46:17.705    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103133-922_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T16:47:54.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:47:54.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:47:54.961    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:47:54.961    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103142-203_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
run script
2024-01-09T16:49:23.746    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:49:23.748    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000627-103145-812_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
run script
2024-01-09T16:50:45.868    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:50:45.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-401_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T16:51:14.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:14.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:14.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110647-738_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T16:51:45.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:45.017    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:45.018    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110605-915_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T16:51:48.844    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:48.844    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:48.845    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110612-569_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
run script
2024-01-09T16:51:52.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:52.467    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000811-110628-690_L1C_048-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
run script
2024-01-09T16:51:56.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:56.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:56.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:56.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:56.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110307-214_L1C_046-263-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
run script
2024-01-09T16:53:24.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:24.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:24.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:24.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:24.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110205-052_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
run script
2024-01-09T16:53:54.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:54.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip
2024-01-09T16:53:54.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:54.614    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000615-110210-466_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T16:54:10.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:54:10.183    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110220-852_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:55:57.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:55:57.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:55:57.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:55:57.396    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110224-792_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:57:22.580    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:22.582    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110233-251_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T16:58:12.822    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:58:12.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:58:12.825    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110235-056_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/15/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
run script
2024-01-09T16:59:04.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:04.829    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000615-110248-756_L1C_051-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T17:00:37.922    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:00:37.924    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000828-103948-525_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T17:01:03.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:03.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip
2024-01-09T17:01:03.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:03.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:03.220    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103910-199_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T17:01:06.886    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:06.888    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000828-103913-959_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/24/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
run script
2024-01-09T17:01:09.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:09.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:09.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001124-104711-323_L1C_046-263-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
run script
2024-01-09T17:01:56.834    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:56.835    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:56.836    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000408-110915-497_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
run script
2024-01-09T17:02:00.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:00.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:00.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:00.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:00.964    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-342_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:02:19.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:19.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:19.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:19.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:19.166    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102702-418_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:02:38.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:02:38.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:02:38.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:02:38.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:02:38.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:02:38.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:02:38.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:02:38.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:02:38.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:02:38.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102710-620_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T17:03:12.331    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:12.332    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip
2024-01-09T17:03:12.332    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:12.332    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:12.332    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:12.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:12.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:12.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:12.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:12.333    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102718-838_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T17:03:34.079    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:34.080    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:34.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:34.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:34.081    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:03:36.442    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1802 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102727-062_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T17:03:40.204    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:40.205    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip
2024-01-09T17:03:40.205    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:40.205    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:40.206    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000501-102749-219_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/11/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
run script
2024-01-09T17:05:46.339    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:05:46.340    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip
2024-01-09T17:05:46.340    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:46.340    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:46.340    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:05:46.341    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:46.341    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:46.341    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:46.341    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:46.341    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000511-103441-033_L1C_047-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T17:05:49.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:05:49.781    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:49.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103427-479_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T17:06:03.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:03.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000223-103435-712_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
run script
2024-01-09T17:06:18.658    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:18.659    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:18.660    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:18.660    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103057-055_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T17:06:22.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:22.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:22.419    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103058-962_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
run script
2024-01-09T17:06:26.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:26.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip
2024-01-09T17:06:26.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:26.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:26.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:26.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:26.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:26.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:26.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:26.058    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000315-103101-669_L1C_047-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T17:06:29.755    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:29.756    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103116-567_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T17:06:33.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:33.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:33.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:33.210    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103119-275_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T17:06:36.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:36.473    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103143-426_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/15/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T17:07:38.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:07:38.621    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:07:38.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000315-103144-509_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/20/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T17:08:33.850    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:33.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:33.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:33.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:33.852    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103441-309_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/20/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
run script
2024-01-09T17:08:37.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:37.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:37.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:37.555    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000320-103446-723_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/02/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
run script
2024-01-09T17:08:41.044    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:41.045    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:41.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:41.046    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000902-104256-157_L1C_047-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T17:08:44.704    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:44.705    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip
2024-01-09T17:08:44.705    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:44.706    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102735-933_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T17:08:48.335    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:48.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip
2024-01-09T17:08:48.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:48.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:48.336    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102653-739_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T17:08:52.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:52.020    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:52.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:52.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:52.021    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000813-102701-942_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
run script
2024-01-09T17:09:43.828    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:09:43.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip
2024-01-09T17:09:43.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:09:43.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:09:43.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:09:43.830    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:09:43.830    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:09:43.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:09:43.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:09:43.830    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102747-210_L1C_053-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:11:57.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:11:57.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:11:57.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:57.069    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000813-102755-674_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
run script
2024-01-09T17:14:12.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:12.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:12.726    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:12.726    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:12.726    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-110957-905_L1C_047-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
run script
2024-01-09T17:14:16.494    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:16.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:16.496    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000816-111005-124_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/22/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T17:14:19.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:19.990    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105437-497_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/22/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
run script
2024-01-09T17:14:23.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:23.782    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000822-105441-107_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T17:14:27.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:27.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip
2024-01-09T17:14:27.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:27.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:27.432    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105828-319_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
run script
2024-01-09T17:14:30.979    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:30.980    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip
2024-01-09T17:14:30.980    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:30.980    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:30.981    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000827-105831-929_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
run script
2024-01-09T17:14:34.582    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:34.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:34.584    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105842-236_L1C_052-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 0 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T17:18:26.044    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:18:26.045    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip
2024-01-09T17:18:26.045    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:18:26.046    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105849-820_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/27/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T17:21:45.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:21:45.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:21:45.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:21:45.051    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000827-105858-308_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/01/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
run script
2024-01-09T17:23:21.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:21.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip
2024-01-09T17:23:21.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:21.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:21.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:21.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:21.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:21.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:21.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:21.096    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110217-670_L1C_047-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/01/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T17:23:25.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:25.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip
2024-01-09T17:23:25.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:25.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:25.110    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000901-110221-279_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/06/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T17:23:28.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:28.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip
2024-01-09T17:23:28.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:28.812    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000906-110610-300_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/07/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T17:23:32.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:32.797    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000907-104645-752_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
run script
2024-01-09T17:23:36.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:36.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:36.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:36.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:36.744    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102729-732_L1C_047-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T17:23:40.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:40.546    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:40.547    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000908-102732-439_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
run script
2024-01-09T17:23:44.334    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:44.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102703-120_L1C_049-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T17:25:30.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:25:30.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip
2024-01-09T17:25:30.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:25:30.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102706-820_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T17:27:45.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:27:45.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:27:45.348    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:29:33.759    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (76 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102715-043_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
run script
2024-01-09T17:29:37.368    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:29:37.369    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip
2024-01-09T17:29:37.369    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:29:37.369    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:29:37.369    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:29:37.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:29:37.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:29:37.370    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:29:37.370    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:29:37.370    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-715_L1C_053-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T17:31:54.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:31:54.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102743-884_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:34:10.596    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:34:10.598    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000908-102752-180_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T17:36:26.736    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:26.737    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:26.738    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:26.738    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:26.738    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110950-592_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
run script
2024-01-09T17:36:30.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:30.868    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110958-714_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
run script
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:35.089    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000911-110949-323_L1C_048-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T17:36:39.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:39.206    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:39.207    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111006-430_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T17:36:43.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:43.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:43.327    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000721-111014-922_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/28/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
run script
2024-01-09T17:36:47.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:47.329    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:47.330    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110613-406_L1C_047-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/28/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T17:36:51.135    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:51.136    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:51.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:51.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:51.137    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001028-110615-541_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T17:36:54.870    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:54.870    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip
2024-01-09T17:36:54.870    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:54.870    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:54.870    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:54.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:54.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:54.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:54.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:54.871    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105335-766_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:36:58.473    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:36:58.474    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105344-105_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T17:37:16.064    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:16.065    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip
2024-01-09T17:37:16.065    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:16.066    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000127-105352-449_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T17:37:40.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:40.950    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105332-574_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T17:37:44.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:44.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip
2024-01-09T17:37:44.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:44.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:44.956    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105340-945_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/27/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T17:38:53.065    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:38:53.066    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip
2024-01-09T17:38:53.066    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:53.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:53.066    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:38:53.067    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:53.067    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:53.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:53.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:53.067    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000127-105349-322_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T17:42:09.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:42:09.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:42:09.077    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:42:09.077    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:42:09.077    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103038-830_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T17:42:12.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:42:12.843    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip
2024-01-09T17:42:12.843    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:42:12.844    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103059-966_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T17:44:27.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:44:27.781    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip
2024-01-09T17:44:27.781    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:44:27.781    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:44:27.781    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:44:27.781    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:44:27.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:44:27.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:44:27.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:44:27.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000410-103101-888_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T17:46:34.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:46:34.587    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-495_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T17:46:55.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:46:55.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:46:55.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102315-558_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
run script
2024-01-09T17:47:17.192    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:47:17.193    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip
2024-01-09T17:47:17.193    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:47:17.193    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:47:17.193    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:47:17.194    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:47:17.194    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:47:17.194    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:47:17.194    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:47:17.194    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102325-872_L1C_050-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T17:49:59.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:49:59.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:49:59.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:49:59.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:49:59.965    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102329-482_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
run script
2024-01-09T17:52:51.633    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:52:51.634    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:52:51.635    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000617-102412-233_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T17:54:13.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:54:13.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-200_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 0 0 0]
 [2 0 0 ... 0 0 0]
 [2 2 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T17:57:02.821    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:57:02.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:57:02.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102344-329_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T17:59:52.685    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:52.687    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102352-589_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/17/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
run script
2024-01-09T18:02:39.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:02:39.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:02:39.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:02:39.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:02:39.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000617-102401-758_L1C_053-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/29/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
run script
2024-01-09T18:05:38.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:05:38.413    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000929-102310-893_L1C_048-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/20/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T18:06:16.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:06:16.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:06:16.705    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:06:43.554    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (52 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102253-044_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/11/20/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
run script
2024-01-09T18:06:47.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:06:47.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip
2024-01-09T18:06:47.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:06:47.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:06:47.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:06:47.101    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:06:47.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:06:47.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:06:47.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:06:47.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001120-102254-849_L1C_048-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
run script
2024-01-09T18:07:29.076    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:07:29.077    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:07:29.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:07:29.078    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105027-882_L1C_048-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
run script
2024-01-09T18:07:43.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:07:43.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:07:45.366    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (746 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000626-105031-491_L1C_048-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:07:48.859    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:07:48.860    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:07:48.861    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:07:48.861    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105045-925_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T18:09:03.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:03.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105054-293_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T18:09:52.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:52.784    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:09:54.749    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 140). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105056-098_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/26/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
run script
2024-01-09T18:09:58.538    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:09:58.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:09:58.540    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:09:58.540    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:09:58.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000626-105110-621_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
run script
2024-01-09T18:10:59.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:10:59.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105411-668_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T18:11:34.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:34.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:34.255    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:34.255    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:34.255    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000701-105419-116_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T18:11:48.440    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:48.442    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105440-426_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/01/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
run script
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:52.336    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000701-105444-295_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:11:56.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:11:56.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:11:56.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:11:56.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:11:56.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102649-455_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T18:12:33.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:12:33.766    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102655-868_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T18:13:07.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:07.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip
2024-01-09T18:13:07.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:07.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:07.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:07.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:07.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:07.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:07.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:07.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102704-092_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/25/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T18:13:21.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:21.524    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001125-102712-328_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/20/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
run script
2024-01-09T18:13:25.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:25.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:25.049    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103908-726_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/20/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T18:13:28.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:28.876    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip
2024-01-09T18:13:28.876    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:28.876    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:28.876    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:28.876    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:28.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:28.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:28.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:28.877    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000420-103912-335_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
run script
2024-01-09T18:13:32.304    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:32.306    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104304-258_L1C_048-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T18:13:35.701    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:35.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip
2024-01-09T18:13:35.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:35.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:35.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:35.703    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:35.703    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:35.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:35.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:35.703    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104306-965_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/25/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T18:13:39.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:39.346    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:39.347    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:39.347    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000425-104216-779_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/20/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T18:13:42.988    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:42.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:42.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:42.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:42.990    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110218-690_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/20/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
run script
2024-01-09T18:13:46.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:46.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip
2024-01-09T18:13:46.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:46.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:46.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:46.892    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:46.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:46.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:46.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:46.893    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000520-110219-593_L1C_048-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
run script
2024-01-09T18:13:50.593    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:50.593    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:50.594    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:13:53.514    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (187 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102337-582_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T18:13:57.434    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:57.435    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:57.436    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000522-102342-209_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/22/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T18:14:00.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:14:00.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000522-102308-366_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T18:16:05.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:16:05.854    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:16:05.855    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103126-469_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T18:16:09.520    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:16:09.522    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000913-103130-208_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
run script
2024-01-09T18:16:12.986    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:16:12.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip
2024-01-09T18:16:12.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:16:12.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:16:12.987    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103141-166_L1C_052-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T18:18:41.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:18:41.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:18:41.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000913-103142-246_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/22/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
run script
2024-01-09T18:21:08.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:08.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip
2024-01-09T18:21:08.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:08.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:08.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:08.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:08.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:08.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:08.357    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:08.357    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105830-600_L1C_048-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/22/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T18:21:11.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:11.896    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip
2024-01-09T18:21:11.896    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:11.896    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:11.897    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000922-105835-392_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
run script
2024-01-09T18:21:15.871    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:15.872    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-108_L1C_048-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
run script
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:19.554    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000208-102343-948_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T18:21:23.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:23.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip
2024-01-09T18:21:23.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:23.221    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:23.222    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000208-102344-240_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
run script
2024-01-09T18:21:27.066    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:21:27.066    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip
2024-01-09T18:21:27.066    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:21:27.066    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:21:27.067    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-572_L1C_049-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T18:22:15.998    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:22:16.000    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102307-641_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T18:23:04.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:23:04.401    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:23:04.402    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:23:04.402    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102315-844_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T18:25:16.113    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:25:16.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:25:16.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:27:07.117    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (140 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102324-056_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
run script
2024-01-09T18:27:10.662    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:27:10.663    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip
2024-01-09T18:27:10.663    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:27:10.663    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:27:10.663    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:27:10.663    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:27:10.664    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:27:10.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:27:10.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:27:10.664    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102338-697_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T18:28:23.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:28:23.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip
2024-01-09T18:28:23.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:28:23.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102340-613_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T18:29:34.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:29:34.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip
2024-01-09T18:29:34.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:29:34.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:29:34.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:29:34.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:29:34.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:29:34.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:29:34.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:29:34.899    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000426-102349-758_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
run script
2024-01-09T18:30:24.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:30:24.128    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip
2024-01-09T18:30:24.128    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:30:24.128    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:30:24.129    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102400-481_L1C_051-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:32:25.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:32:25.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:32:25.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:32:25.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:32:25.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:32:25.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:32:25.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:32:25.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:32:25.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:32:25.493    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102404-235_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/26/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T18:33:57.852    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:33:57.853    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip
2024-01-09T18:33:57.853    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:33:57.854    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000426-102412-510_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/30/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T18:34:29.523    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:34:29.524    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102647-864_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/30/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T18:34:33.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:34:33.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip
2024-01-09T18:34:33.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:34:33.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:34:33.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:34:33.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:34:33.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:34:33.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:34:33.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:34:33.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001030-102656-067_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T18:35:21.474    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:35:21.475    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:36:53.360    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (204 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103450-071_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T18:36:56.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:36:56.948    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:36:56.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:36:56.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:36:56.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000702-103452-896_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
run script
2024-01-09T18:38:21.653    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:38:21.655    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103539-525_L1C_050-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
run script
2024-01-09T18:39:13.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:39:13.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:39:13.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:39:13.025    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000702-103543-135_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/25/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T18:39:46.350    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:39:46.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip
2024-01-09T18:39:46.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:39:46.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:39:46.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:39:46.352    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:39:46.352    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:39:46.352    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:39:46.352    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:39:46.352    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001025-102301-112_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T18:40:37.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:40:37.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip
2024-01-09T18:40:37.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:40:37.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:40:37.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:40:37.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:40:37.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:40:37.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:40:37.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:40:37.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000113-102252-508_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T18:42:48.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:48.093    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102235-143_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T18:42:51.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:51.854    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102243-340_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T18:43:51.589    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:43:51.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102251-548_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/01/13/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
run script
2024-01-09T18:47:07.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:47:07.855    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000113-102252-451_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T18:50:12.704    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:50:12.705    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:50:12.706    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105801-098_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T18:53:00.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:53:00.959    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip
2024-01-09T18:53:00.959    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:00.959    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:00.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:53:00.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:00.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:00.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:00.960    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:00.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105807-701_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
run script
2024-01-09T18:55:18.225    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:55:18.226    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:55:18.227    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000515-105809-505_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T18:57:39.735    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:39.736    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105834-290_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T19:01:15.737    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:01:15.739    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105838-240_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T19:04:35.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:04:35.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip
2024-01-09T19:04:35.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:04:35.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:04:35.108    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105846-704_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
run script
2024-01-09T19:06:53.496    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:06:53.497    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip
2024-01-09T19:06:53.497    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:06:53.497    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:06:53.498    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105849-412_L1C_051-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/15/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T19:08:51.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:51.994    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:51.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:51.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:51.995    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000515-105819-560_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 1 0]
 [1 2 2 ... 0 0 0]
 [1 1 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T19:13:04.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:13:04.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:13:04.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103846-977_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T19:15:15.074    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:15.075    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:17:05.641    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (77 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103849-838_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
run script
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:17:08.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:18:55.006    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (786 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103850-740_L1C_049-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T19:18:58.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:58.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:58.434    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103906-409_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T19:20:09.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:09.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:09.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103914-708_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/16/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T19:20:55.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:55.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:20:56.747    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 75). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000516-103916-512_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T19:20:59.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:20:59.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102715-651_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
run script
2024-01-09T19:22:44.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:22:44.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:22:44.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102730-748_L1C_052-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T19:25:38.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:25:38.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip
2024-01-09T19:25:38.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:25:38.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:25:38.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:25:38.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:25:38.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:25:38.124    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:25:38.124    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:25:38.124    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102734-499_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T19:28:35.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:28:35.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip
2024-01-09T19:28:35.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:28:35.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:28:35.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:28:35.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:28:35.760    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:28:35.760    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:28:35.760    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:28:35.760    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:29:36.570    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 434). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000622-102741-719_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
run script
2024-01-09T19:29:39.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:29:39.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102713-013_L1C_049-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T19:31:32.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:31:32.052    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102714-818_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T19:33:19.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:33:19.176    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102754-991_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T19:33:22.856    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:33:22.857    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:33:22.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:33:22.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:33:22.858    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000718-102759-503_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:33:26.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:33:26.240    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:35:27.034    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 480). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102727-669_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T19:35:30.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:35:30.238    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:37:38.755    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (186 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102735-917_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:37:42.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102744-174_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/18/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:39:21.109    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:39:21.110    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:39:21.110    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:39:21.110    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:39:21.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:39:21.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:39:21.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:39:21.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:39:21.111    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:39:21.111    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000718-102653-959_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T19:39:24.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:39:24.298    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip
2024-01-09T19:39:24.298    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:39:24.298    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:39:24.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103102-045_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
run script
2024-01-09T19:41:06.693    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:41:06.694    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip
2024-01-09T19:41:06.694    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:41:06.695    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103059-728_L1C_051-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T19:44:28.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:44:28.269    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103101-662_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
run script
2024-01-09T19:47:54.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:47:54.456    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001009-103106-174_L1C_051-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T19:51:14.961    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:51:14.963    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103117-125_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T19:54:23.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:54:23.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:55:36.640    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 514). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001009-103124-501_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
run script
2024-01-09T19:55:39.708    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:55:39.708    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:55:39.709    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103444-331_L1C_049-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T19:57:23.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:57:23.829    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:58:54.462    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (414 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20001014-103446-136_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/10/14/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
run script
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:57.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20001014-103511-773_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/04/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
run script
2024-01-09T20:01:38.857    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:01:38.858    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:03:31.646    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (186 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000404-104631-729_L1C_049-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/11/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:03:34.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110202-209_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/11/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:06:19.159    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:19.160    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000711-110226-169_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
run script
2024-01-09T20:08:07.526    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:08:07.527    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip
2024-01-09T20:08:07.527    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:08:07.527    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:08:07.528    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110603-017_L1C_049-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T20:09:46.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:09:46.606    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:11:16.252    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 550). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110604-277_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:11:19.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110612-759_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/16/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T20:12:21.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:12:21.963    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000716-110621-245_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
run script
2024-01-09T20:12:49.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:12:49.555    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105037-637_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T20:13:55.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:55.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105039-665_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:14:48.728    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:14:48.729    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:14:48.730    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-018_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
run script
2024-01-09T20:15:23.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:15:23.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000722-105048-920_L1C_049-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
run script
2024-01-09T20:15:56.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:15:56.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip
2024-01-09T20:15:56.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:15:56.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:15:56.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105100-008_L1C_054-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/22/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T20:18:26.518    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:18:26.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000722-105105-747_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/03/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T20:21:02.869    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:21:02.871    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000903-102325-068_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
run script
2024-01-09T20:23:22.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:23:22.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104651-299_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:24:34.979    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:24:34.981    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104653-318_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T20:25:42.004    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:25:42.005    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:25:42.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:25:42.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104701-659_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/30/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T20:26:23.000    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:26:23.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:26:23.002    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:26:23.002    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:26:23.002    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:26:24.551    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 63). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000430-104703-464_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T20:26:27.476    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:26:27.476    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip
2024-01-09T20:26:27.476    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:26:27.477    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105438-293_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:27:53.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:27:53.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105442-171_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T20:29:06.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:29:06.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip
2024-01-09T20:29:06.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:29:06.503    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105450-566_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/05/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T20:29:51.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:29:51.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:29:53.720    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 254). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000605-105452-371_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T20:29:57.215    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:29:57.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105820-743_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:31:31.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:31:31.185    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105824-647_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T20:32:44.551    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:32:44.553    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105833-072_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/01/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T20:33:28.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:33:28.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip
2024-01-09T20:33:28.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:33:28.522    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:33:28.522    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:33:28.522    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:33:28.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:33:28.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:33:28.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:33:28.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000801-105834-877_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/14/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T20:34:08.666    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:34:08.668    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000414-105426-037_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/24/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T20:35:21.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:35:21.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110224-734_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/24/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T20:36:26.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:36:26.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip
2024-01-09T20:36:26.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:36:26.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:36:26.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:36:26.944    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:36:26.944    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:36:26.944    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:36:26.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:36:26.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000424-110226-539_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/06/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T20:37:29.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:37:29.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:29.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000606-103533-981_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/10/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T20:38:08.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:38:08.592    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000610-105844-288_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
run script
2024-01-09T20:39:01.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:01.149    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103925-067_L1C_049-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T20:39:04.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:39:04.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip
2024-01-09T20:39:04.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:04.644    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000707-103930-659_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
run script
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:07.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103908-523_L1C_052-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T20:42:07.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:42:07.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000707-103912-340_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T20:44:42.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:42.766    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102401-237_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:46.556    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:46.557    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000713-102405-749_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
run script
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:49.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:49.896    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102324-934_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:48:08.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:48:08.452    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:48:08.452    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:08.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102325-929_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T20:51:12.037    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:51:12.038    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:51:12.039    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:53:16.142    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 506). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102334-156_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T20:53:19.641    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:53:19.641    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip
2024-01-09T20:53:19.641    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:53:19.642    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102342-392_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/13/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:55:36.493    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:55:36.494    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000713-102350-637_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T20:57:14.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:14.720    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103147-481_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T20:57:17.584    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:17.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip
2024-01-09T20:57:17.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:17.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:17.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:17.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:17.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:17.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:17.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:17.585    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000723-103151-090_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/27/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:21.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:21.060    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:21.060    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:21.060    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:21.060    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000227-105729-336_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:24.437    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:24.438    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000305-102247-557_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
run script
2024-01-09T20:57:27.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:57:27.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:27.745    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102359-971_L1C_051-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T20:58:34.951    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:58:34.952    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip
2024-01-09T20:58:34.952    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:58:34.952    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:58:34.952    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:58:34.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:58:34.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:58:34.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:58:34.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:58:34.953    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102401-027_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T20:59:30.688    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:59:30.689    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102326-400_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T21:01:56.485    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:01:56.486    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:01:56.487    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:01:56.487    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:01:56.487    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102334-663_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/05/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
run script
2024-01-09T21:04:24.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:04:24.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:04:24.332    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000305-102340-980_L1C_053-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
run script
2024-01-09T21:07:25.359    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:07:25.360    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101857-418_L1C_050-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T21:09:34.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:09:34.087    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:09:34.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101902-005_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
run script
2024-01-09T21:13:02.280    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:13:02.281    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip
2024-01-09T21:13:02.281    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:13:02.281    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:13:02.281    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:13:02.282    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:13:02.282    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:13:02.282    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:13:02.282    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:13:02.282    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:15:27.459    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 240). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000203-101906-517_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/12/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T21:15:30.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:15:30.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101945-177_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/12/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:18:33.783    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:18:33.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:20:49.341    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 534). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000612-101947-079_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
run script
2024-01-09T21:20:52.628    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:20:52.629    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:20:52.630    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105425-964_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:23:51.543    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:23:51.544    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:25:58.781    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105427-137_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T21:26:02.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:26:02.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip
2024-01-09T21:26:02.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:26:02.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:26:02.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105435-538_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/27/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T21:28:11.361    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:28:11.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:28:11.363    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000727-105437-343_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T21:30:09.038    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:30:09.039    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip
2024-01-09T21:30:09.039    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:30:09.039    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:30:09.039    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:30:09.039    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:30:09.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:30:09.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:30:09.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:30:09.040    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110202-722_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:34:11.088    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:34:11.089    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:34:11.089    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:34:11.090    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:37:44.061    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 354). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110205-773_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:37:47.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:37:47.476    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:37:47.476    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110214-243_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T21:40:30.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:40:30.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000806-110216-048_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T21:43:04.450    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:43:04.451    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104248-233_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:45:39.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:45:39.374    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:47:30.789    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 440). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104250-230_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:34.227    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104258-547_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T21:49:30.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:49:30.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000807-104300-352_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T21:51:21.688    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:51:21.689    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102329-146_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T21:54:12.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:54:12.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip
2024-01-09T21:54:12.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:54:12.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:54:12.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:56:19.980    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 510). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102331-054_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T21:56:23.423    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:23.424    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:23.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:23.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:23.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102339-289_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T21:58:43.976    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:58:43.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:00:46.444    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (132 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102341-094_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T22:00:49.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:00:49.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip
2024-01-09T22:00:49.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:00:49.740    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102313-707_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:04:02.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:04:02.210    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:02.211    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102403-795_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:05:34.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:05:34.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000808-102412-067_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T22:06:05.978    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:05.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:06:08.200    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (182 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102351-533_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:06:11.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:06:11.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:06:11.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:11.722    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000808-102352-589_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T22:08:26.278    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:26.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104642-772_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T22:11:03.930    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:11:03.931    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:11:03.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:11:03.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:11:03.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:13:02.072    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 223). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104644-794_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:13:05.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:13:05.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:13:05.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:13:05.942    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104653-138_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/12/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T22:15:01.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:15:01.942    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip
2024-01-09T22:15:01.942    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:15:01.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000812-104654-943_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
run script
2024-01-09T22:16:56.775    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:16:56.777    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103510-114_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T22:19:31.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:19:31.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip
2024-01-09T22:19:31.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:19:31.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:19:31.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:19:31.568    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:19:31.568    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:19:31.568    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:19:31.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:19:31.568    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:21:19.665    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 444). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103511-167_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:21:23.190    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:21:23.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:21:23.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103519-448_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T22:23:41.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:23:41.757    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:25:41.539    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (135 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000823-103521-253_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/12/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
run script
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:25:44.688    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:25:44.689    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104301-637_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/12/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T22:27:42.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:27:42.779    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000712-104310-162_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T22:29:09.189    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:29:09.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:29:09.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:31:10.736    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 228). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105037-520_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:31:13.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:31:13.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:31:13.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:31:13.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:33:20.040    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (206 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105045-891_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/17/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T22:33:23.231    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:33:23.231    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:23.232    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR2-XS_20000817-105047-696_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
run script
2024-01-09T22:35:25.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:25.433    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:37:29.461    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (144 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103512-163_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:37:33.255    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:37:33.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:37:33.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:37:33.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:37:33.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:39:37.891    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (198 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103513-222_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T22:39:41.441    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:39:41.442    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016165/INPUT/SPOT4-HRVIR1-XS_20000918-103521-509_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016165/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 22:41:04.378521123+00:00] cnes_level2/barrouz/4016165:  Account (env) = cnes_level2
[2024-01-09 22:41:04.379795384+00:00] cnes_level2/barrouz/4016165:     User (env) = barrouz
[2024-01-09 22:41:04.381032135+00:00] cnes_level2/barrouz/4016165:        GroupId = cesbio(426000053)
[2024-01-09 22:41:04.382321567+00:00] cnes_level2/barrouz/4016165:         UserId = barrouz(9134)
[2024-01-09 22:41:04.383528418+00:00] cnes_level2/barrouz/4016165:        Account = cnes_level2
[2024-01-09 22:41:04.384656221+00:00] cnes_level2/barrouz/4016165:        Account = cnes_level2
[2024-01-09 22:41:04.385808553+00:00] cnes_level2/barrouz/4016165:      Partition = cpu2022
[2024-01-09 22:41:04.387112934+00:00] cnes_level2/barrouz/4016165:            QOS = cpu_2022_1280
[2024-01-09 22:41:04.388252356+00:00] cnes_level2/barrouz/4016165:        JobName = inf_ALP_58_TCD-ONLY_AVG-1200
[2024-01-09 22:41:04.389383348+00:00] cnes_level2/barrouz/4016165:     SubmitTime = 2024-01-09T10:51:21
[2024-01-09 22:41:04.390509671+00:00] cnes_level2/barrouz/4016165:        RunTime = 06:18:16
[2024-01-09 22:41:04.391730742+00:00] cnes_level2/barrouz/4016165:      TimeLimit = 1-16:00:00
[2024-01-09 22:41:04.392884074+00:00] cnes_level2/barrouz/4016165:   EligibleTime = 2024-01-09T10:51:21
[2024-01-09 22:41:04.394022457+00:00] cnes_level2/barrouz/4016165:      StartTime = 2024-01-09T16:22:48
[2024-01-09 22:41:04.395181549+00:00] cnes_level2/barrouz/4016165:        EndTime = 2024-01-09T22:41:04
[2024-01-09 22:41:04.396299611+00:00] cnes_level2/barrouz/4016165:       ExitCode = 0:0
[2024-01-09 22:41:04.397401823+00:00] cnes_level2/barrouz/4016165:       NodeList = trex035
[2024-01-09 22:41:04.398616465+00:00] cnes_level2/barrouz/4016165:      BatchHost = trex035
[2024-01-09 22:41:04.399739308+00:00] cnes_level2/barrouz/4016165:           TRES = 
[2024-01-09 22:41:04.400943509+00:00] cnes_level2/barrouz/4016165:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 22:41:04.402394489+00:00] cnes_level2/barrouz/4016165:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 22:41:04.403601971+00:00] cnes_level2/barrouz/4016165:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-ONLY_AVG-1200.log
[2024-01-09 22:41:04.404717644+00:00] cnes_level2/barrouz/4016165:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016165
JobID                : 4016165
JobName              : inf_ALP_58_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex035 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:21
Start time           : 2024-01-09T16:22:48
End time             : 2024-01-09T22:41:04
Elapsed time         : 06:18:16  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 2:26:08
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_58_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T16:22:48 2024-01-09T22:41:04 06:18:16  1-06:36:13 2-02:26:08       0.07375G  184581.11M    79073.96M  99566584K          0    trex035      1 21:52:29   trex035
   extern  | extern       COMPLETED   0:0    2024-01-09T16:22:48 2024-01-09T22:41:04 06:18:16  00:00.001  2-02:26:08       0.07375G       0.00M        0.00M      1712K          0    trex035      1 00:00:00   trex035

