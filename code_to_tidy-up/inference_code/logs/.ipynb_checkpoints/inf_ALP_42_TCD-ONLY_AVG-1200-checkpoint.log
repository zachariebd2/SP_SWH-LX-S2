unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/42.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/42.txt
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:24:36.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:36.703    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104317-270_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
run script
2024-01-09T11:24:41.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:41.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:41.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104429-005_L1C_051-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/13/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T11:26:05.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:26:05.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip
2024-01-09T11:26:05.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:26:05.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:26:05.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:26:05.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:26:05.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:26:05.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:26:05.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:26:05.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030813-104431-050_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T11:27:08.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:08.953    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102750-698_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
run script
2024-01-09T11:27:14.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:14.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip
2024-01-09T11:27:14.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:14.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:14.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102816-124_L1C_052-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
run script
2024-01-09T11:30:22.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:30:22.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102836-297_L1C_052-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T11:33:58.603    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:33:58.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:33:58.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:33:58.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:33:58.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102839-160_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/08/19/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T11:37:11.933    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:37:11.933    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:37:11.934    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:37:15.191    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1210). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030819-102840-965_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T11:37:20.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:37:20.923    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102449-622_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T11:41:35.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:41:35.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102452-438_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T11:45:57.220    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:45:57.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:45:57.222    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:45:57.222    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:45:57.222    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102500-692_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:49:48.090    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:48.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:48.092    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:48.092    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:48.092    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102508-945_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/01/18/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T11:53:49.613    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:49.614    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030118-102518-114_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T11:56:52.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:56:52.839    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110326-731_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T12:02:01.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:01.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110329-763_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [2 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T12:07:05.416    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:05.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:11:50.593    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 178). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110338-210_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/02/11/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:11:56.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:56.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:11:56.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:56.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:56.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:56.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:56.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:56.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:56.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:56.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030211-110346-680_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T12:16:42.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:42.416    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105538-893_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T12:21:17.083    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:17.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:17.085    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105541-853_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/25/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T12:25:40.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:40.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip
2024-01-09T12:25:40.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:40.955    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:29:41.853    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2572). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030325-105550-227_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T12:29:47.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:47.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110323-218_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T12:34:58.136    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:58.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:58.138    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:58.138    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:58.138    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110326-226_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T12:40:05.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:05.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:05.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:05.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:05.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:44:55.249    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 177). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110334-672_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/04/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:45:02.329    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:45:02.331    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030404-110343-143_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T12:49:58.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:49:58.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104806-641_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T12:54:08.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:54:08.852    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104814-967_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:57:55.250    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:55.252    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104823-317_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/17/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:01:37.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:37.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030217-104831-691_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T13:04:22.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:04:22.953    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103246-299_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:08:24.314    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:24.315    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:24.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:24.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:24.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103249-139_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:11:59.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:59.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:11:59.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:59.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:59.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:59.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:59.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:59.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:59.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:59.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103257-417_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 1 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:15:34.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:34.246    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:34.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030223-103305-719_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T13:18:42.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:42.233    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:42.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103308-376_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 2 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/02/23/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
run script
2024-01-09T13:19:39.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:39.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:20:48.030    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 240). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030223-103313-791_L1C_055-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T13:20:53.686    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:20:53.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:20:53.688    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103244-974_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:24:51.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:51.528    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103247-813_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 1 ... 2 2 2]
 [2 0 2 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:29:10.468    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:29:10.469    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:29:10.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:29:10.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:29:10.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:29:10.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:29:10.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:29:10.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:29:10.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:29:10.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030416-103256-091_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T13:32:51.092    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:51.093    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103307-254_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/16/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
run script
2024-01-09T13:33:55.225    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:33:55.226    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030416-103314-473_L1C_055-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T13:35:16.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:16.667    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102108-920_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T13:39:38.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:38.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:38.940    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102111-760_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:43:40.856    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:40.857    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:40.858    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102120-014_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/04/27/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T13:47:56.007    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:47:56.008    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG2-XS_20030427-102129-158_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
run script
2024-01-09T13:51:14.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:51:14.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:51:14.529    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:51:14.529    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:51:14.529    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104033-114_L1C_051-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:54:59.294    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:54:59.295    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:54:59.295    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:54:59.295    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:54:59.295    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:54:59.295    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:54:59.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:54:59.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:54:59.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:54:59.296    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104036-892_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:58:25.811    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:25.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104045-218_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016149/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2003/03/05/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
/tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
run script
2024-01-09T14:01:06.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:01:06.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016149/INPUT/SPOT5-HRG1-XS_20030305-104051-523_L1C_051-260-7_D_V1-0.zip
2024-01-09T14:01:06.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:01:06.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
