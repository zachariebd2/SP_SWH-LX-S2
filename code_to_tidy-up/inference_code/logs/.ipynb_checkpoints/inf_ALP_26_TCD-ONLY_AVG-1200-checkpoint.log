unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/26.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/26.txt
muscate/SPOTWORLDHERITAGE/2004/12/30/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:51:27.627    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041230-105954-938_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/31/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T10:52:06.647    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:06.648    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:06.649    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104035-966_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 2 0]
 [1 1 1 ... 1 0 0]
 [1 1 1 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/31/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T10:52:32.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:32.478    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:32.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:32.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:32.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041231-104037-771_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 0 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/09/07/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
run script
2024-01-09T10:52:52.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:52.319    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105144-759_L1C_049-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/09/07/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T10:52:55.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:55.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip
2024-01-09T10:52:55.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:55.610    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040907-105145-908_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/04/16/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
run script
2024-01-09T10:52:58.973    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:58.974    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040416-101841-194_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T10:53:02.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:02.492    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103820-151_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
run script
2024-01-09T10:53:05.932    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:05.934    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T10:53:08.287    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 184). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20040702-103825-565_L1C_050-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
run script
2024-01-09T10:53:11.630    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:11.631    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip
2024-01-09T10:53:11.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:11.632    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103916-641_L1C_050-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T10:55:19.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:55:19.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip
2024-01-09T10:55:19.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:55:19.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103917-739_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T10:57:25.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:57:25.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103926-065_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/07/02/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
run script
2024-01-09T10:58:54.143    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:58:54.144    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20040702-103934-187_L1C_050-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T10:59:24.167    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:59:24.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:03:10.602    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 53). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-249_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:03:14.893    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:03:14.894    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:03:14.894    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:03:14.894    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:03:14.894    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:03:14.894    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:03:14.895    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:03:14.895    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:03:14.895    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:03:14.895    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:06:09.296    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 990). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105921-556_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/08/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T11:06:15.164    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:15.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip
2024-01-09T11:06:15.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:15.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:15.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:15.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:15.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:15.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:15.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:15.166    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041108-105926-971_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T11:09:18.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:09:18.042    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip
2024-01-09T11:09:18.042    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:09:18.043    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110311-869_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:13:50.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:13:50.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:13:50.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:13:50.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:13:50.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:13:50.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:13:50.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:13:50.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:13:50.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:13:50.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:17:58.290    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 132). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110314-014_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:18:02.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:18:02.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:18:02.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:18:02.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:20:52.299    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (107 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110322-479_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/11/13/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T11:20:55.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:20:55.897    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR1-XS_20041113-110324-283_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
run script
2024-01-09T11:23:35.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:23:35.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip
2024-01-09T11:23:35.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:23:35.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104006-088_L1C_050-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:27:04.872    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:27:04.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:27:04.873    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:27:04.873    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:27:04.873    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:27:04.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:27:04.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:27:04.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:27:04.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:27:04.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:29:13.711    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104010-772_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016132/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2004/12/05/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T11:29:17.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:17.964    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016132/INPUT/SPOT4-HRVIR2-XS_20041205-104014-381_L1C_050-258-4_D_V1-0.zip
2024-01-09T11:29:17.964    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:17.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:17.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:17.965    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:17.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:17.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:17.966    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:17.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
