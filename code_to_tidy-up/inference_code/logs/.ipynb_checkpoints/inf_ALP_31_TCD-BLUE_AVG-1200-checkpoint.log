unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/31.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/31.txt
muscate/SPOTWORLDHERITAGE/2011/10/14/SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:07:48.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:48.880    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111014-094825-359_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/10/14/SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T19:07:52.652    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0.zip
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:52.653    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:52.654    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:52.654    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094823-403_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/10/14/SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:07:56.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:56.209    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111014-094825-208_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/10/29/SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:07:59.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:59.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:59.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:59.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:59.499    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111029-095909-475_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/10/29/SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:08:02.746    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:08:02.747    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:02.748    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111029-095909-324_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/04/SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:08:06.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:06.013    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100455-841_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/04/SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:08:09.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:09.318    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111204-100455-681_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/04/SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0/SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0.zip
run script
2024-01-09T19:08:12.581    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0.zip
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:08:12.582    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:08:12.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:08:12.583    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-404_L1C_054-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/04/SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T19:09:35.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0.zip
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:09:35.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:09:35.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100438-666_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/04/SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0/SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0.zip
run script
2024-01-09T19:10:54.408    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0.zip
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:10:54.410    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:10:54.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:10:54.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:10:54.411    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111204-100439-569_L1C_054-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/05/SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:12:17.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:17.188    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111205-094531-849_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/10/SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:12:20.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:20.584    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111210-094904-608_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/10/SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:12:24.026    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:12:24.027    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:12:24.027    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:24.027    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:24.028    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094904-458_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/10/SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0/SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T19:12:27.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0.zip
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:27.413    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094844-995_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/10/SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T19:13:36.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0.zip
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:13:36.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:13:36.546    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094845-124_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/10/SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0/SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0.zip
run script
2024-01-09T19:14:42.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0.zip
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:14:42.303    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111210-094847-831_L1C_050-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/14/SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:15:47.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:47.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:47.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:47.879    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111214-101159-393_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/14/SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:15:51.102    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:51.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:15:51.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:51.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:51.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:51.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:51.104    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:51.104    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:51.104    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:51.104    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111214-101159-207_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/15/SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:15:54.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:54.483    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111215-095236-365_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/15/SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:15:57.795    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:15:57.795    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:15:57.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:57.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:57.796    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111215-095236-215_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:16:01.155    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:16:01.156    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:16:01.156    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:01.157    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101533-251_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:16:04.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:04.482    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101533-049_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0/SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0.zip
run script
2024-01-09T19:16:07.635    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0.zip
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:07.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:07.637    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:07.637    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101429-458_L1C_051-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0/SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0.zip
run script
2024-01-09T19:16:46.664    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:16:46.665    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0.zip
2024-01-09T19:16:46.665    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:46.666    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101515-001_L1C_053-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [0 1 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T19:19:50.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0.zip
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:19:50.170    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111219-101517-137_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0/SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0.zip
run script
2024-01-09T19:22:50.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:22:50.078    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0.zip
2024-01-09T19:22:50.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:22:50.079    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101514-673_L1C_054-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T19:24:32.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0.zip
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:24:32.163    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101515-028_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/19/SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0/SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0.zip
run script
2024-01-09T19:26:14.752    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0.zip
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:26:14.753    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111219-101516-833_L1C_054-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/25/SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:28:02.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:28:02.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:28:02.979    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095949-161_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/25/SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0/SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T19:28:06.239    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:28:06.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0.zip
2024-01-09T19:28:06.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:28:06.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:28:06.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:28:06.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:28:06.241    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:28:06.241    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:28:06.241    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:28:06.241    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095949-007_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/12/25/SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T19:28:09.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:28:09.619    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0.zip
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:28:09.620    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095925-976_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/25/SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0/SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0.zip
run script
2024-01-09T19:30:09.668    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0.zip
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:30:09.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111225-095932-293_L1C_053-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/25/SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T19:32:37.067    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0.zip
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:32:37.068    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:32:37.069    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:32:37.069    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:32:37.069    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111225-095932-319_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/01/22/SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0/SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0.zip
run script
2024-01-09T19:33:56.632    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0.zip
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:33:56.634    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095556-126_L1C_050-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/01/22/SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0/SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0.zip
run script
2024-01-09T19:34:00.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0.zip
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:00.149    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110122-095557-931_L1C_050-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/01/27/SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0/SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0.zip
run script
2024-01-09T19:34:03.565    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0.zip
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:03.566    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:03.567    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095934-629_L1C_050-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/01/27/SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0/SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0.zip
run script
2024-01-09T19:34:07.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:07.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0.zip
2024-01-09T19:34:07.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:07.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:07.088    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110127-095936-434_L1C_050-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/01/30/SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0/SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:34:10.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:10.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:10.640    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104152-521_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/01/30/SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0/SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0.zip
run script
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0.zip
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:14.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:14.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:14.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:14.209    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110130-104155-228_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:34:17.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:17.483    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102402-392_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:34:20.779    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:34:20.780    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:34:20.780    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:34:20.781    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102410-731_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T19:35:14.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:35:14.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0.zip
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:35:14.449    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-078_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0/SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0.zip
run script
2024-01-09T19:38:02.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:38:02.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0.zip
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:38:02.250    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102419-980_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0/SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T19:40:42.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0.zip
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:40:42.591    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:41:50.753    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 312). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102451-374_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0/SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T19:41:54.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0.zip
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:41:54.063    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102452-526_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0/SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0.zip
run script
2024-01-09T19:43:01.672    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0.zip
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:43:01.673    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-493_L1C_051-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T19:45:47.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0.zip
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:45:47.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:45:47.183    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:45:47.183    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:45:47.183    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102434-740_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/29/SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0/SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0.zip
run script
2024-01-09T19:48:25.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0.zip
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:48:25.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:48:25.300    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:48:25.300    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:48:25.300    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110329-102437-447_L1C_051-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/06/SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0/SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0.zip
run script
2024-01-09T19:50:53.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:50:53.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0.zip
2024-01-09T19:50:53.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:50:53.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:50:53.415    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110706-101533-476_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/08/12/SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0/SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0.zip
run script
2024-01-09T19:50:56.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0.zip
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:50:56.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:50:56.714    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:50:56.714    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100216-979_L1C_050-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/12/SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:51:17.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:51:17.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110812-100218-901_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:52:06.474    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:06.475    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:06.476    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:06.476    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:06.476    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101012-867_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:52:09.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:52:09.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:52:09.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:52:09.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101021-178_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0/SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0.zip
run script
2024-01-09T19:53:01.011    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0.zip
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:53:01.012    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-623_L1C_051-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T19:55:53.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0.zip
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:55:53.445    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101035-845_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 0]
 [0 0 0 ... 1 1 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T19:58:46.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T19:58:46.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0.zip
2024-01-09T19:58:46.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:58:46.300    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101044-199_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T20:01:24.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0.zip
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:01:24.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101052-558_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0/SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T20:04:14.111    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:04:14.112    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0.zip
2024-01-09T20:04:14.112    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:04:14.112    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:04:14.112    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:04:14.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:04:14.113    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:04:14.113    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:04:14.113    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:04:14.113    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111018-101100-923_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0/SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T20:06:35.410    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:35.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0.zip
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:35.412    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:06:38.127    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (188 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101050-335_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T20:06:41.550    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0.zip
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:06:41.551    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101058-721_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/10/18/SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T20:08:49.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0.zip
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:08:49.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:08:49.404    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111018-101107-114_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/15/SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0/SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0.zip
run script
2024-01-09T20:11:27.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0.zip
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:11:27.472    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:11:27.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:11:27.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:11:27.473    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095359-485_L1C_050-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/15/SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T20:13:46.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:13:46.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0.zip
2024-01-09T20:13:46.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:13:46.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:13:46.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:13:46.098    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:13:46.098    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:13:46.098    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:13:46.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:13:46.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095401-359_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/15/SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T20:16:30.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:16:30.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0.zip
2024-01-09T20:16:30.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:16:30.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:16:30.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:16:30.263    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:16:30.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:16:30.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:16:30.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:16:30.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110315-095409-562_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/15/SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0/SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0.zip
run script
2024-01-09T20:19:20.460    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0.zip
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:19:20.461    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110315-095409-067_L1C_052-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0/SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T20:22:17.740    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0.zip
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:22:17.741    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094928-855_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0/SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T20:24:47.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:24:47.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0.zip
2024-01-09T20:24:47.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:24:47.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:24:47.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:24:47.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:24:47.136    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:24:47.136    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:24:47.136    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:24:47.136    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094917-898_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T20:27:47.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:27:47.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0.zip
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:27:47.108    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094935-278_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T20:30:29.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:30:29.897    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0.zip
2024-01-09T20:30:29.897    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:30:29.898    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094943-510_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0/SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0.zip
run script
2024-01-09T20:32:33.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0.zip
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:32:33.575    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094957-567_L1C_051-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T20:34:34.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0.zip
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:34:34.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-094959-507_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0/SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T20:36:30.659    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0.zip
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:36:30.660    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110627-095007-770_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0/SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0.zip
run script
2024-01-09T20:37:22.085    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0.zip
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:37:22.086    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:37:22.087    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094954-340_L1C_053-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/27/SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0/SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T20:39:46.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:39:46.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0.zip
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:39:46.408    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110627-094958-091_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/04/SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0/SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0.zip
run script
2024-01-09T20:41:55.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0.zip
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:41:55.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100637-314_L1C_050-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/04/SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:43:13.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:43:13.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:43:13.719    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:43:13.719    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:43:13.719    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:43:13.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:43:13.720    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:43:13.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:43:13.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:43:13.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100639-263_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/03/04/SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0/SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0.zip
run script
2024-01-09T20:44:26.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:44:26.129    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0.zip
2024-01-09T20:44:26.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:44:26.130    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110304-100643-775_L1C_050-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0/SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0.zip
run script
2024-01-09T20:45:36.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:45:36.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0.zip
2024-01-09T20:45:36.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:45:36.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:45:36.841    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102536-751_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0/SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0.zip
run script
2024-01-09T20:46:31.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:46:31.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0.zip
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:46:31.592    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102536-905_L1C_050-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0/SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T20:47:56.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:47:56.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0.zip
2024-01-09T20:47:56.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:47:56.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:47:56.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:47:56.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:47:56.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:47:56.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:47:56.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:47:56.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102541-615_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0/SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0.zip
run script
2024-01-09T20:48:34.557    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0.zip
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:34.559    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111107-102545-225_L1C_050-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0/SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T20:48:58.691    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0.zip
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:48:58.693    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102540-872_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/11/07/SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0/SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0.zip
run script
2024-01-09T20:50:03.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0.zip
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:03.150    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20111107-102545-384_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/04/SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0/SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T20:50:44.000    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0.zip
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:44.001    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103230-521_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2011/06/04/SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T20:50:47.076    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:50:47.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0.zip
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:50:47.078    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T20:54:19.528    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 606). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103303-345_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/06/04/SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T20:54:22.555    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0.zip
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:54:22.556    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:54:22.557    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110604-103311-822_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/05/06/SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0/SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0.zip
run script
2024-01-09T20:57:38.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0.zip
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:57:38.600    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:57:38.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095151-011_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/05/06/SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T21:00:39.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:00:39.064    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0.zip
2024-01-09T21:00:39.064    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:00:39.064    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:00:39.064    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:00:39.064    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:00:39.065    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:00:39.065    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:00:39.065    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:00:39.065    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:02:26.848    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 261). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095153-811_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/05/06/SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T21:02:30.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:02:30.388    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0.zip
2024-01-09T21:02:30.388    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:02:30.389    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110506-095202-038_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 0 1 ... 2 2 2]
 [1 0 1 ... 2 2 2]
 [1 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T21:05:21.347    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:05:21.348    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0.zip
2024-01-09T21:05:21.348    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:05:21.348    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:05:21.348    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:05:21.349    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:05:21.349    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:05:21.349    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:05:21.349    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:05:21.349    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100611-250_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T21:08:05.245    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0.zip
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:08:05.247    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:09:13.448    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 574). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100619-552_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T21:09:16.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:09:16.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0.zip
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:09:16.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100627-860_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:11:56.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:11:56.380    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:11:56.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:11:56.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100636-178_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T21:14:06.597    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:14:06.598    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0.zip
2024-01-09T21:14:06.598    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:14:06.598    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:14:06.599    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100644-498_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/17/SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0/SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T21:16:21.259    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:16:21.260    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0.zip
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:16:21.261    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:17:51.130    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (208 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110817-100652-830_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/06/01/SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0/SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T21:17:54.225    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0.zip
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:17:54.226    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:17:54.227    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:17:54.227    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:17:54.227    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095057-390_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/01/SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T21:20:18.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0.zip
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:20:18.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110601-095100-212_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/16/SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0/SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0.zip
run script
2024-01-09T21:22:33.760    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0.zip
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:22:33.762    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T21:24:33.087    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1762). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-426_L1C_052-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/07/16/SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T21:24:37.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:24:37.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0.zip
2024-01-09T21:24:37.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:24:37.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:24:37.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:24:37.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:24:37.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:24:37.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:24:37.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:24:37.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102329-730_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/16/SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:27:44.416    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:27:44.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:27:44.417    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:27:44.417    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:27:44.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:27:44.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:27:44.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:27:44.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:27:44.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:27:44.418    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102338-161_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/16/SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0/SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0.zip
run script
2024-01-09T21:31:17.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0.zip
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:31:17.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:31:17.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:31:17.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:31:17.374    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110716-102342-673_L1C_052-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/10/SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0/SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0.zip
run script
2024-01-09T21:34:31.396    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0.zip
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:34:31.397    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:34:31.398    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095326-776_L1C_052-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/10/SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:37:51.104    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:37:51.105    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:37:51.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:37:51.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:37:51.106    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095329-610_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/10/SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0/SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0.zip
run script
2024-01-09T21:41:18.004    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:41:18.005    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0.zip
2024-01-09T21:41:18.005    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:41:18.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110410-095332-317_L1C_052-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/10/SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0/SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0.zip
run script
2024-01-09T21:44:34.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0.zip
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:44:34.708    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:44:34.709    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:44:34.709    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110410-095308-475_L1C_053-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/12/SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0/SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0.zip
run script
2024-01-09T21:47:05.241    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:47:05.242    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0.zip
2024-01-09T21:47:05.242    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:47:05.243    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100037-791_L1C_052-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/12/SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0/SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T21:50:09.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0.zip
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:50:09.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100040-664_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/07/12/SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0/SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0.zip
run script
2024-01-09T21:53:07.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0.zip
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:53:07.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:53:07.653    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:53:07.653    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:53:07.653    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110712-100043-371_L1C_052-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/27/SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0/SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T21:55:55.221    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:55:55.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0.zip
2024-01-09T21:55:55.222    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:55:55.222    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:55:55.222    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:55:55.222    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:55:55.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:55:55.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:55:55.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:55:55.223    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101339-779_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/27/SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0/SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T21:58:30.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T21:58:30.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0.zip
2024-01-09T21:58:30.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:58:30.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101348-166_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/27/SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:01:16.300    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:01:16.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101356-558_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/08/27/SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:04:32.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:32.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:32.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110827-101404-953_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/09/01/SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0.zip
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:21.161    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:21.162    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110901-101716-242_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/09/01/SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0/SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T22:10:13.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:10:13.560    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0.zip
2024-01-09T22:10:13.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:10:13.561    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110901-101729-622_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/22/SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0/SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0.zip
run script
2024-01-09T22:12:19.109    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:12:19.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0.zip
2024-01-09T22:12:19.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:12:19.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:12:19.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:12:19.112    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:12:19.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:12:19.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:12:19.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:12:19.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:13:50.747    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 161). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094619-235_L1C_053-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2011/06/22/SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0/SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:13:54.933    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:13:54.934    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:13:54.934    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:13:54.935    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR2-XS_20110622-094621-169_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/30/SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0/SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T22:16:49.624    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:16:49.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0.zip
2024-01-09T22:16:49.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:16:49.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:16:49.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:16:49.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:16:49.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:16:49.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:16:49.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:16:49.626    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100310-434_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 [2 2 2 ... 1 1 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/30/SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T22:20:00.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0.zip
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:20:00.392    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100318-803_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/12/30/SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0/SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0.zip
run script
2024-01-09T22:22:45.454    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0.zip
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:22:45.455    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:22:45.456    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:22:45.456    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:22:45.456    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20111230-100327-180_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/06/11/SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0/SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0.zip
run script
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0.zip
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:23:57.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110611-095818-297_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/25/SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0/SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T22:25:16.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0.zip
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:25:16.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100418-702_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2011/04/25/SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0/SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T22:26:55.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:26:55.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0.zip
2024-01-09T22:26:55.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:26:55.626    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:26:55.626    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:26:55.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:26:55.627    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:26:55.627    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:26:55.627    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:26:55.627    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT4-HRVIR1-XS_20110425-100427-022_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/30/SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0/SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0.zip
run script
2024-01-09T22:28:39.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:28:39.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0.zip
2024-01-09T22:28:39.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:28:39.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:28:39.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:28:39.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:28:39.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:28:39.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:28:39.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:28:39.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103117-731_L1C_046-263-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/30/SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0/SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0.zip
run script
2024-01-09T22:29:34.740    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0.zip
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:29:34.741    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:29:34.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:29:34.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103050-770_L1C_051-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/30/SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:31:45.752    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:31:45.753    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:31:45.753    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:31:45.753    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:31:45.754    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103057-259_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/30/SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0/SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0.zip
run script
2024-01-09T22:33:32.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0.zip
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:32.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:32.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:32.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:32.951    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971030-103059-966_L1C_051-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/01/15/SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0/SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0.zip
run script
2024-01-09T22:35:04.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0.zip
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:04.579    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110753-155_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/01/15/SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T22:35:08.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:08.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0.zip
2024-01-09T22:35:08.584    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:08.585    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110801-619_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/01/15/SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0/SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0.zip
run script
2024-01-09T22:35:26.986    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0.zip
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:26.987    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:26.988    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970115-110807-034_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/27/SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0/SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0.zip
run script
2024-01-09T22:35:44.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0.zip
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:44.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-281_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/27/SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0/SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T22:35:58.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:35:58.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0.zip
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:35:58.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103004-366_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/27/SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0/SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0.zip
run script
2024-01-09T22:36:11.353    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0.zip
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:11.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970527-103007-073_L1C_047-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/27/SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0/SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0.zip
run script
2024-01-09T22:36:30.882    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0.zip
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:30.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:30.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:30.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:30.884    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:36:34.204    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (722 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110506-372_L1C_047-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/27/SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T22:36:37.493    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0.zip
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:37.495    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110509-389_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/27/SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0/SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T22:36:40.835    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0.zip
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:40.836    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970927-110517-823_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/27/SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0/SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T22:36:44.359    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0.zip
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:44.360    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970927-110449-293_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0/SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0.zip
run script
2024-01-09T22:36:48.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0.zip
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:48.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:48.118    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:48.118    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:48.118    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103818-098_L1C_047-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T22:36:51.998    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0.zip
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:51.999    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:52.000    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:52.000    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:52.000    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103821-840_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T22:36:55.774    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0.zip
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:55.775    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103830-103_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0/SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T22:36:59.019    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:36:59.020    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0.zip
2024-01-09T22:36:59.020    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:59.021    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970823-103841-982_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0/SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0.zip
run script
2024-01-09T22:37:02.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:37:02.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0.zip
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:37:02.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-197_L1C_050-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T22:40:00.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:40:00.935    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0.zip
2024-01-09T22:40:00.935    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:40:00.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103818-357_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T22:43:06.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:43:06.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0.zip
2024-01-09T22:43:06.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:43:06.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:43:06.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:43:06.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:43:06.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:43:06.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:43:06.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:43:06.909    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:44:54.738    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 218). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103826-650_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:44:58.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:44:58.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:44:58.365    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:47:02.573    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (370 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103834-949_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/23/SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0/SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T22:47:05.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0.zip
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:47:05.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:47:05.801    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:47:05.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:47:05.801    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:48:40.070    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1554). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970823-103842-168_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/08/SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0/SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0.zip
run script
2024-01-09T22:48:43.078    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0.zip
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:43.079    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-639_L1C_047-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/08/SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0/SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T22:48:46.317    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0.zip
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:46.318    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103044-750_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/08/SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0/SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0.zip
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:49.735    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:49.736    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:49.736    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103052-992_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/08/SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0/SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0.zip
run script
2024-01-09T22:48:52.849    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:52.850    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0.zip
2024-01-09T22:48:52.850    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:52.850    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:52.851    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970908-103053-894_L1C_047-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/10/02/SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0/SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0.zip
run script
2024-01-09T22:48:56.132    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:56.133    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0.zip
2024-01-09T22:48:56.133    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:56.133    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:56.133    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:56.133    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:56.134    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:56.134    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:56.134    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:56.134    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110911-427_L1C_047-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/10/02/SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T22:48:59.408    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0.zip
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:59.409    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971002-110915-395_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/16/SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0/SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T22:49:03.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0.zip
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:03.270    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110916-684_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/16/SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0/SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T22:49:07.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0.zip
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:07.084    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970716-110917-954_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/12/SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0/SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0.zip
run script
2024-01-09T22:49:10.842    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:10.843    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0.zip
2024-01-09T22:49:10.843    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:10.843    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:10.844    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104613-554_L1C_047-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/12/SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T22:49:14.544    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0.zip
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:14.546    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970712-104632-008_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/09/SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0/SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0.zip
run script
2024-01-09T22:49:18.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0.zip
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:18.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:18.420    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:18.420    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:18.420    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104906-376_L1C_048-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/09/SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0.zip
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:29.014    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:29.015    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:29.015    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:29.015    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970309-104908-373_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0/SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0.zip
run script
2024-01-09T22:49:48.748    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0.zip
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:48.750    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:48.751    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:49:50.258    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 786). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105655-287_L1C_048-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T22:49:53.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:49:53.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0.zip
2024-01-09T22:49:53.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:53.569    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105659-137_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0/SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0.zip
run script
2024-01-09T22:50:09.525    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:50:09.526    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0.zip
2024-01-09T22:50:09.526    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:09.526    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:09.526    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:50:09.527    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:09.527    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:09.527    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:09.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:09.527    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970414-105706-357_L1C_048-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0/SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T22:50:31.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0.zip
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:31.662    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:52:44.339    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (90 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105725-945_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:52:47.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105728-956_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T22:54:48.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:54:48.937    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0.zip
2024-01-09T22:54:48.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:54:48.938    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:54:48.938    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:54:48.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:54:48.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:54:48.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:54:48.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:54:48.940    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105737-387_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/04/14/SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0/SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0.zip
run script
2024-01-09T22:56:11.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:56:11.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0.zip
2024-01-09T22:56:11.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:11.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:11.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:56:11.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:11.799    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:11.799    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:11.799    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:11.799    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970414-105740-997_L1C_050-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/17/SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0/SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T22:57:30.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0.zip
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:30.978    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105322-655_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/17/SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0/SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0.zip
run script
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0.zip
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:34.566    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:34.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:34.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:34.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:34.567    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970817-105326-265_L1C_048-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/17/SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T22:57:37.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0.zip
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:37.916    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970817-105319-097_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/22/SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0/SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0.zip
run script
2024-01-09T22:57:40.979    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0.zip
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:57:40.980    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-457_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/22/SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T22:58:00.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0.zip
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:00.403    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105722-704_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/22/SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0/SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0.zip
run script
2024-01-09T22:58:21.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0.zip
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:21.728    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970822-105726-313_L1C_048-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/27/SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0/SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T22:58:51.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:51.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0.zip
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:51.324    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110104-982_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/27/SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T22:58:54.929    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0.zip
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:54.930    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:54.931    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:54.931    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:54.931    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110113-386_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/27/SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0/SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0.zip
run script
2024-01-09T22:59:22.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T22:59:22.944    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0.zip
2024-01-09T22:59:22.944    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:59:22.944    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:59:22.944    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T22:59:22.944    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:59:22.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:59:22.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:59:22.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:59:22.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970827-110116-996_L1C_048-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0/SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0.zip
run script
2024-01-09T23:00:03.858    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0.zip
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:03.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:03.860    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103759-107_L1C_048-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0/SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:00:10.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:10.579    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103801-931_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:00:25.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:25.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:25.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:25.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103810-179_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:00:51.748    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:51.749    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:00:51.749    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:51.749    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:51.750    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:00:53.727    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (174 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103818-439_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0/SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T23:00:56.830    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0.zip
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:00:56.832    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103838-752_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T23:01:43.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:01:43.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0.zip
2024-01-09T23:01:43.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:43.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:43.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:01:43.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:43.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:43.212    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:43.212    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:43.212    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103841-634_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0/SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T23:02:19.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0.zip
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:02:19.758    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970918-103842-536_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0/SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0.zip
run script
2024-01-09T23:02:52.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:02:52.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0.zip
2024-01-09T23:02:52.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:02:52.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:02:52.231    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103839-080_L1C_051-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/18/SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0/SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0.zip
run script
2024-01-09T23:05:14.268    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0.zip
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:14.270    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970918-103842-885_L1C_051-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/16/SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:07:42.667    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:07:42.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:07:42.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:07:42.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:07:42.669    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104138-030_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/16/SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:07:57.866    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:07:57.868    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104146-296_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/05/16/SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:08:17.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:08:17.249    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:08:17.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:08:17.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:08:17.250    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104154-571_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/05/16/SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0/SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0.zip
run script
2024-01-09T23:08:20.712    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0.zip
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:08:20.713    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970516-104158-181_L1C_048-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0/SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T23:08:23.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0.zip
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:08:23.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104946-979_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:09:41.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:09:41.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104947-186_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:10:54.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:10:54.312    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-104955-522_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0/SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:11:52.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:11:52.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105003-863_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:12:23.244    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:12:23.245    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:12:23.246    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:12:23.246    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:12:23.246    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:12:25.668    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (218 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105012-210_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0/SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T23:12:29.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0.zip
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:12:29.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:12:29.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:12:29.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:12:29.281    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:14:47.350    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (215 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105030-342_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T23:14:50.585    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:14:50.586    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0.zip
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:14:50.587    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105033-332_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T23:16:56.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0.zip
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:16:56.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:16:56.434    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970812-105041-743_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0/SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0.zip
run script
2024-01-09T23:17:44.543    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0.zip
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:17:44.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:17:44.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:17:44.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105031-052_L1C_053-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/12/SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0/SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0.zip
run script
2024-01-09T23:20:35.661    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0.zip
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:20:35.662    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:20:35.663    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:20:35.663    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970812-105039-787_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:21:56.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:56.203    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:56.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110108-801_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0/SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T23:23:22.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0.zip
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:23:22.393    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110117-226_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:24:33.979    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:33.980    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:25:08.609    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 114). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110125-658_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0/SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0.zip
run script
2024-01-09T23:25:11.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0.zip
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:25:11.965    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110131-073_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0/SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0.zip
run script
2024-01-09T23:25:32.195    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:25:32.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0.zip
2024-01-09T23:25:32.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:25:32.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971018-110103-991_L1C_049-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T23:26:37.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:26:37.903    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0.zip
2024-01-09T23:26:37.903    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:37.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110148-547_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0/SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0.zip
run script
2024-01-09T23:27:46.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0.zip
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:46.597    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110152-155_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T23:28:42.527    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0.zip
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:28:42.528    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110112-706_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T23:33:10.364    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:33:10.366    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0.zip
2024-01-09T23:33:10.366    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:10.367    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:37:16.632    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 822). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110121-189_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/10/18/SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0/SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0.zip
run script
2024-01-09T23:37:20.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0.zip
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:20.314    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19971018-110130-576_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/06/06/SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0/SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T23:41:44.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0.zip
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:44.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:41:47.729    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (706 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103810-251_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/06/06/SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:41:51.288    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:51.290    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103814-008_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/06/06/SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0/SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0.zip
run script
2024-01-09T23:41:55.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0.zip
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:55.032    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970606-103819-422_L1C_048-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0/SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0.zip
run script
2024-01-09T23:41:59.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0.zip
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:59.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102243-136_L1C_048-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0/SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T23:42:14.473    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0.zip
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:14.475    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:14.476    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:42:18.598    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (221 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102246-839_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0/SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0.zip
run script
2024-01-09T23:42:22.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0.zip
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:22.555    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970708-102254-058_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T23:42:25.963    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:25.964    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0.zip
2024-01-09T23:42:25.964    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:25.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:25.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:25.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:25.965    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:25.965    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:25.965    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:25.965    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:42:37.706    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 21). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102316-005_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T23:42:41.095    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:41.096    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0.zip
2024-01-09T23:42:41.096    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:41.096    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:41.096    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:41.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:41.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:41.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:41.097    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:41.097    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102318-847_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/08/SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0/SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T23:42:50.240    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:50.241    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0.zip
2024-01-09T23:42:50.241    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:50.241    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:50.241    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:50.241    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:50.242    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:50.242    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:50.242    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:50.242    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:42:52.116    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1490 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970708-102322-457_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0/SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0.zip
run script
2024-01-09T23:42:55.463    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:42:55.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0.zip
2024-01-09T23:42:55.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:55.464    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:55.464    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:42:55.464    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:55.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:55.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:55.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:55.465    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105351-741_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:43:13.130    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:13.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:43:13.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:13.132    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105352-899_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T23:43:27.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0.zip
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:27.373    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105401-279_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0/SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0.zip
run script
2024-01-09T23:43:30.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0.zip
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:30.480    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105403-084_L1C_048-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0/SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0.zip
run script
2024-01-09T23:43:33.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:43:33.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0.zip
2024-01-09T23:43:33.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:43:33.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:43:33.579    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:43:33.579    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:43:33.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:43:33.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:43:33.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:43:33.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-551_L1C_049-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:44:56.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:56.916    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:56.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:56.917    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105327-788_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0/SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0.zip
run script
2024-01-09T23:46:23.340    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0.zip
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:46:23.342    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970722-105332-300_L1C_049-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/22/SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0/SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0.zip
run script
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0.zip
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:47:33.402    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:47:33.403    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:47:33.403    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:47:33.403    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:47:33.403    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:47:36.013    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (280 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970722-105402-570_L1C_054-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0/SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0.zip
run script
2024-01-09T23:47:39.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:47:39.073    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0.zip
2024-01-09T23:47:39.073    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:47:39.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105751-005_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T23:48:00.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0.zip
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:00.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:00.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:00.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:00.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105752-190_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T23:48:16.015    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0.zip
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:16.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:16.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:16.017    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:16.017    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105800-600_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0/SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T23:48:19.298    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0.zip
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:19.299    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105809-017_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T23:48:22.423    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0.zip
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:22.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105726-992_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0/SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T23:49:54.734    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0.zip
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:49:54.735    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970917-105733-309_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0/SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0.zip
run script
2024-01-09T23:51:14.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:51:14.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0.zip
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:51:14.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105750-957_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T23:52:17.215    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0.zip
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:52:17.216    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105751-249_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T23:53:16.922    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0.zip
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:16.923    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105759-671_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T23:53:49.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0.zip
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:49.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:49.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:49.433    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:53:51.642    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (141 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105808-093_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T23:53:55.472    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0.zip
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:55.474    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105816-525_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0/SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T23:53:58.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0.zip
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:53:58.757    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105724-898_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T23:57:24.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0.zip
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:57:24.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105725-184_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/17/SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T00:00:56.032    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:00:56.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0.zip
2024-01-10T00:00:56.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:00:56.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:00:56.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970917-105733-601_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/01/SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0.zip
run script
2024-01-10T00:04:23.938    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0.zip
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:04:23.939    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110144-330_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/01/SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0/SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0.zip
run script
2024-01-10T00:04:39.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:04:39.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0.zip
2024-01-10T00:04:39.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:04:39.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:04:39.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:04:39.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:04:39.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:04:39.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:04:39.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:04:39.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110145-232_L1C_048-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/08/01/SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0/SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0.zip
run script
2024-01-10T00:04:51.463    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0.zip
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:04:51.465    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970801-110208-391_L1C_050-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/01/26/SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0.zip
run script
2024-01-10T00:05:56.927    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0.zip
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:56.928    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:56.929    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105715-262_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/01/26/SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0/SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0.zip
run script
2024-01-10T00:06:00.343    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:06:00.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0.zip
2024-01-10T00:06:00.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:00.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:00.344    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970126-105721-578_L1C_048-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/12/14/SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0/SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0.zip
run script
2024-01-10T00:06:04.392    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0.zip
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:04.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:04.394    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110525-033_L1C_048-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/12/14/SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0.zip
run script
2024-01-10T00:06:07.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0.zip
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:07.951    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:07.952    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971214-110526-284_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/01/SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0/SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0.zip
run script
2024-01-10T00:06:11.296    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0.zip
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:11.297    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970901-110455-585_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0/SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0.zip
run script
2024-01-10T00:06:14.346    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0.zip
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:14.347    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105001-111_L1C_049-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0.zip
run script
2024-01-10T00:07:14.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:07:14.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0.zip
2024-01-10T00:07:14.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:14.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:14.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:07:14.992    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:14.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:14.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:14.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:14.992    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:08:01.763    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 1548). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105002-236_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:08:05.284    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:08:05.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105010-589_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0/SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0.zip
run script
2024-01-10T00:08:35.985    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:08:35.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0.zip
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:08:35.987    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105011-491_L1C_049-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0/SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0.zip
run script
2024-01-10T00:09:08.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0.zip
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:09:08.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:09:08.304    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:09:08.304    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:09:08.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105028-983_L1C_053-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0/SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0.zip
run script
2024-01-10T00:12:11.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:12:11.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0.zip
2024-01-10T00:12:11.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:12:11.733    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105030-189_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0/SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0.zip
run script
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0.zip
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:15:09.034    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970907-105038-310_L1C_053-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/07/SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0/SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0.zip
run script
2024-01-10T00:16:34.864    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0.zip
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:34.865    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:16:37.371    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (492 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970907-105028-883_L1C_054-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/03/25/SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0/SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0.zip
run script
2024-01-10T00:16:40.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0.zip
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:16:40.822    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:16:40.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104158-667_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/25/SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:17:17.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:17.725    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104201-557_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/25/SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T00:17:43.210    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:43.211    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0.zip
2024-01-10T00:17:43.211    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:43.211    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:43.211    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:43.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:43.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:43.212    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:43.212    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:43.212    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:17:45.399    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (894 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104209-869_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/03/25/SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0/SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0.zip
run script
2024-01-10T00:17:48.898    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0.zip
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:48.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:48.900    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:48.900    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:48.900    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104218-189_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/25/SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:17:52.505    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:52.506    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:52.507    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:52.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:52.507    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970325-104226-515_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/03/29/SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0/SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0.zip
run script
2024-01-10T00:17:55.955    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:17:55.956    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0.zip
2024-01-10T00:17:55.956    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:17:55.957    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110509-389_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/29/SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:18:45.866    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:18:45.868    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110510-646_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/29/SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0/SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0.zip
run script
2024-01-10T00:19:26.837    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0.zip
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:19:26.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970329-110514-256_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/03/29/SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:19:57.369    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:19:57.370    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:19:57.371    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970329-110535-327_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/11/SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0/SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0.zip
run script
2024-01-10T00:20:01.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0.zip
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:20:01.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110520-526_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/11/SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:20:54.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:20:54.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:20:54.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:20:54.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:20:54.116    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110523-588_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/11/SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T00:21:42.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:21:42.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0.zip
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:21:42.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110532-068_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/11/SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0/SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0.zip
run script
2024-01-10T00:21:52.337    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0.zip
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:21:52.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:21:52.339    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970711-110536-580_L1C_049-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/27/SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0.zip
run script
2024-01-10T00:21:55.930    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:21:55.931    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0.zip
2024-01-10T00:21:55.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:21:55.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:21:55.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:21:55.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:21:55.932    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:21:55.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:21:55.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:21:55.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:22:52.750    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 204). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105743-145_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1997/07/27/SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:22:55.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:22:55.841    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:22:55.841    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:22:55.841    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:22:55.841    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:22:55.842    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:22:55.842    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:22:55.842    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:22:55.842    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:22:55.842    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105751-555_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/27/SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0/SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0.zip
run script
2024-01-10T00:23:37.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0.zip
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:23:37.791    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970727-105754-262_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/27/SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0/SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0.zip
run script
2024-01-10T00:24:05.323    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:24:05.324    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0.zip
2024-01-10T00:24:05.324    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:24:05.325    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970727-105814-690_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0/SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0.zip
run script
2024-01-10T00:24:59.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:24:59.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0.zip
2024-01-10T00:24:59.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:24:59.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:24:59.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-064_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0.zip
run script
2024-01-10T00:25:35.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:25:35.994    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0.zip
2024-01-10T00:25:35.994    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:25:35.994    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:25:35.995    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105401-323_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0.zip
run script
2024-01-10T00:26:10.353    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0.zip
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:26:10.354    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:26:10.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:26:13.228    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (227 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105409-709_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0.zip
run script
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0.zip
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:26:16.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:26:16.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:26:16.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:26:16.502    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105418-098_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0/SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0.zip
run script
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0.zip
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:26:20.310    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:26:20.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:26:20.311    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105422-610_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0/SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0.zip
run script
2024-01-10T00:26:23.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0.zip
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:26:23.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105332-259_L1C_050-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0.zip
run script
2024-01-10T00:29:22.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:29:22.498    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0.zip
2024-01-10T00:29:22.498    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:29:22.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:29:22.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:29:22.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:29:22.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:29:22.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:29:22.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:29:22.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105334-323_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0.zip
run script
2024-01-10T00:32:53.129    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0.zip
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:32:53.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:32:53.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970912-105342-712_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0.zip
run script
2024-01-10T00:36:16.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:36:16.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0.zip
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:36:16.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105340-898_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/09/12/SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0/SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0.zip
run script
2024-01-10T00:40:23.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0.zip
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:40:23.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970912-105342-703_L1C_051-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 1 1 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/01/SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0/SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0.zip
run script
2024-01-10T00:44:13.291    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:13.292    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0.zip
2024-01-10T00:44:13.292    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:13.292    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:13.293    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104158-007_L1C_049-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/02/01/SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0.zip
run script
2024-01-10T00:44:16.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:16.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0.zip
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:16.767    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104159-108_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/02/01/SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:44:20.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:20.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:44:20.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:20.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:20.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:20.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:20.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:20.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:20.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:20.533    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970201-104207-437_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/04/30/SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0/SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0.zip
run script
2024-01-10T00:44:26.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0.zip
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:26.224    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970430-105013-438_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/06/SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T00:44:30.201    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0.zip
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:30.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:30.203    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:30.203    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:30.203    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110152-954_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/06/SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0/SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0.zip
run script
2024-01-10T00:44:33.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0.zip
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:33.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:33.501    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970706-110156-903_L1C_049-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/07/SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0.zip
run script
2024-01-10T00:44:36.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0.zip
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:36.554    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104236-335_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/07/SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:44:39.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:39.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:39.789    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104239-246_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/07/07/SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0.zip
run script
2024-01-10T00:44:43.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0.zip
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:44:43.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104147-786_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/07/SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0/SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0.zip
run script
2024-01-10T00:47:54.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:47:54.632    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0.zip
2024-01-10T00:47:54.635    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:47:54.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:47:54.641    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:47:54.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:47:54.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:47:54.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:47:54.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:47:54.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970707-104148-688_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/07/07/SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0/SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0.zip
run script
2024-01-10T00:50:55.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0.zip
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:50:55.087    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:50:55.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970707-104148-775_L1C_051-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/21/SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0.zip
run script
2024-01-10T00:53:45.539    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:53:45.540    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0.zip
2024-01-10T00:53:45.540    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:53:45.540    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:53:45.541    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105741-308_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/21/SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0/SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0.zip
run script
2024-01-10T00:54:05.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0.zip
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:54:05.855    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105712-984_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/21/SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0.zip
run script
2024-01-10T00:56:02.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:56:02.942    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0.zip
2024-01-10T00:56:02.942    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:56:02.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105715-998_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/21/SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0.zip
run script
2024-01-10T00:57:51.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0.zip
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:57:51.719    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105724-430_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/21/SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0.zip
run script
2024-01-10T00:59:05.306    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0.zip
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:59:05.308    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19970221-105732-867_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/11/14/SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0/SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0.zip
run script
2024-01-10T01:00:02.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0.zip
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:00:02.800    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104126-551_L1C_050-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/11/14/SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0/SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0.zip
run script
2024-01-10T01:00:05.750    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:00:05.751    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0.zip
2024-01-10T01:00:05.751    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:00:05.752    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV1-XS_19971114-104127-453_L1C_050-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1997/02/16/SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0/SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0.zip
run script
2024-01-10T01:00:09.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:00:09.416    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0.zip
2024-01-10T01:00:09.416    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:00:09.416    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:00:09.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105259-309_L1C_050-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1997/02/16/SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0/SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0.zip
/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0.zip
run script
2024-01-10T01:03:20.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0.zip
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T01:03:20.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T01:03:20.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016229/INPUT/SPOT2-HRV2-XS_19970216-105302-918_L1C_050-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016229/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-BLUE_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-BLUE_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-10 01:06:46.209314768+00:00] cnes_level2/barrouz/4016229:  Account (env) = cnes_level2
[2024-01-10 01:06:46.210901017+00:00] cnes_level2/barrouz/4016229:     User (env) = barrouz
[2024-01-10 01:06:46.212591445+00:00] cnes_level2/barrouz/4016229:        GroupId = cesbio(426000053)
[2024-01-10 01:06:46.214076854+00:00] cnes_level2/barrouz/4016229:         UserId = barrouz(9134)
[2024-01-10 01:06:46.215441205+00:00] cnes_level2/barrouz/4016229:        Account = cnes_level2
[2024-01-10 01:06:46.216977384+00:00] cnes_level2/barrouz/4016229:        Account = cnes_level2
[2024-01-10 01:06:46.218316435+00:00] cnes_level2/barrouz/4016229:      Partition = cpu2022
[2024-01-10 01:06:46.219590706+00:00] cnes_level2/barrouz/4016229:            QOS = cpu_2022_1280
[2024-01-10 01:06:46.220789437+00:00] cnes_level2/barrouz/4016229:        JobName = inf_ALP_31_TCD-BLUE_AVG-1200
[2024-01-10 01:06:46.222387296+00:00] cnes_level2/barrouz/4016229:     SubmitTime = 2024-01-09T10:52:00
[2024-01-10 01:06:46.224041935+00:00] cnes_level2/barrouz/4016229:        RunTime = 05:59:09
[2024-01-10 01:06:46.225668653+00:00] cnes_level2/barrouz/4016229:      TimeLimit = 1-16:00:00
[2024-01-10 01:06:46.227288192+00:00] cnes_level2/barrouz/4016229:   EligibleTime = 2024-01-09T10:52:00
[2024-01-10 01:06:46.228741472+00:00] cnes_level2/barrouz/4016229:      StartTime = 2024-01-09T19:07:37
[2024-01-10 01:06:46.230202632+00:00] cnes_level2/barrouz/4016229:        EndTime = 2024-01-10T01:06:46
[2024-01-10 01:06:46.231784211+00:00] cnes_level2/barrouz/4016229:       ExitCode = 0:0
[2024-01-10 01:06:46.233364499+00:00] cnes_level2/barrouz/4016229:       NodeList = trex030
[2024-01-10 01:06:46.234829579+00:00] cnes_level2/barrouz/4016229:      BatchHost = trex030
[2024-01-10 01:06:46.236292739+00:00] cnes_level2/barrouz/4016229:           TRES = 
[2024-01-10 01:06:46.237897148+00:00] cnes_level2/barrouz/4016229:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 01:06:46.239453417+00:00] cnes_level2/barrouz/4016229:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 01:06:46.241204925+00:00] cnes_level2/barrouz/4016229:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_31_TCD-BLUE_AVG-1200.log
[2024-01-10 01:06:46.242765834+00:00] cnes_level2/barrouz/4016229:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_31_TCD-BLUE_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016229
JobID                : 4016229
JobName              : inf_ALP_31_TCD-BLUE_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex030 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:52:00
Start time           : 2024-01-09T19:07:37
End time             : 2024-01-10T01:06:46
Elapsed time         : 05:59:09  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 1 day, 23:53:12
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_31_TCD-BLUE_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_31_TCD-BLUE_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T19:07:37 2024-01-10T01:06:46 05:59:09  1-03:49:05 1-23:53:12         0.175M  174951.09M    72758.21M 100841168K          0    trex030      1 19:14:16   trex030
   extern  | extern       COMPLETED   0:0    2024-01-09T19:07:37 2024-01-10T01:06:46 05:59:09  00:00.001  1-23:53:12         0.175M       0.00M        0.00M      1708K          0    trex030      1 00:00:00   trex030

