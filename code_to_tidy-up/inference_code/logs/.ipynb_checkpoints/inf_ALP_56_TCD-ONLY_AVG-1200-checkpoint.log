unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/56.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/56.txt
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:04:31.288    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:04:31.289    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:04:31.289    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:04:31.289    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:04:31.289    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:04:31.289    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:04:31.290    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:04:31.290    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:04:31.290    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:04:31.290    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103438-610_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:05:08.953    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:08.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:08.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:08.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:08.955    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103446-904_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0/SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T16:05:24.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0.zip
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:24.585    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050117-103449-611_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0/SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T16:05:36.786    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:36.787    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0.zip
2024-01-09T16:05:36.787    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:36.788    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:07:05.582    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 216). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-633_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:07:08.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:08.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:07:08.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:08.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:08.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:08:34.677    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103428-801_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:08:37.767    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:08:37.768    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:08:37.768    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:08:37.768    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:08:37.768    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:08:37.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:08:37.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:08:37.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:08:37.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:08:37.769    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:10:39.033    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (810 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103437-100_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T16:10:42.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:10:42.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0.zip
2024-01-09T16:10:42.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:10:42.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:10:42.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:10:42.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:10:42.155    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:10:42.155    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:10:42.155    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:10:42.155    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103445-406_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/17/SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0/SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0.zip
run script
2024-01-09T16:11:52.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:52.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0.zip
2024-01-09T16:11:52.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:52.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:52.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:52.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:52.505    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:52.505    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:52.505    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:52.505    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050117-103449-918_L1C_050-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]
 [2 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/02/18/SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T16:13:02.586    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:13:02.587    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0.zip
2024-01-09T16:13:02.587    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:13:02.587    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:13:02.587    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:13:02.587    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:13:02.588    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:13:02.588    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:13:02.588    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:13:02.588    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101818-751_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/02/18/SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:14:21.774    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:14:21.775    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:14:21.776    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101835-202_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/02/18/SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:15:18.502    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:15:18.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101843-441_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/02/18/SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T16:15:58.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0.zip
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:15:58.715    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101851-692_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/02/18/SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:16:30.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:16:30.488    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050218-101859-949_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/01/SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0/SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0.zip
run script
2024-01-09T16:16:47.846    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:16:47.847    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0.zip
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:16:47.848    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-304_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/01/SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:17:15.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:15.135    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104239-512_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/01/SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:17:42.073    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:42.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:17:42.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:42.075    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:17:44.845    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (221 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104247-844_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/01/SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T16:17:47.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:47.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0.zip
2024-01-09T16:17:47.988    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:47.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:47.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:47.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:47.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:47.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:47.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:47.991    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104256-185_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/01/SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:17:51.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:51.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:17:51.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:51.440    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050101-104304-533_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0/SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0.zip
run script
2024-01-09T16:17:54.635    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0.zip
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:54.637    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-745_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:18:29.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:18:29.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:18:29.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:18:29.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:18:29.219    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102705-874_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:19:03.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:03.861    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102714-137_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0/SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0.zip
run script
2024-01-09T16:19:21.123    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0.zip
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:21.124    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:21.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:21.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:21.125    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:19:23.218    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 34). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050107-102715-942_L1C_049-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T16:19:26.626    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0.zip
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:26.627    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:26.628    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102631-679_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0/SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T16:20:15.503    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0.zip
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:20:15.505    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102639-912_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/07/SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0/SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0.zip
run script
2024-01-09T16:22:29.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0.zip
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:22:29.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:22:29.185    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:22:29.185    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:24:01.061    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 170). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050107-102644-424_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/27/SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0/SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0.zip
run script
2024-01-09T16:24:04.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0.zip
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:04.767    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104209-262_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/27/SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:24:39.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:39.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104217-802_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/27/SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0/SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T16:24:53.316    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0.zip
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:53.318    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050127-104227-048_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0/SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T16:24:56.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0.zip
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:24:56.602    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101922-684_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T16:25:43.031    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:43.032    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0.zip
2024-01-09T16:25:43.032    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:43.032    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:43.032    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:43.032    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:43.033    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:43.033    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:43.033    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:43.033    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101926-405_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0/SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0.zip
run script
2024-01-09T16:26:23.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0.zip
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:26:23.646    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101928-210_L1C_049-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0/SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T16:27:02.138    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0.zip
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:02.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:02.140    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:02.140    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101943-797_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:27:18.049    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:18.050    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:27:18.050    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:18.050    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:18.050    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:18.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:18.051    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:18.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:18.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:18.051    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050411-101951-155_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0/SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0.zip
run script
2024-01-09T16:27:21.265    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0.zip
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:21.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:21.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:21.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101944-483_L1C_051-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:29:19.505    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:29:19.506    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:29:19.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:29:19.507    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101949-142_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/11/SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:30:55.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:30:55.007    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050411-101957-420_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/22/SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0/SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T16:31:34.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0.zip
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:34.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103151-736_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/22/SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:31:45.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:45.329    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:45.330    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103157-301_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/05/22/SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T16:31:48.395    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0.zip
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:48.396    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103205-585_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/05/22/SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:31:51.361    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:51.362    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:51.363    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050522-103213-875_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/02/SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:31:54.728    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:54.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102327-300_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/02/SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T16:32:07.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:07.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0.zip
2024-01-09T16:32:07.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:07.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:07.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:07.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:07.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:07.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:07.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:07.518    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102335-556_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/02/SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0/SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:32:10.974    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:10.975    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:10.976    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050102-102343-819_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/06/SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:32:14.086    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:14.087    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:32:14.087    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:14.087    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:14.088    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104634-071_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/06/SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0/SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0.zip
run script
2024-01-09T16:32:29.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:29.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0.zip
2024-01-09T16:32:29.936    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:29.936    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:29.936    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:29.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:29.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:29.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:29.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:29.937    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050106-104640-388_L1C_049-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/01/21/SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T16:32:33.814    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:33.815    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0.zip
2024-01-09T16:32:33.815    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:33.815    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:33.815    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:33.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:33.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:33.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:33.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:33.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105751-115_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/21/SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0/SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0.zip
run script
2024-01-09T16:32:50.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:50.557    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0.zip
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:50.558    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050121-105758-335_L1C_049-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0/SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0.zip
run script
2024-01-09T16:32:53.823    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0.zip
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:53.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:53.825    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:53.825    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:53.825    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104219-424_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T16:32:57.090    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0.zip
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:32:57.091    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104223-239_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0/SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T16:33:00.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0.zip
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:00.323    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104138-239_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0/SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T16:35:44.156    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0.zip
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:44.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:44.158    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:44.158    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104138-374_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T16:38:27.173    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0.zip
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:38:27.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104146-568_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0/SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T16:40:52.822    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:40:52.823    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0.zip
2024-01-09T16:40:52.823    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:40:52.823    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:40:52.823    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:40:52.824    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:40:52.824    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:40:52.824    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:40:52.824    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:40:52.824    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104146-703_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T16:43:14.886    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0.zip
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:43:14.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104154-903_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 1 1 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0/SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T16:45:51.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:45:51.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0.zip
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:45:51.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051009-104200-318_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0/SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T16:48:19.470    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0.zip
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:48:19.472    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104155-036_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/09/SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0/SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0.zip
run script
2024-01-09T16:50:54.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:50:54.298    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0.zip
2024-01-09T16:50:54.298    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:50:54.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051009-104159-548_L1C_051-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/02/SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0/SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T16:53:20.592    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0.zip
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:20.593    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:20.594    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101517-257_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/05/02/SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0/SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0.zip
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:24.174    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101525-444_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/02/SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T16:54:17.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:54:17.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0.zip
2024-01-09T16:54:17.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:54:17.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:54:17.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:54:17.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:54:17.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:54:17.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:54:17.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:54:17.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101533-644_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/02/SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T16:57:01.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:57:01.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0.zip
2024-01-09T16:57:01.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:01.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:01.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:57:01.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:01.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:01.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:01.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:01.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101541-853_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/02/SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0/SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0.zip
run script
2024-01-09T17:00:04.974    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0.zip
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:00:04.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050502-101544-560_L1C_050-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/17/SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0/SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0.zip
run script
2024-01-09T17:03:02.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0.zip
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:02.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:02.952    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:02.952    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:02.952    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:03:06.392    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 203). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102714-970_L1C_050-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2005/05/17/SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0/SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T17:03:10.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:10.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0.zip
2024-01-09T17:03:10.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:10.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:10.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:10.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:10.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:10.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:10.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:10.100    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102726-019_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/17/SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0/SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T17:05:29.690    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:05:29.691    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0.zip
2024-01-09T17:05:29.691    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:05:29.692    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102734-264_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/17/SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:07:54.579    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:07:54.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:07:54.581    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:07:54.581    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:09:23.247    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 460). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050517-102742-518_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0/SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T17:09:26.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0.zip
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:09:26.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:09:26.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:09:26.547    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102730-342_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T17:09:29.950    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0.zip
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:09:29.951    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:09:29.952    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:09:29.952    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:09:29.952    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102746-799_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0/SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T17:11:47.817    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0.zip
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:47.819    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102755-044_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 2 2 ... 2 2 2]
 [2 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:14:10.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:10.048    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:15:40.179    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 922). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102803-295_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:15:43.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:43.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102811-555_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T17:17:18.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0.zip
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:18.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102819-824_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0/SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T17:18:27.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0.zip
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:18:27.419    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102828-102_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/12/SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0/SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T17:19:33.251    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:19:33.252    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0.zip
2024-01-09T17:19:33.252    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:19:33.252    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:19:33.253    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050612-102836-389_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/20/SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0/SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T17:20:22.806    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0.zip
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:22.808    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102950-523_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2005/10/20/SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T17:20:26.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0.zip
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:20:26.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:20:26.491    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:20:26.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-102958-747_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/20/SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:21:13.195    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:21:13.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:21:13.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:21:13.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:21:13.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:21:13.197    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:21:13.197    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:21:13.197    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:21:13.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:21:13.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:22:42.498    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 922). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103023-478_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/10/20/SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0/SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T17:22:46.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:22:46.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0.zip
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:22:46.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051020-103024-381_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/11/SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0/SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0.zip
run script
2024-01-09T17:24:33.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0.zip
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:24:33.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:24:33.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:24:33.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-104954-250_L1C_050-257-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [0 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/11/SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:27:22.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:27:22.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:29:04.043    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 474). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105001-740_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/11/SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0/SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0.zip
run script
2024-01-09T17:29:08.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0.zip
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:29:08.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:29:08.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:29:08.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:30:53.210    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (148 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050111-105008-959_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/12/SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0/SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T17:30:57.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:30:57.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0.zip
2024-01-09T17:30:57.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:30:57.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:30:57.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:30:57.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:30:57.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:30:57.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:30:57.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:30:57.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:32:23.771    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 221). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-587_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/12/SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:32:27.256    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:32:27.257    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:33:52.066    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 446). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103042-737_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/01/12/SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0/SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0.zip
run script
2024-01-09T17:33:55.572    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:55.573    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0.zip
2024-01-09T17:33:55.573    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:55.574    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050112-103047-249_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/16/SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0/SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0.zip
run script
2024-01-09T17:35:51.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0.zip
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:35:51.238    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105345-120_L1C_050-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/16/SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:38:43.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:38:43.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:38:43.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:38:43.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:38:43.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105347-232_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/01/16/SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0/SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0.zip
run script
2024-01-09T17:41:12.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:41:12.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0.zip
2024-01-09T17:41:12.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:41:12.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:41:12.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:41:12.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:41:12.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:41:12.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:41:12.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:41:12.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:41:15.077    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 254). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050116-105349-939_L1C_050-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0/SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T17:41:18.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0.zip
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:41:18.961    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:42:43.807    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 216). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-582_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:42:47.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:42:47.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:42:47.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:42:47.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:42:47.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:42:47.144    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:42:47.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:42:47.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:42:47.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:42:47.144    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:44:11.564    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103436-750_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:44:14.763    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:44:14.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:44:14.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103445-052_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0/SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T17:45:51.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:45:51.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0.zip
2024-01-09T17:45:51.488    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:45:51.488    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:45:51.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:45:51.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:45:51.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:45:51.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:45:51.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:45:51.489    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103446-857_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0/SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0.zip
run script
2024-01-09T17:47:21.993    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:47:21.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0.zip
2024-01-09T17:47:21.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:47:21.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103503-539_L1C_051-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T17:48:55.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:48:55.533    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0.zip
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:48:55.534    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103509-164_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/05/SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T17:50:07.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:50:07.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0.zip
2024-01-09T17:50:07.779    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:50:07.780    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050405-103517-500_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0/SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T17:50:35.125    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:50:35.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0.zip
2024-01-09T17:50:35.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:50:35.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:50:35.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:50:35.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:50:35.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:50:35.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:50:35.127    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:50:35.127    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101514-812_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:53:21.554    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:53:21.556    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:55:10.328    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 268). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101517-619_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0/SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0.zip
run script
2024-01-09T17:55:13.945    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:55:13.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0.zip
2024-01-09T17:55:13.945    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:55:13.945    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:55:13.946    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101523-936_L1C_050-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0/SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0.zip
run script
2024-01-09T17:57:46.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:57:46.407    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0.zip
2024-01-09T17:57:46.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:57:46.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:57:46.409    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:57:46.409    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:57:46.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:57:46.409    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:57:46.410    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:57:46.410    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101534-990_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T17:59:28.113    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:59:28.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0.zip
2024-01-09T17:59:28.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:59:28.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:59:28.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:59:28.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:59:28.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:59:28.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:59:28.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:59:28.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101542-336_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0/SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T18:01:04.522    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:01:04.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0.zip
2024-01-09T18:01:04.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:01:04.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:01:04.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:01:04.524    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:01:04.524    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:01:04.524    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:01:04.524    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:01:04.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101550-592_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/06/SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0/SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T18:02:20.051    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0.zip
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:02:20.053    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050406-101558-858_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/26/SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0/SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0.zip
run script
2024-01-09T18:02:50.358    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:02:50.359    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0.zip
2024-01-09T18:02:50.359    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:02:50.359    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:02:50.359    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:02:50.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:02:50.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:02:50.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:02:50.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:02:50.360    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:04:16.928    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 446). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103111-985_L1C_050-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/26/SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:04:20.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:04:20.105    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:04:20.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:04:20.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:04:20.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:04:20.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:04:20.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:04:20.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:04:20.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:04:20.108    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:05:46.843    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1802). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103112-135_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/26/SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0.zip
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:05:50.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103120-413_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/26/SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0/SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T18:07:15.397    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0.zip
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:07:15.398    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:07:15.399    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:07:15.399    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:07:15.399    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050426-103124-023_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/21/SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0/SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0.zip
run script
2024-01-09T18:08:34.475    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:08:34.476    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0.zip
2024-01-09T18:08:34.476    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:08:34.476    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:08:34.477    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105055-193_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/21/SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:10:36.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:10:36.394    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:10:36.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:10:36.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:12:09.123    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 219). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105056-363_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/05/21/SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T18:12:12.435    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0.zip
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:12:12.436    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:12:12.437    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105104-759_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/21/SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0/SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T18:13:33.417    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0.zip
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:13:33.418    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:14:30.242    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 134). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050521-105111-978_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/07/24/SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0/SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T18:14:34.146    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:14:34.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0.zip
2024-01-09T18:14:34.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:14:34.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:14:34.147    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:14:34.148    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:14:34.148    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:14:34.148    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:14:34.148    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:14:34.148    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102105-341_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/24/SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:16:53.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:16:53.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:16:53.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:16:53.856    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:18:29.022    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 502). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102109-056_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/07/24/SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0/SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0.zip
run script
2024-01-09T18:18:32.575    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:18:32.576    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0.zip
2024-01-09T18:18:32.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:18:32.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:18:32.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:18:32.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:18:32.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:18:32.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:18:32.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:18:32.577    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050724-102116-275_L1C_050-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/28/SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0/SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T18:20:18.593    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:20:18.594    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0.zip
2024-01-09T18:20:18.594    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:20:18.595    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104420-902_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/28/SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:22:19.101    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:22:19.102    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:23:44.770    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 436). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104424-725_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/07/28/SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0/SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0.zip
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:23:47.921    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050728-104428-334_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/21/SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T18:25:14.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:25:14.132    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0.zip
2024-01-09T18:25:14.132    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:25:14.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:25:14.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:25:14.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:25:14.133    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:25:14.133    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:25:14.133    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:25:14.133    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T18:26:42.430    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 922). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102714-113_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2005/04/21/SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T18:26:45.654    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0.zip
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:26:45.655    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102722-376_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/04/21/SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0/SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T18:28:12.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0.zip
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:28:12.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050421-102724-180_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/12/15/SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0/SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T18:29:37.740    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:29:37.741    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0.zip
2024-01-09T18:29:37.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:29:37.742    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20051215-105345-252_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/29/SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0/SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T18:30:27.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:30:27.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0.zip
2024-01-09T18:30:27.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:30:27.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105755-486_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/10/29/SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0/SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T18:33:12.017    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:33:12.018    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0.zip
2024-01-09T18:33:12.018    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:33:12.018    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:33:12.018    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:33:12.018    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:33:12.019    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:33:12.019    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:33:12.019    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:33:12.019    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051029-105800-901_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/07/SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T18:35:39.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:35:39.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0.zip
2024-01-09T18:35:39.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:35:39.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:35:39.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:35:39.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:35:39.480    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:35:39.480    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:35:39.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:35:39.480    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-101954-484_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/07/SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T18:38:13.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:38:13.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0.zip
2024-01-09T18:38:13.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:38:13.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:38:13.789    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102002-741_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/07/SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0/SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T18:40:24.558    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:40:24.559    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0.zip
2024-01-09T18:40:24.559    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:40:24.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102011-010_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/05/07/SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0/SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T18:42:48.849    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:42:48.850    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0.zip
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:42:48.851    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050507-102019-285_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/11/10/SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0/SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0.zip
run script
2024-01-09T18:44:49.922    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:44:49.923    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0.zip
2024-01-09T18:44:49.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:44:49.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:44:49.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:44:49.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:44:49.924    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:44:49.924    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:44:49.924    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:44:49.924    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102709-934_L1C_053-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/11/10/SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0/SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T18:47:03.909    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0.zip
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:47:03.910    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:47:03.911    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:47:03.911    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102711-002_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/11/10/SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0/SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T18:49:17.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0.zip
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:49:17.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051110-102719-295_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/22/SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0/SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T18:51:13.974    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:51:13.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0.zip
2024-01-09T18:51:13.975    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:51:13.975    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:51:13.976    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103620-722_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/22/SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0/SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T18:53:09.469    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0.zip
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:53:09.470    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050622-103629-075_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/11/09/SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0/SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0.zip
run script
2024-01-09T18:55:05.206    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:55:05.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0.zip
2024-01-09T18:55:05.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:55:05.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:55:05.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20051109-104645-101_L1C_053-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/18/SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T18:56:05.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0.zip
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:56:05.667    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101302-888_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/18/SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T18:57:20.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:57:20.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0.zip
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:57:20.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050618-101311-151_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/27/SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0/SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T18:58:39.191    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0.zip
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:58:39.192    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:58:39.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:58:39.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:58:39.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104017-052_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/06/27/SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T18:59:53.251    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0.zip
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T18:59:53.252    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV2-XS_20050627-104025-448_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/14/SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T19:01:16.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0.zip
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:01:16.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:01:16.263    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:01:16.263    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:01:16.263    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101334-427_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/14/SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T19:02:25.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:02:25.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0.zip
2024-01-09T19:02:25.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:02:25.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101342-693_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/07/14/SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0/SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0.zip
run script
2024-01-09T19:03:38.369    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0.zip
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:03:38.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:03:38.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:03:38.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:03:38.371    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050714-101347-205_L1C_055-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/08/09/SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T19:04:39.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0.zip
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:04:39.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101401-101_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2005/08/09/SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0/SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T19:05:49.532    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:05:49.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0.zip
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:05:49.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT2-HRV1-XS_20050809-101409-367_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/28/SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0/SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T19:07:02.447    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0.zip
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:02.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105847-536_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/28/SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0/SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T19:07:31.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:07:31.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0.zip
2024-01-09T19:07:31.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:07:31.885    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860728-105855-658_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/29/SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0/SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T19:09:45.352    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:09:45.353    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0.zip
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:09:45.354    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860729-103829-888_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0.zip
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:09:48.152    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102231-929_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0/SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T19:09:51.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0.zip
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:09:51.036    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102240-120_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0/SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T19:10:18.705    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:10:18.706    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0.zip
2024-01-09T19:10:18.706    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:10:18.706    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:10:18.706    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:10:18.707    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:10:18.707    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:10:18.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:10:18.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:10:18.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-242_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0/SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T19:11:24.258    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0.zip
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:11:24.260    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861116-102248-317_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T19:12:27.278    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:12:27.279    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0.zip
2024-01-09T19:12:27.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:27.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:27.280    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102229-288_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/11/16/SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0/SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0.zip
run script
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0.zip
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:12:30.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:12:30.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:12:30.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:12:30.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861116-102253-831_L1C_051-256-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 1 1 2]
 [0 0 0 ... 1 1 2]
 [0 0 0 ... 1 1 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/17/SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0/SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T19:15:15.653    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:15.654    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0.zip
2024-01-09T19:15:15.654    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:15.654    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:15.655    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104631-802_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/06/17/SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0.zip
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:19.099    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104640-131_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/06/17/SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T19:15:22.366    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0.zip
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:22.368    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860617-104648-466_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/04/26/SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T19:15:25.718    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0.zip
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:25.719    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:25.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:25.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:25.720    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860426-104639-738_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/07/13/SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:29.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:29.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:29.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:29.121    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104549-836_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/07/13/SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0/SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0.zip
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:15:32.685    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:15:32.686    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:15:32.686    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104558-153_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/13/SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0/SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0.zip
run script
2024-01-09T19:16:22.172    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0.zip
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:16:22.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860713-104606-274_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/09/SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T19:18:54.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0.zip
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:54.076    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860809-102634-894_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T19:18:57.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:18:57.092    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0.zip
2024-01-09T19:18:57.092    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:18:57.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:18:57.092    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:18:57.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:18:57.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:18:57.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:18:57.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:18:57.093    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104226-692_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T19:23:04.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:23:04.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0.zip
2024-01-09T19:23:04.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:23:04.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:23:04.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:23:04.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:23:04.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:23:04.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:23:04.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:23:04.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T19:35:22.486    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 218). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104235-006_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0.zip
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T19:35:26.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104243-329_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T20:17:08.315    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0.zip
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T20:17:08.317    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104251-661_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T21:56:34.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0.zip
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:56:34.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104259-996_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T21:59:15.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T21:59:15.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0.zip
2024-01-09T21:59:15.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T21:59:15.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T21:59:15.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T21:59:15.284    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T21:59:15.284    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T21:59:15.284    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T21:59:15.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T21:59:15.284    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860803-104308-340_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T22:00:27.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:00:27.119    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0.zip
2024-01-09T22:00:27.119    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:00:27.119    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:00:27.119    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:00:27.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:00:27.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:00:27.120    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:00:27.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:00:27.120    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104302-839_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/08/03/SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0/SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T22:01:43.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0.zip
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:01:43.722    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860803-104254-443_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/08/SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T22:02:50.477    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0.zip
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:02:50.478    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:02:50.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:02:50.479    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104238-508_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/08/SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0/SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T22:04:45.621    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0.zip
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:04:45.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104246-840_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/08/SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0/SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T22:06:09.988    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:06:09.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0.zip
2024-01-09T22:06:09.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:06:09.990    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104255-178_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/08/SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0/SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T22:07:22.819    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:07:22.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0.zip
2024-01-09T22:07:22.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:07:22.820    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:07:22.820    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:07:22.820    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:07:22.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:07:22.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:07:22.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:07:22.821    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860708-104303-522_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T22:08:16.235    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0.zip
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:16.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:16.237    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103759-777_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0.zip
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:08:19.653    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103824-617_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T22:10:55.911    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0.zip
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:10:55.912    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:10:55.913    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:10:55.913    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:10:55.913    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:12:22.292    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 217). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103832-913_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0/SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0.zip
run script
2024-01-09T22:12:25.539    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0.zip
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:12:25.540    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860512-103841-035_L1C_051-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0/SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T22:14:33.306    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0.zip
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:14:33.307    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:14:33.308    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:14:33.308    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:14:33.308    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103830-973_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/05/12/SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0/SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0.zip
run script
2024-01-09T22:16:23.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:16:23.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0.zip
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:16:23.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860512-103839-095_L1C_052-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T22:18:39.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0.zip
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:18:39.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102705-919_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0/SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:20:29.050    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:20:29.051    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:20:29.051    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:20:29.052    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:22:11.016    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (119 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102714-188_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:22:14.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:22:14.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:22:14.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:22:14.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:22:14.108    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102722-466_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:23:37.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:23:37.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:23:37.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:23:37.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:23:37.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861217-102730-750_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:24:11.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:24:11.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:24:11.448    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102712-711_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:26:26.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:26:26.538    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:26:26.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:26:26.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:26:26.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102720-998_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/17/SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0/SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T22:28:23.063    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0.zip
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:28:23.064    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861217-102729-294_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T22:29:18.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0.zip
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:29:18.327    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103446-497_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0/SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T22:30:56.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0.zip
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:30:56.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:30:56.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103454-799_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:32:32.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:32:32.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:32:32.910    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103503-104_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:33:45.291    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:33:45.293    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861227-103511-421_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0.zip
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:34:12.709    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103444-671_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:36:16.935    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:36:16.936    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:36:16.937    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103452-985_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/27/SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:38:31.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:38:31.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:38:31.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:38:31.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:38:31.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861227-103501-308_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/02/SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:40:25.283    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:40:25.285    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103517-858_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/02/SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0/SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0.zip
run script
2024-01-09T22:41:30.377    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:41:30.378    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0.zip
2024-01-09T22:41:30.378    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:41:30.378    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:41:30.379    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860602-103525-980_L1C_051-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/02/SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:41:54.928    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860602-103516-066_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/12/SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T22:43:51.021    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:43:51.022    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0.zip
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:43:51.023    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104301-848_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/12/SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:45:02.885    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:02.887    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860612-104310-204_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/12/SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:45:28.698    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:45:28.699    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:45:28.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104259-845_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/12/SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0/SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0.zip
run script
2024-01-09T22:47:28.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0.zip
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:47:28.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:47:28.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:47:28.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:47:28.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860612-104307-966_L1C_052-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/11/SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:48:26.177    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:26.178    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861211-104300-139_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/11/SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0/SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T22:48:50.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:48:50.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0.zip
2024-01-09T22:48:50.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:48:50.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:48:50.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:48:50.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:48:50.867    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:48:50.867    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:48:50.867    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:48:50.867    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861211-104258-157_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/22/SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T22:49:43.840    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0.zip
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:49:43.842    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861222-103121-459_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/31/SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0/SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T22:50:09.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:50:09.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0.zip
2024-01-09T22:50:09.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:50:09.454    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T22:51:19.998    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1258). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105751-501_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1986/12/31/SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0/SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0.zip
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:51:23.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:51:23.365    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:51:23.365    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:51:23.365    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105759-977_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/31/SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0/SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T22:54:17.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0.zip
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:54:17.701    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105808-460_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/12/31/SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0/SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T22:56:55.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0.zip
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:56:55.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:56:55.817    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:56:55.817    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:56:55.817    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861231-105816-946_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0/SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T22:58:02.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:58:02.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0.zip
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:58:02.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103455-625_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 1 ... 0 0 0]
 [0 0 1 ... 0 0 0]
 [0 0 1 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0/SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T22:59:53.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T22:59:53.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0.zip
2024-01-09T22:59:53.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T22:59:53.932    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T22:59:53.932    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T22:59:53.933    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T22:59:53.933    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T22:59:53.933    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T22:59:53.933    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T22:59:53.933    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103503-939_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0/SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T23:01:46.844    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:01:46.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0.zip
2024-01-09T23:01:46.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:01:46.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:01:46.846    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103512-259_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0/SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:03:57.588    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:03:57.589    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:03:57.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:03:57.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:03:57.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860724-103520-585_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:05:52.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:05:52.955    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103510-367_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/07/24/SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:07:07.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:07:07.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19860724-103518-708_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/23/SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0/SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T23:08:29.253    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0.zip
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:08:29.254    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103107-971_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/23/SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0/SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T23:10:24.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0.zip
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:10:24.914    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103116-273_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/06/23/SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0/SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:12:36.448    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:12:36.449    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:12:36.449    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:12:36.449    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:12:36.449    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:12:36.449    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:12:36.450    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:12:36.450    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:12:36.450    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:12:36.450    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19860623-103124-581_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/10/31/SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0/SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T23:14:31.233    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:14:31.234    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0.zip
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:14:31.235    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103112-767_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/10/31/SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0/SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T23:16:41.562    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0.zip
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:16:41.563    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:16:41.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:16:41.564    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:16:41.564    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV1-XS_19861031-103121-075_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/10/31/SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T23:18:36.452    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0.zip
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:18:36.453    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103110-956_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1986/10/31/SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T23:19:53.220    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:19:53.220    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0.zip
2024-01-09T23:19:53.220    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:19:53.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:19:53.221    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT1-HRV2-XS_19861031-103119-279_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/18/SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0/SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0.zip
run script
2024-01-09T23:21:17.870    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0.zip
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:17.871    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:17.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-106_L1C_046-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/18/SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0/SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:21:46.570    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:21:46.571    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102208-274_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/18/SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0/SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0.zip
run script
2024-01-09T23:22:16.150    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:22:16.150    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0.zip
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:22:16.151    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-494_L1C_052-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/18/SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T23:24:37.108    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0.zip
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:24:37.110    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100818-102144-701_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0/SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0.zip
run script
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0.zip
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:26:56.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102341-658_L1C_046-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0/SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T23:27:49.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0.zip
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:49.204    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102259-336_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0/SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0.zip
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:52.831    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:52.832    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:52.832    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:52.832    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102300-389_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0/SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T23:27:56.077    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:27:56.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0.zip
2024-01-09T23:27:56.077    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:56.077    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:56.078    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100627-102308-667_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0/SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0.zip
run script
2024-01-09T23:27:59.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0.zip
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:27:59.825    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102245-160_L1C_049-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/06/27/SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0/SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0.zip
run script
2024-01-09T23:29:25.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:29:25.491    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0.zip
2024-01-09T23:29:25.491    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:29:25.491    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:29:25.492    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100627-102248-770_L1C_049-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/11/SPOT4-HRVIR1-XS_20100711-105405-632_L1C_046-263-0_D_V1-0/SPOT4-HRVIR1-XS_20100711-105405-632_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100711-105405-632_L1C_046-263-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100711-105405-632_L1C_046-263-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2010/07/11/SPOT4-HRVIR1-XS_20100711-105409-242_L1C_046-263-4_D_V1-0/SPOT4-HRVIR1-XS_20100711-105409-242_L1C_046-263-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100711-105409-242_L1C_046-263-4_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100711-105409-242_L1C_046-263-4_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103446-911_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103446-911_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103446-911_L1C_046-263-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103446-911_L1C_046-263-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103336-266_L1C_049-254-9_D_V1-0/SPOT4-HRVIR2-XS_20100712-103336-266_L1C_049-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103336-266_L1C_049-254-9_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103336-266_L1C_049-254-9_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103344-806_L1C_049-256-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103344-806_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/get_swh.py", line 28, in <module>
    credentials = assumerole.getCredentials("arn:aws:iam::732885638740:role/public-read-only-OT", Duration=7200)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 46, in getCredentials
    credentials = kerberos_authenticate(Sts_role_arn=Arn, Sts_role_duration_session=Duration)
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/assumerole.py", line 124, in kerberos_authenticate
    oidc_token = oidc_handler.get_token(
  File "/softs/rh8/conda-envs/s3-env/lib/python3.10/site-packages/assumerole/oidc.py", line 151, in get_token
    raise OIDCException(
oidc.OIDCException: Expected HTTP 302 response, got 400
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103344-806_L1C_049-256-0_D_V1-0.zip
run script
Traceback (most recent call last):
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 179, in <module>
    args = args_parser.parse_args(sys.argv[1:])
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1768, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1800, in parse_known_args
    namespace, args = self._parse_known_args(args, namespace)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 2006, in _parse_known_args
    start_index = consume_optional(start_index)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1946, in consume_optional
    take_action(action, args, option_string)
  File "/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/argparse.py", line 1874, in take_action
    action(self, namespace, argument_values, option_string)
  File "/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh.py", line 23, in __call__
    raise argparse.ArgumentTypeError("Path '{}' does not exist".format(abs_path))
argparse.ArgumentTypeError: Path '/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103344-806_L1C_049-256-0_D_V1-0.zip' does not exist
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T23:30:51.553    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0.zip
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:30:51.555    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103353-147_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T23:32:10.804    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0.zip
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:32:10.805    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:32:10.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:32:10.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:32:10.806    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:33:04.346    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1042). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103401-494_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T23:33:07.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:33:07.647    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0.zip
2024-01-09T23:33:07.647    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:07.647    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:07.647    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:33:07.648    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:07.648    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:07.648    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:07.648    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:07.648    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103409-847_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0.zip
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:33:50.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103418-206_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0/SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T23:34:12.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0.zip
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:34:12.602    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:34:12.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:34:12.603    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:34:14.696    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1130 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100712-103426-575_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0/SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0.zip
run script
2024-01-09T23:34:18.526    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:34:18.526    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0.zip
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:34:18.527    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103437-544_L1C_051-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/12/SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0/SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T23:35:10.193    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:35:10.193    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0.zip
2024-01-09T23:35:10.193    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:35:10.194    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100712-103440-536_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/22/SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0/SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0.zip
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:35:43.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:35:43.127    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:35:43.127    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:35:43.127    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:35:43.127    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100722-104221-667_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0/SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:36:35.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:36:35.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:36:35.446    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:36:35.446    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:36:35.446    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102253-453_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0/SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:03.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102145-308_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0/SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0.zip
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:15.844    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102153-556_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0/SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T23:37:31.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:37:31.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0.zip
2024-01-09T23:37:31.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:37:31.721    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102204-344_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0/SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T23:39:34.559    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0.zip
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:39:34.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T23:40:59.680    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102207-217_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0/SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0.zip
run script
2024-01-09T23:41:03.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0.zip
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:41:03.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:41:03.038    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:41:03.038    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:41:03.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102209-022_L1C_050-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T23:42:44.743    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:42:44.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0.zip
2024-01-09T23:42:44.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:42:44.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:42:44.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:42:44.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:42:44.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:42:44.744    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:42:44.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:42:44.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102219-122_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0/SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T23:44:15.496    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:44:15.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0.zip
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:44:15.497    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100723-102220-926_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0/SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0.zip
run script
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0.zip
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:45:39.156    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:45:39.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:45:39.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:45:39.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-501_L1C_051-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0/SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T23:47:00.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0.zip
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:47:00.380    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102231-693_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/23/SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0/SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0.zip
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:48:20.636    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100723-102240-016_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/27/SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:49:20.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:49:20.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:49:20.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:49:20.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:49:20.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:49:20.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:49:20.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:49:20.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:49:20.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:49:20.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104556-518_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/27/SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0/SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T23:49:50.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0.zip
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:49:50.396    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104509-256_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/27/SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0/SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T23:52:40.040    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0.zip
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:52:40.042    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:52:40.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:52:40.051    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:52:40.051    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104520-429_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/07/27/SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0/SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0.zip
run script
2024-01-09T23:54:45.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0.zip
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:54:45.029    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100727-104524-038_L1C_050-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/12/SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0/SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0.zip
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:56:24.719    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:56:24.720    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:56:24.720    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:56:24.720    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103746-207_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/12/SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0/SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T23:56:54.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0.zip
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:56:54.855    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-833_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/12/SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0/SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0.zip
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:56:58.394    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103637-434_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/12/SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0/SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0.zip
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:57:14.060    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100812-103710-595_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/28/SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0/SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0.zip
run script
2024-01-09T23:57:17.772    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:57:17.772    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0.zip
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:57:17.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100828-102938-224_L1C_046-263-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/28/SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0/SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0.zip
run script
2024-01-09T23:57:58.466    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0.zip
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:57:58.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102843-230_L1C_048-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/28/SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0/SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T23:58:18.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:58:18.846    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0.zip
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:58:18.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100828-102847-742_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/12/SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0/SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0.zip
run script
2024-01-09T23:58:28.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:58:28.966    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0.zip
2024-01-09T23:58:28.966    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:58:28.967    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-104048-198_L1C_046-263-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/12/SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T23:59:22.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0.zip
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:59:22.797    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100912-103920-830_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/13/SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0/SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0.zip
run script
2024-01-09T23:59:25.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0.zip
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T23:59:25.945    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102126-031_L1C_046-263-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/13/SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0/SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0.zip
run script
2024-01-10T00:00:14.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:00:14.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0.zip
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:00:14.395    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102011-559_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/13/SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0/SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0.zip
run script
2024-01-10T00:00:27.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0.zip
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:00:27.117    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100913-102044-601_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/09/13/SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0/SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0.zip
run script
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0.zip
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:00:30.756    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102055-027_L1C_052-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/09/13/SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0/SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0.zip
run script
2024-01-10T00:02:53.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0.zip
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:02:53.501    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100913-102056-140_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0/SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0.zip
run script
2024-01-10T00:05:14.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0.zip
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:14.088    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:14.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-474_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0/SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0.zip
run script
2024-01-10T00:05:21.367    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0.zip
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:21.368    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102443-586_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0/SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0.zip
run script
2024-01-10T00:05:28.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:28.655    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0.zip
2024-01-10T00:05:28.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:28.665    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102449-902_L1C_047-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0/SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0.zip
run script
2024-01-10T00:05:32.046    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:32.046    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0.zip
2024-01-10T00:05:32.046    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:32.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:32.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:32.047    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:32.047    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:32.047    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:32.047    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:32.047    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102503-152_L1C_048-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0.zip
run script
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0.zip
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:35.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:35.679    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:35.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:35.679    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102507-806_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0/SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0.zip
run script
2024-01-10T00:05:39.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:39.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0.zip
2024-01-10T00:05:39.261    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:39.261    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:39.261    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:39.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:39.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:39.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:39.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:39.262    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102518-787_L1C_048-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/04/10/SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0/SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0.zip
run script
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0.zip
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:43.223    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100410-102522-397_L1C_048-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0/SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0.zip
run script
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0.zip
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:46.684    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101544-194_L1C_047-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0/SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0.zip
run script
2024-01-10T00:05:54.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0.zip
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:05:54.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101546-080_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0/SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0.zip
run script
2024-01-10T00:06:04.296    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0.zip
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:04.297    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:04.298    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101552-397_L1C_047-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0/SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0.zip
run script
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0.zip
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:14.428    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101605-227_L1C_047-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0/SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0.zip
run script
2024-01-10T00:06:18.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:18.451    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0.zip
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:18.452    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101610-753_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0/SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0.zip
run script
2024-01-10T00:06:22.472    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:22.472    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0.zip
2024-01-10T00:06:22.472    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:22.472    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:22.472    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:22.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:22.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:22.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:22.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:22.473    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100522-101613-460_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0/SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0.zip
run script
2024-01-10T00:06:26.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:26.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0.zip
2024-01-10T00:06:26.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:26.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:26.108    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101623-993_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/22/SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0/SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0.zip
run script
2024-01-10T00:06:29.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:29.954    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0.zip
2024-01-10T00:06:29.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:29.954    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:29.955    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100522-101624-895_L1C_048-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/02/22/SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0/SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0.zip
run script
2024-01-10T00:06:33.580    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0.zip
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:33.581    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102944-626_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/02/22/SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0/SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0.zip
run script
2024-01-10T00:06:44.060    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:44.060    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0.zip
2024-01-10T00:06:44.060    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:44.061    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-102952-889_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/02/22/SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0.zip
run script
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0.zip
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:52.582    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:52.583    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:52.583    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:52.583    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100222-103001-164_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/05/27/SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0/SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0.zip
run script
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0.zip
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:06:56.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-10T00:06:58.878    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (163 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101933-475_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2010/05/27/SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0/SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0.zip
run script
2024-01-10T00:07:01.954    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0.zip
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:01.955    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100527-101935-280_L1C_047-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0/SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0.zip
run script
2024-01-10T00:07:05.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:05.855    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0.zip
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:05.856    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-272_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0/SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0.zip
run script
2024-01-10T00:07:23.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0.zip
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:23.922    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-247_L1C_047-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0/SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0.zip
run script
2024-01-10T00:07:27.683    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:27.683    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0.zip
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:27.684    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101750-379_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0/SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0.zip
run script
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0.zip
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:31.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101725-380_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0/SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0.zip
run script
2024-01-10T00:07:47.850    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0.zip
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:07:47.851    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101735-953_L1C_048-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0/SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0.zip
run script
2024-01-10T00:08:05.308    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0.zip
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:08:05.309    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101739-563_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0.zip
run script
2024-01-10T00:08:16.618    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:08:16.618    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0.zip
2024-01-10T00:08:16.618    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:08:16.618    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:08:16.619    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR2-XS_20100813-101707-296_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0/SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0.zip
run script
2024-01-10T00:08:19.947    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:08:19.947    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0.zip
2024-01-10T00:08:19.947    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:08:19.947    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:08:19.948    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101800-808_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/08/13/SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0/SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0.zip
run script
2024-01-10T00:09:45.842    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:09:45.843    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0.zip
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:09:45.844    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20100813-101803-690_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/12/15/SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0/SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0.zip
run script
2024-01-10T00:11:06.678    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0.zip
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:11:06.679    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102841-580_L1C_047-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/12/15/SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0/SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0.zip
run script
2024-01-10T00:11:20.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:11:20.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0.zip
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:11:20.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102842-672_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2010/12/15/SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0/SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0.zip
run script
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0.zip
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-10T00:11:31.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-10T00:11:31.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-10T00:11:31.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-10T00:11:31.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-10T00:11:31.497    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016163/INPUT/SPOT4-HRVIR1-XS_20101215-102850-992_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016163/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
end
[2024-01-10 00:11:32.124163305+00:00] cnes_level2/barrouz/4016163:  Account (env) = cnes_level2
[2024-01-10 00:11:32.125363493+00:00] cnes_level2/barrouz/4016163:     User (env) = barrouz
[2024-01-10 00:11:32.126588321+00:00] cnes_level2/barrouz/4016163:        GroupId = cesbio(426000053)
[2024-01-10 00:11:32.127770909+00:00] cnes_level2/barrouz/4016163:         UserId = barrouz(9134)
[2024-01-10 00:11:32.128937488+00:00] cnes_level2/barrouz/4016163:        Account = cnes_level2
[2024-01-10 00:11:32.130082866+00:00] cnes_level2/barrouz/4016163:        Account = cnes_level2
[2024-01-10 00:11:32.131211745+00:00] cnes_level2/barrouz/4016163:      Partition = cpu2022
[2024-01-10 00:11:32.132325614+00:00] cnes_level2/barrouz/4016163:            QOS = cpu_2022_1280
[2024-01-10 00:11:32.133441003+00:00] cnes_level2/barrouz/4016163:        JobName = inf_ALP_56_TCD-ONLY_AVG-1200
[2024-01-10 00:11:32.134569712+00:00] cnes_level2/barrouz/4016163:     SubmitTime = 2024-01-09T10:51:21
[2024-01-10 00:11:32.135711980+00:00] cnes_level2/barrouz/4016163:        RunTime = 08:07:13
[2024-01-10 00:11:32.136818189+00:00] cnes_level2/barrouz/4016163:      TimeLimit = 1-16:00:00
[2024-01-10 00:11:32.137970478+00:00] cnes_level2/barrouz/4016163:   EligibleTime = 2024-01-09T10:51:21
[2024-01-10 00:11:32.139112337+00:00] cnes_level2/barrouz/4016163:      StartTime = 2024-01-09T16:04:19
[2024-01-10 00:11:32.140267945+00:00] cnes_level2/barrouz/4016163:        EndTime = 2024-01-10T00:11:32
[2024-01-10 00:11:32.141386314+00:00] cnes_level2/barrouz/4016163:       ExitCode = 0:0
[2024-01-10 00:11:32.142553122+00:00] cnes_level2/barrouz/4016163:       NodeList = trex039
[2024-01-10 00:11:32.143667191+00:00] cnes_level2/barrouz/4016163:      BatchHost = trex039
[2024-01-10 00:11:32.144805480+00:00] cnes_level2/barrouz/4016163:           TRES = 
[2024-01-10 00:11:32.145948219+00:00] cnes_level2/barrouz/4016163:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-10 00:11:32.147100927+00:00] cnes_level2/barrouz/4016163:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-10 00:11:32.148282795+00:00] cnes_level2/barrouz/4016163:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_56_TCD-ONLY_AVG-1200.log
[2024-01-10 00:11:32.149464253+00:00] cnes_level2/barrouz/4016163:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_56_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016163
JobID                : 4016163
JobName              : inf_ALP_56_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex039 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:21
Start time           : 2024-01-09T16:04:19
End time             : 2024-01-10T00:11:32
Elapsed time         : 08:07:13  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 16:57:44
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_56_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_56_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T16:04:19 2024-01-10T00:11:32 08:07:13  1-05:52:44 2-16:57:44      0.148125G  182880.62M    75566.55M 101140596K          0    trex039      1 20:18:31   trex039
   extern  | extern       COMPLETED   0:0    2024-01-09T16:04:19 2024-01-10T00:11:32 08:07:13  00:00.001  2-16:57:44      0.148125G       0.00M        0.00M      1708K          0    trex039      1 00:00:00   trex039

