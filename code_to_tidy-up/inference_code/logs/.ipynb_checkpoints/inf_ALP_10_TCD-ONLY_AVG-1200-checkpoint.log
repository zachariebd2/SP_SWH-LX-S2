unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/10.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/10.txt
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0/SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T10:51:37.742    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0.zip
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:51:37.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:51:37.744    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:51:37.744    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104809-267_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T10:52:38.981    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:52:38.982    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0.zip
2024-01-09T10:52:38.982    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:52:38.983    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104817-635_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0/SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T10:53:11.140    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0.zip
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:11.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104826-012_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0/SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T10:53:23.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0.zip
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:23.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:23.645    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104834-393_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0/SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0.zip
run script
2024-01-09T10:53:27.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0.zip
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:27.165    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104835-295_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0/SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0.zip
run script
2024-01-09T10:53:31.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0.zip
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:31.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:31.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:31.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:31.126    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104845-486_L1C_048-261-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0/SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T10:53:35.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:53:35.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0.zip
2024-01-09T10:53:35.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:53:35.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:53:35.294    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:53:35.294    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:53:35.295    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:53:35.295    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:53:35.295    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:53:35.295    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080907-104807-218_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0/SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0.zip
run script
2024-01-09T10:54:39.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0.zip
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:54:39.715    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104748-382_L1C_050-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T10:55:06.416    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:55:06.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0.zip
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:55:06.418    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104750-440_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T10:56:08.099    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0.zip
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:56:08.101    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104758-820_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0.zip
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:59:13.271    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104813-209_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:02:27.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:02:27.109    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104821-632_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0/SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T11:05:54.141    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0.zip
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:05:54.142    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104830-060_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0/SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T11:08:58.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0.zip
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:08:58.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104834-572_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/07/SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0/SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0.zip
run script
2024-01-09T11:11:57.254    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:11:57.255    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0.zip
2024-01-09T11:11:57.255    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:11:57.255    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:11:57.255    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:11:57.255    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:11:57.256    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:11:57.256    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:11:57.256    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:11:57.256    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:15:04.925    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1802). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080907-104812-914_L1C_052-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0/SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0.zip
run script
2024-01-09T11:15:08.479    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:08.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0.zip
2024-01-09T11:15:08.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:08.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:08.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:08.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:08.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:08.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:08.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:08.481    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-217_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0/SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T11:15:39.312    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0.zip
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:15:39.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101646-314_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0/SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:16:11.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:16:11.520    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101654-540_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T11:16:34.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0.zip
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:16:34.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:16:34.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:16:34.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101659-955_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0/SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0.zip
run script
2024-01-09T11:16:46.387    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0.zip
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:16:46.388    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:16:46.389    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:16:46.389    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:16:46.389    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101714-350_L1C_050-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0/SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T11:17:46.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0.zip
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:17:46.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:17:46.807    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101718-098_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0/SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0.zip
run script
2024-01-09T11:18:34.605    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:18:34.606    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0.zip
2024-01-09T11:18:34.606    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:18:34.606    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:18:34.606    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:18:34.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:18:34.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:18:34.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:18:34.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:18:34.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101646-256_L1C_051-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:21:14.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:21:14.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:21:14.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:21:14.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:21:14.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:21:14.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:21:14.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:21:14.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:21:14.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:21:14.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101651-791_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0/SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T11:24:16.875    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0.zip
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:24:16.877    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081015-101700-042_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0/SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0.zip
run script
2024-01-09T11:26:54.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:26:54.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0.zip
2024-01-09T11:26:54.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:26:54.992    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101715-190_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/10/15/SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0/SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0.zip
run script
2024-01-09T11:29:15.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0.zip
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:15.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:15.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:15.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081015-101717-897_L1C_053-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/14/SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0/SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0.zip
run script
2024-01-09T11:31:29.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0.zip
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:29.612    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:29.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:29.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105724-684_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/14/SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0/SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T11:31:52.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0.zip
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:52.026    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105734-920_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/14/SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T11:31:55.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0.zip
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:55.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:55.647    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:55.647    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:55.647    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080414-105755-368_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0/SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T11:31:58.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:58.885    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0.zip
2024-01-09T11:31:58.885    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:58.885    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:58.885    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:58.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:58.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:58.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:58.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:58.886    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105232-495_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T11:32:17.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0.zip
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:17.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:32:56.422    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 310). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105224-088_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0/SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0.zip
run script
2024-01-09T11:32:59.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0.zip
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:59.357    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:59.358    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:59.358    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080817-105301-278_L1C_050-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0/SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T11:33:25.711    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0.zip
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:33:25.712    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:33:25.713    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105219-559_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:36:51.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:51.311    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105228-015_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0/SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0.zip
run script
2024-01-09T11:40:29.757    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0.zip
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:40:29.758    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:40:29.759    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105248-096_L1C_052-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/17/SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0/SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0.zip
run script
2024-01-09T11:43:37.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:43:37.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0.zip
2024-01-09T11:43:37.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:43:37.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:43:37.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:46:28.643    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 748). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080817-105250-803_L1C_052-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/08/01/SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0/SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T11:46:32.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:32.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0.zip
2024-01-09T11:46:32.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:32.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:32.490    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080801-110039-829_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/03/SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0/SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0.zip
run script
2024-01-09T11:46:36.495    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0.zip
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:36.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:36.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:36.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:36.497    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102207-403_L1C_048-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/03/SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0/SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0.zip
run script
2024-01-09T11:46:40.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:40.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0.zip
2024-01-09T11:46:40.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:40.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:40.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:40.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:40.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:40.725    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:40.725    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:40.725    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080803-102210-248_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/23/SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0/SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0.zip
run script
2024-01-09T11:46:44.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0.zip
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:44.868    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:44.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:44.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:44.869    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080823-103723-870_L1C_048-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/16/SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0/SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0.zip
run script
2024-01-09T11:46:48.446    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:48.447    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0.zip
2024-01-09T11:46:48.447    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:48.447    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:48.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:48.448    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:48.448    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:48.448    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:48.448    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:48.448    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104107-028_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/16/SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0/SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0.zip
run script
2024-01-09T11:46:52.660    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:52.660    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0.zip
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:52.662    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080516-104108-833_L1C_049-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/21/SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0/SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0.zip
run script
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0.zip
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:56.356    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:56.357    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104458-276_L1C_049-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/05/21/SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0/SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0.zip
run script
2024-01-09T11:46:59.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:59.733    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0.zip
2024-01-09T11:46:59.733    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:59.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:59.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:59.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:59.734    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:59.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:59.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:59.734    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080521-104500-081_L1C_049-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0/SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0.zip
run script
2024-01-09T11:47:22.325    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0.zip
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:22.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080527-102929-539_L1C_049-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0/SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0.zip
run script
2024-01-09T11:47:42.487    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:47:42.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0.zip
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:47:42.489    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:49:43.908    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 38). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103024-243_L1C_052-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0/SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T11:49:47.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0.zip
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:47.630    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:47.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:47.631    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103027-145_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/27/SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0/SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0.zip
run script
2024-01-09T11:51:38.264    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:51:38.265    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0.zip
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:51:38.266    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:53:13.296    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (396 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080527-103029-853_L1C_052-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/06/10/SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0/SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0.zip
run script
2024-01-09T11:53:17.458    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0.zip
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:17.459    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:17.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:17.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:17.460    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110007-448_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/06/10/SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0/SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0.zip
run script
2024-01-09T11:53:21.685    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0.zip
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:21.687    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080610-110011-058_L1C_049-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/10/SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0/SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T11:53:40.479    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0.zip
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:40.480    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110050-409_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/10/SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0/SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T11:54:21.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0.zip
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:54:21.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080610-110053-116_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/21/SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0/SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0.zip
run script
2024-01-09T11:54:51.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:54:51.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0.zip
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:54:51.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104829-222_L1C_049-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/21/SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0/SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0.zip
run script
2024-01-09T11:55:03.466    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0.zip
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:55:03.468    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104830-124_L1C_049-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/21/SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0/SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T11:55:28.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0.zip
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:55:28.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104915-620_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/21/SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0/SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0.zip
run script
2024-01-09T11:58:16.865    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0.zip
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:16.866    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:16.867    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080621-104920-132_L1C_054-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/02/SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0/SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0.zip
run script
2024-01-09T12:01:26.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0.zip
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:26.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:26.894    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:26.894    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103645-244_L1C_049-254-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/02/SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0/SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0.zip
run script
2024-01-09T12:01:30.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0.zip
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:30.946    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103647-049_L1C_049-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/02/SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0/SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T12:01:35.072    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0.zip
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:35.074    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103721-979_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/02/SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0/SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T12:02:13.811    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0.zip
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:13.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080702-103722-881_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/07/SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0/SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T12:02:50.359    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0.zip
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:50.360    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:50.361    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104033-476_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/07/07/SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0/SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0.zip
run script
2024-01-09T12:02:54.148    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0.zip
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:54.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:54.150    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:54.150    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:54.150    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080707-104037-086_L1C_049-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T12:02:57.973    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0.zip
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:57.974    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:57.975    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:57.975    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103946-743_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T12:03:02.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0.zip
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:02.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:02.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:02.026    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-103955-039_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T12:03:34.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:34.456    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0.zip
2024-01-09T12:03:34.456    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:34.456    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:34.456    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:34.456    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:34.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:34.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:34.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:34.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104003-341_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T12:04:44.796    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0.zip
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:04:44.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104011-652_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T12:05:42.249    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0.zip
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:42.250    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:42.251    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104019-969_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:06:16.389    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:06:16.390    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:06:16.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:06:16.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:06:16.391    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104034-800_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T12:07:29.640    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0.zip
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:29.641    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104043-157_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0/SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T12:08:28.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0.zip
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:08:28.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080923-104051-519_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0/SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0.zip
run script
2024-01-09T12:09:06.449    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0.zip
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:09:06.450    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104022-583_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/09/23/SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0/SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0.zip
run script
2024-01-09T12:11:35.061    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0.zip
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:35.062    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080923-104024-388_L1C_053-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/15/SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0/SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T12:14:11.502    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0.zip
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:11.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103807-218_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/15/SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0/SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T12:15:02.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:02.706    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0.zip
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:02.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103811-011_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/15/SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0/SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0.zip
run script
2024-01-09T12:15:44.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:44.976    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0.zip
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:44.977    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103813-719_L1C_049-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/15/SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:16:20.789    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:20.790    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:20.791    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080415-103837-781_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/04/16/SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0/SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T12:16:24.179    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:16:24.180    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0.zip
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:16:24.181    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101846-785_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/16/SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0/SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0.zip
run script
2024-01-09T12:17:13.353    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:13.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0.zip
2024-01-09T12:17:13.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:13.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:13.355    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101848-590_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/04/16/SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0/SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0.zip
run script
2024-01-09T12:18:00.934    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:00.938    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0.zip
2024-01-09T12:18:00.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:00.944    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:00.948    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:00.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:00.961    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:00.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:00.966    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:00.969    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080416-101917-048_L1C_049-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/11/08/SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0/SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T12:18:04.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0.zip
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:04.567    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20081108-105502-057_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/08/SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0/SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0.zip
run script
2024-01-09T12:18:45.640    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0.zip
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:45.642    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105502-711_L1C_050-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/08/SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:20:44.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:44.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105503-054_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/11/08/SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0/SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0.zip
run script
2024-01-09T12:22:43.537    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:43.538    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0.zip
2024-01-09T12:22:43.538    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:43.538    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:43.539    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20081108-105505-761_L1C_050-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/26/SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0/SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T12:24:31.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0.zip
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:31.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:31.373    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104929-548_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/26/SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0/SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0.zip
run script
2024-01-09T12:24:56.226    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0.zip
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:56.227    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:56.228    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:56.228    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:56.228    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104943-975_L1C_052-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/26/SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0/SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T12:27:26.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0.zip
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:27:26.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104945-196_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/26/SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0/SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0.zip
run script
2024-01-09T12:29:53.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0.zip
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:29:53.302    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:29:53.303    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080526-104947-001_L1C_052-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/31/SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0/SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T12:32:09.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0.zip
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:32:09.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105316-126_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 1 1]
 [2 2 2 ... 2 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/31/SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0/SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0.zip
run script
2024-01-09T12:33:03.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0.zip
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:33:03.291    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105317-931_L1C_049-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/31/SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0/SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T12:33:49.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:33:49.900    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0.zip
2024-01-09T12:33:49.900    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:33:49.900    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:33:49.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:33:49.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:33:49.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:33:49.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:33:49.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:33:49.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105333-091_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/05/31/SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0/SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0.zip
run script
2024-01-09T12:36:32.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:32.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0.zip
2024-01-09T12:36:32.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:32.049    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:38:05.278    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (322 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080531-105338-505_L1C_052-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/06/11/SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T12:38:08.518    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0.zip
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:38:08.520    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104134-735_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/11/SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:38:47.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:38:47.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:38:47.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:38:47.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:38:47.438    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080611-104138-558_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/11/SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0/SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0.zip
run script
2024-01-09T12:39:14.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:39:14.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0.zip
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:39:14.644    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:41:03.326    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 442). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104134-729_L1C_051-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2008/06/11/SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0/SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:41:06.759    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:41:06.760    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:41:06.760    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:41:06.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:41:06.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:41:06.761    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:41:06.761    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:41:06.761    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:41:06.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:41:06.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104135-872_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/11/SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0/SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0.zip
run script
2024-01-09T12:43:26.802    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0.zip
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:43:26.803    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:43:26.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:43:26.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:43:26.804    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080611-104138-579_L1C_051-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/22/SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T12:45:51.583    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:45:51.584    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0.zip
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:45:51.585    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102951-155_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/22/SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0/SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T12:46:39.780    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0.zip
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:46:39.781    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102954-921_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/06/22/SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0/SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0.zip
run script
2024-01-09T12:47:15.329    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:47:15.330    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0.zip
2024-01-09T12:47:15.330    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:47:15.330    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:47:15.330    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:47:15.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:47:15.331    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:47:15.331    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:47:15.331    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:47:15.331    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080622-102958-530_L1C_049-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/06/SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0/SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0.zip
run script
2024-01-09T12:47:47.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0.zip
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:47:47.206    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110035-991_L1C_049-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/06/SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0/SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T12:48:22.229    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:22.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0.zip
2024-01-09T12:48:22.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:22.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:22.230    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:22.231    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:22.231    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:22.231    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:22.231    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:22.231    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080706-110037-796_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/08/SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0/SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0.zip
run script
2024-01-09T12:48:50.442    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0.zip
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:50.443    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:50.444    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:50.444    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:50.444    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102159-857_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/08/SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0/SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0.zip
run script
2024-01-09T12:49:36.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0.zip
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:49:36.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR1-XS_20080708-102200-760_L1C_049-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/08/SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0/SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0.zip
run script
2024-01-09T12:50:21.750    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0.zip
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:50:21.751    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:50:21.752    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:50:21.752    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:50:21.752    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102211-289_L1C_054-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/08/SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0/SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T12:52:03.043    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0.zip
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:52:03.044    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102215-076_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/07/08/SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0/SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0.zip
run script
2024-01-09T12:53:40.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:53:40.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0.zip
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:53:40.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080708-102217-783_L1C_054-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/18/SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0/SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T12:55:12.076    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:12.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0.zip
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:12.078    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103231-013_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2008/08/18/SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0/SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T12:55:16.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0.zip
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:16.203    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:16.204    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:16.204    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103239-276_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/18/SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0/SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T12:56:09.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:56:09.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0.zip
2024-01-09T12:56:09.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:56:09.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:56:09.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103247-551_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/18/SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0/SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T12:58:48.311    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0.zip
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:48.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:48.313    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103255-832_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016111/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2008/08/18/SPOT4-HRVIR2-XS_20080818-103304-122_L1C_050-258-0_D_V1-0/SPOT4-HRVIR2-XS_20080818-103304-122_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20080818-103304-122_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103304-122_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T13:01:27.339    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016111/INPUT/SPOT4-HRVIR2-XS_20080818-103304-122_L1C_050-258-0_D_V1-0.zip
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:01:27.340    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
