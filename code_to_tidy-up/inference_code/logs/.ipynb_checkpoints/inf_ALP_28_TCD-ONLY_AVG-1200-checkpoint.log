unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/28.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/28.txt
muscate/SPOTWORLDHERITAGE/2009/05/02/SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0/SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T10:56:12.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:56:12.681    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0.zip
2024-01-09T10:56:12.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:56:12.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100455-589_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/02/SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0/SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0.zip
run script
2024-01-09T10:58:58.272    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0.zip
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T10:58:58.273    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100500-206_L1C_050-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/02/SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0/SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0.zip
run script
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0.zip
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:01:03.166    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:01:03.167    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100515-658_L1C_050-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/02/SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0/SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0.zip
run script
2024-01-09T11:02:39.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:02:39.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0.zip
2024-01-09T11:02:39.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:02:39.210    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:02:39.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:02:39.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:02:39.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:02:39.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:02:39.218    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:02:39.218    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:02:41.366    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 180). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090502-100517-584_L1C_050-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2009/06/07/SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0/SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0.zip
run script
2024-01-09T11:02:44.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0.zip
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:02:44.416    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101145-360_L1C_050-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]
 [2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
  2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/07/SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T11:04:54.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0.zip
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:04:54.638    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:04:54.639    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:06:50.110    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1778). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090607-101146-388_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0/SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T11:06:54.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:06:54.017    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0.zip
2024-01-09T11:06:54.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:06:54.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:06:54.018    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104147-718_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/11/SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0/SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0.zip
run script
2024-01-09T11:08:06.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0.zip
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:08:06.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090111-104151-327_L1C_051-255-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/08/SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0/SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0.zip
run script
2024-01-09T11:10:29.765    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:10:29.766    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0.zip
2024-01-09T11:10:29.766    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:10:29.767    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090208-100310-686_L1C_051-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/02/08/SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0/SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0.zip
run script
2024-01-09T11:14:24.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0.zip
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:14:24.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:14:24.031    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090208-100310-539_L1C_051-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/12/SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0/SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0.zip
run script
2024-01-09T11:18:14.335    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0.zip
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:18:14.337    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101608-617_L1C_051-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/12/SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0/SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T11:19:05.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0.zip
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:19:05.129    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090612-101611-517_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0/SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0.zip
run script
2024-01-09T11:19:33.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:19:33.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0.zip
2024-01-09T11:19:33.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:19:33.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:19:33.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:19:33.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:19:33.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:19:33.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:19:33.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:19:33.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:22:19.278    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 458). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102251-560_L1C_052-257-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T11:22:22.877    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:22:22.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0.zip
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:22:22.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102252-652_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T11:25:07.928    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0.zip
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:25:07.930    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102300-972_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]
 [2 2 2 ... 0 0 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T11:28:22.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0.zip
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:22.125    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:22.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102309-298_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0/SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0.zip
run script
2024-01-09T11:31:15.450    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0.zip
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:31:15.452    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102312-005_L1C_052-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/12/SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0/SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0.zip
run script
2024-01-09T11:34:09.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:34:09.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0.zip
2024-01-09T11:34:09.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:34:09.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:34:09.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:34:09.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:34:09.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:34:09.185    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:34:09.185    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:34:09.185    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090112-102328-426_L1C_054-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/22/SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T11:36:12.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0.zip
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:12.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:12.474    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:12.474    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103025-270_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/22/SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0/SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0.zip
run script
2024-01-09T11:39:26.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:39:26.092    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0.zip
2024-01-09T11:39:26.092    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:39:26.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:39:26.093    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103033-638_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/22/SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0/SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0.zip
run script
2024-01-09T11:42:59.252    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:42:59.253    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0.zip
2024-01-09T11:42:59.253    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:42:59.254    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090122-103039-955_L1C_052-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0/SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0.zip
run script
2024-01-09T11:46:19.461    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0.zip
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:19.462    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:19.463    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:19.463    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103446-466_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/06/11/SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0/SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0.zip
run script
2024-01-09T11:49:28.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0.zip
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:28.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090611-103451-881_L1C_052-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/13/SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0/SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0.zip
run script
2024-01-09T11:53:12.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:53:12.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0.zip
2024-01-09T11:53:12.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:53:12.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:53:12.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100348-342_L1C_052-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/01/13/SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0/SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0.zip
run script
2024-01-09T11:56:13.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0.zip
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:56:13.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:57:41.637    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 400). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100350-146_L1C_052-260-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/01/13/SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0/SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0.zip
run script
2024-01-09T11:57:45.827    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0.zip
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:45.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:45.829    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:45.829    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090113-100407-421_L1C_053-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/04/17/SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0/SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0.zip
run script
2024-01-09T11:59:59.514    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0.zip
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:59.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:59.516    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090417-095407-256_L1C_054-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/01/SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T12:01:30.798    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:30.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0.zip
2024-01-09T12:01:30.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:30.799    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:30.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:30.799    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:30.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:30.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:30.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:30.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102440-391_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/01/SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0/SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T12:03:29.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0.zip
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:29.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:05:28.829    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 484). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090501-102445-805_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/12/SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T12:05:33.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0.zip
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:05:33.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:05:33.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:05:33.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090512-101246-469_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/22/SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0/SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T12:07:14.929    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0.zip
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:14.930    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102013-090_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/22/SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0/SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T12:09:06.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0.zip
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:09:06.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:09:06.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:09:06.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:10:59.908    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 894). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090522-102018-505_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/03/27/SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0/SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0.zip
run script
2024-01-09T12:11:03.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0.zip
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:11:03.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:11:03.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:11:03.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:11:03.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095833-813_L1C_055-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/03/27/SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0/SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0.zip
run script
2024-01-09T12:12:04.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0.zip
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:12:04.798    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090327-095842-212_L1C_055-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/07/SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0/SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0.zip
run script
2024-01-09T12:13:15.350    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:15.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0.zip
2024-01-09T12:13:15.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:15.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:15.350    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:15.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:15.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:15.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:15.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:15.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090507-100902-579_L1C_055-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/13/SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0/SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0.zip
run script
2024-01-09T12:14:28.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:28.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0.zip
2024-01-09T12:14:28.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:28.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:28.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:28.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:28.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:28.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:28.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:28.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090513-095323-720_L1C_055-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/17/SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0/SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0.zip
run script
2024-01-09T12:15:47.485    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0.zip
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:15:47.486    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:15:47.487    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:17:16.790    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 2844). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090517-101634-318_L1C_055-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2009/05/18/SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0/SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T12:17:20.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:20.375    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0.zip
2024-01-09T12:17:20.375    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:20.375    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:20.376    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20090518-095707-264_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2009/05/23/SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0/SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0.zip
run script
2024-01-09T12:18:31.412    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:31.413    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0.zip
2024-01-09T12:18:31.413    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:31.413    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:31.414    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20090523-100051-981_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0/SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0.zip
run script
2024-01-09T12:19:44.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0.zip
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:19:44.543    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105336-549_L1C_046-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T12:20:21.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:21.740    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0.zip
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:21.741    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105339-497_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0/SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0.zip
run script
2024-01-09T12:21:16.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:21:16.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0.zip
2024-01-09T12:21:16.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:21:16.927    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105257-664_L1C_050-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:24:12.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:24:12.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:24:12.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:24:12.802    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105259-749_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T12:26:54.921    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:26:54.922    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0.zip
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:26:54.923    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105308-156_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0/SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0.zip
run script
2024-01-09T12:28:44.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:44.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0.zip
2024-01-09T12:28:44.553    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:44.553    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:44.554    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000622-105315-375_L1C_050-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0/SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0.zip
run script
2024-01-09T12:30:15.901    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:30:15.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0.zip
2024-01-09T12:30:15.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:30:15.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:30:15.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:30:15.903    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:30:15.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:30:15.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:30:15.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:30:15.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105257-721_L1C_051-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:34:10.984    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:10.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:34:10.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:10.986    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105306-448_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/22/SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T12:37:32.367    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0.zip
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:37:32.368    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:37:32.369    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000622-105314-879_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/16/SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0/SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0.zip
run script
2024-01-09T12:40:37.719    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:37.720    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0.zip
2024-01-09T12:40:37.720    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:37.720    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:37.721    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000616-110908-577_L1C_046-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/16/SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0/SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0.zip
run script
2024-01-09T12:42:16.128    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0.zip
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:42:16.129    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:42:16.130    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:42:16.130    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110832-472_L1C_047-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/16/SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T12:42:20.793    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0.zip
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:42:20.795    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:42:20.796    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:42:20.796    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:42:20.796    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000616-110836-449_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0/SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0.zip
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:42:24.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103027-508_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0/SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T12:43:22.121    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0.zip
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:43:22.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102934-359_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0/SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T12:46:50.835    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0.zip
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:46:50.836    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:46:50.837    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:46:50.837    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:46:50.837    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:48:17.858    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 300). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102939-918_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0/SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:48:22.389    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:48:22.390    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:48:22.390    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:48:22.390    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:48:22.390    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:48:22.390    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:48:22.391    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:48:22.391    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:48:22.391    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:48:22.391    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102948-190_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T12:51:50.769    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0.zip
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:51:50.770    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-102956-471_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0/SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0.zip
run script
2024-01-09T12:54:48.901    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0.zip
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:54:48.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000618-103002-788_L1C_051-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0/SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T12:57:48.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:57:48.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0.zip
2024-01-09T12:57:48.170    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:57:48.170    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:57:48.170    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:57:48.171    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:57:48.171    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:57:48.171    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:57:48.171    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:57:48.171    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-102954-690_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0/SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T13:00:02.839    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:00:02.840    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0.zip
2024-01-09T13:00:02.840    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:00:02.840    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:00:02.840    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:00:02.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:00:02.841    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:00:02.841    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:00:02.841    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:00:02.841    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000618-103002-995_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/09/SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0/SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0.zip
run script
2024-01-09T13:02:47.513    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0.zip
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:02:47.514    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:02:47.515    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:02:47.515    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110248-980_L1C_046-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/09/SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0/SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0.zip
run script
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0.zip
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:03:47.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001109-110251-687_L1C_046-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/09/SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0/SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0.zip
run script
2024-01-09T13:05:08.160    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0.zip
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:05:08.161    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103003-581_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/09/SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0/SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:05:13.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:05:13.499    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103020-002_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/09/SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0/SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0.zip
run script
2024-01-09T13:05:38.701    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:05:38.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0.zip
2024-01-09T13:05:38.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:05:38.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:05:38.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:05:38.703    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:05:38.703    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:05:38.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:05:38.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:05:38.703    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000209-103022-709_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/09/SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0/SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0.zip
run script
2024-01-09T13:06:03.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:03.055    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0.zip
2024-01-09T13:06:03.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:03.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:03.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:03.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:03.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:03.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:03.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:03.056    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000209-103022-378_L1C_049-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/19/SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0/SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0.zip
run script
2024-01-09T13:07:29.480    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0.zip
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:29.481    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103747-890_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/19/SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0/SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0.zip
run script
2024-01-09T13:07:41.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0.zip
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:41.786    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000219-103749-695_L1C_047-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0/SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0.zip
run script
2024-01-09T13:07:56.276    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0.zip
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:07:56.277    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:08:00.417    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (223 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-613_L1C_047-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0/SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:08:05.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:05.007    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:05.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:05.008    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:08:09.123    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (223 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104150-760_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0/SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0.zip
run script
2024-01-09T13:08:13.721    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:13.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0.zip
2024-01-09T13:08:13.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:13.724    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104154-370_L1C_047-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0/SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T13:08:18.636    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0.zip
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:18.638    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104210-026_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/24/SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0/SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T13:08:23.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0.zip
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:23.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:23.269    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:23.269    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:23.269    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000824-104214-538_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0/SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T13:08:28.286    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:28.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0.zip
2024-01-09T13:08:28.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:28.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:28.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:28.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:28.287    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:28.287    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:28.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:28.287    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110524-206_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0/SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0.zip
run script
2024-01-09T13:08:33.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0.zip
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:33.058    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110529-621_L1C_047-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0/SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T13:08:38.010    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:38.011    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0.zip
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:38.012    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110546-342_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:08:55.803    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:55.803    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:08:55.803    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:55.804    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110554-816_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/23/SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:08:59.484    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000923-110603-292_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0/SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:09:04.114    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:04.115    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:09:06.563    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (406 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110030-450_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0/SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:09:10.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:10.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:09:10.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:10.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:10.592    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110038-867_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0/SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0.zip
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:14.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:14.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:14.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:14.783    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110040-671_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0/SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0.zip
run script
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0.zip
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:19.699    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:19.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:19.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:19.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:19.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110019-050_L1C_048-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/02/SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:09:53.858    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:53.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:53.859    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000702-110022-040_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/02/SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0/SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T13:10:26.419    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:26.420    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0.zip
2024-01-09T13:10:26.420    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:26.420    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:26.420    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:26.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:26.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:26.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:26.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:26.421    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110458-671_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/02/SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0/SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T13:10:30.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0.zip
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:30.926    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110504-416_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/02/SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0/SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T13:10:36.882    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:36.883    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0.zip
2024-01-09T13:10:36.883    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:36.884    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000802-110508-025_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0/SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T13:10:42.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0.zip
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:42.083    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110855-568_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/07/SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0/SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T13:10:47.157    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0.zip
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:47.159    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000807-110902-255_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0/SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0.zip
run script
2024-01-09T13:10:52.033    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:52.033    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0.zip
2024-01-09T13:10:52.033    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:52.033    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:52.033    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:52.034    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:52.034    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:52.034    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:52.034    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:52.034    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110519-011_L1C_047-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0/SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0.zip
run script
2024-01-09T13:10:58.112    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0.zip
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:10:58.114    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110524-426_L1C_047-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0/SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T13:11:04.189    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:04.190    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0.zip
2024-01-09T13:11:04.190    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:04.190    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:04.191    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110459-992_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0/SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T13:11:42.851    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0.zip
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:11:42.853    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110500-311_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/28/SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0/SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0.zip
run script
2024-01-09T13:12:18.023    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:18.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0.zip
2024-01-09T13:12:18.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:18.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:18.025    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:12:20.309    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 52). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000828-110503-920_L1C_048-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0/SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T13:12:24.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0.zip
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:24.446    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104603-340_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/29/SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0/SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T13:12:27.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:27.557    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0.zip
2024-01-09T13:12:27.557    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:27.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:27.558    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000829-104608-944_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0/SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T13:12:31.139    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0.zip
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:31.141    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105347-634_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0/SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T13:12:34.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:34.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0.zip
2024-01-09T13:12:34.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:34.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:34.291    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:34.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:34.292    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:34.292    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:34.292    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:34.292    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105353-286_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0/SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T13:12:37.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:37.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0.zip
2024-01-09T13:12:37.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:37.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:37.324    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105400-506_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0/SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T13:12:40.773    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:40.773    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0.zip
2024-01-09T13:12:40.773    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:40.774    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105324-993_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/08/SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0/SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0.zip
run script
2024-01-09T13:15:52.118    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0.zip
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:15:52.120    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:18:06.352    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 326). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000908-105329-505_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/09/SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0/SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T13:18:10.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0.zip
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:10.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:10.284    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:10.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:10.284    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103430-595_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/09/SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0/SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T13:18:15.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0.zip
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:15.026    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000909-103436-145_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/09/SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T13:18:18.257    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:18.257    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0.zip
2024-01-09T13:18:18.257    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:18.257    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:18.257    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:18.258    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:18.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:18.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:18.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:18.258    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000909-103350-598_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0/SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T13:18:22.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0.zip
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:22.238    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110039-585_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T13:18:25.571    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0.zip
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:25.572    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:25.573    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:25.573    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:25.573    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000415-110044-401_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0/SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0.zip
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:29.152    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110039-970_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:18:32.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:32.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:18:32.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:32.765    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110042-999_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/15/SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:18:36.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:36.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:36.569    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000415-110051-446_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/01/SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0/SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T13:18:39.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0.zip
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:39.909    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105651-652_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/01/SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T13:18:43.256    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0.zip
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:43.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:43.259    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:43.259    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000601-105652-828_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0/SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T13:18:46.723    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0.zip
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:46.724    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:46.725    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105821-498_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/09/SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0/SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T13:18:49.951    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0.zip
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:49.952    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:49.953    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001009-105822-671_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0/SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0.zip
run script
2024-01-09T13:18:53.197    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:53.198    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0.zip
2024-01-09T13:18:53.198    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:53.199    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103130-024_L1C_047-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0/SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T13:18:56.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0.zip
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:56.899    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103131-059_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0/SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0.zip
run script
2024-01-09T13:18:59.988    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:59.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0.zip
2024-01-09T13:18:59.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:59.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:59.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:59.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:59.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:59.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:59.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:59.990    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103058-308_L1C_048-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T13:19:27.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0.zip
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:27.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:27.606    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:27.606    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103105-635_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0/SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T13:19:40.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:40.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0.zip
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:40.374    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001121-103111-952_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0/SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0.zip
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:19:43.577    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103057-727_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0.zip
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:21:34.418    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:21:34.419    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:21:34.419    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:21:34.419    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103104-162_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T13:23:15.293    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0.zip
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:23:15.294    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:23:15.295    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103112-409_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T13:24:25.158    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0.zip
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:25.160    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103037-523_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/21/SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0/SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0.zip
run script
2024-01-09T13:24:28.202    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0.zip
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:28.204    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:28.205    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:28.205    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:28.205    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001121-103040-230_L1C_051-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/27/SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0/SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0.zip
run script
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0.zip
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:31.671    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000527-105255-762_L1C_047-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/06/SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0/SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T13:24:34.965    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:34.966    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0.zip
2024-01-09T13:24:34.966    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:34.966    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:34.967    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110048-192_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/06/SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0/SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0.zip
run script
2024-01-09T13:24:38.242    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:38.243    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0.zip
2024-01-09T13:24:38.243    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:38.243    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:38.244    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000606-110047-885_L1C_048-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0/SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0.zip
run script
2024-01-09T13:24:42.147    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:42.148    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0.zip
2024-01-09T13:24:42.148    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:42.148    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:42.148    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:42.148    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:42.149    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:42.149    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:42.149    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:42.149    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102047-339_L1C_048-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0/SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0.zip
run script
2024-01-09T13:24:45.758    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:45.759    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0.zip
2024-01-09T13:24:45.759    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:45.760    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:26:41.624    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 25). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102103-516_L1C_049-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0/SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0.zip
run script
2024-01-09T13:26:46.578    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:26:46.579    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0.zip
2024-01-09T13:26:46.579    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:26:46.579    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:26:46.580    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102105-321_L1C_049-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0/SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T13:29:49.424    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0.zip
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:29:49.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:29:49.426    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102119-952_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T13:31:27.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:27.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0.zip
2024-01-09T13:31:27.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:27.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102123-670_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T13:32:56.858    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:32:56.859    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0.zip
2024-01-09T13:32:56.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:32:56.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:32:56.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:32:56.860    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:32:56.860    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:32:56.860    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:32:56.860    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:32:56.860    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102131-912_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/13/SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0/SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0.zip
run script
2024-01-09T13:34:03.762    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0.zip
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:34:03.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000513-102135-522_L1C_049-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/16/SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0/SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T13:35:07.880    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0.zip
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:07.882    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102642-473_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/16/SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T13:35:11.144    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:11.145    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0.zip
2024-01-09T13:35:11.145    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:11.146    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20001116-102650-669_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0/SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0.zip
run script
2024-01-09T13:35:35.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:35.483    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0.zip
2024-01-09T13:35:35.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:35.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:35.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110051-028_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/23/SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0/SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T13:36:17.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:17.900    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0.zip
2024-01-09T13:36:17.900    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:17.900    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:17.901    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000223-110042-615_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/28/SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0/SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0.zip
run script
2024-01-09T13:36:21.042    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:21.043    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0.zip
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:21.044    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:36:22.683    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (32 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103716-770_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/28/SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0/SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T13:36:26.679    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:26.680    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0.zip
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:26.681    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103719-613_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/28/SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0/SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0.zip
run script
2024-01-09T13:36:29.862    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:29.863    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0.zip
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:29.864    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000628-103729-684_L1C_048-258-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/26/SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0/SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0.zip
run script
2024-01-09T13:36:33.096    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0.zip
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:33.097    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:33.098    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:33.098    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:36:36.618    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (286 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103505-862_L1C_048-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/11/26/SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0/SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0.zip
run script
2024-01-09T13:36:39.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0.zip
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:39.942    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001126-103509-472_L1C_048-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0/SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T13:36:43.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:43.279    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0.zip
2024-01-09T13:36:43.279    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:43.279    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:43.279    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:43.280    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:43.280    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:43.280    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:43.280    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:43.280    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-093_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T13:36:46.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:46.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0.zip
2024-01-09T13:36:46.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:46.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:46.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:46.509    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:46.509    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:46.509    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:46.509    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:46.509    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105238-343_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/01/SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0/SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0.zip
run script
2024-01-09T13:36:49.853    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0.zip
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:49.854    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:49.855    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000501-105245-562_L1C_048-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/02/SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0/SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0.zip
run script
2024-01-09T13:36:54.174    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:54.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0.zip
2024-01-09T13:36:54.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:54.178    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110911-587_L1C_048-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/02/SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0/SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0.zip
run script
2024-01-09T13:36:57.566    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0.zip
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:36:57.567    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:36:57.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:36:57.568    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000902-110916-099_L1C_048-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0/SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T13:37:00.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:00.742    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0.zip
2024-01-09T13:37:00.742    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:00.743    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102952-681_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:37:04.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:04.040    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:04.041    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-102956-426_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0/SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:37:07.261    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:07.261    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:07.262    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103004-692_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0/SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0.zip
run script
2024-01-09T13:37:11.027    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0.zip
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:11.028    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000401-103009-204_L1C_048-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0/SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0.zip
run script
2024-01-09T13:37:17.016    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0.zip
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:37:17.017    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:37:17.018    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:37:17.018    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:39:16.795    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 452). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102952-609_L1C_051-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0/SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T13:39:19.967    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0.zip
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:39:19.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:39:19.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:39:19.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:39:19.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-102953-664_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0/SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:41:43.642    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:43.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:43.644    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:43.644    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:43.644    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:43:56.453    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (121 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103001-951_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/01/SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0/SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0.zip
run script
2024-01-09T13:44:00.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0.zip
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:44:00.049    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000401-103009-171_L1C_051-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0/SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0.zip
run script
2024-01-09T13:45:51.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0.zip
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:51.283    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102928-582_L1C_048-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:45:54.546    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:54.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:54.548    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:54.548    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:54.548    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102931-425_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:45:58.134    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:45:58.134    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:45:58.134    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:45:58.134    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:45:58.135    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000523-102939-691_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/03/SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0/SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T13:46:01.638    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:01.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0.zip
2024-01-09T13:46:01.638    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:01.638    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:01.639    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000703-104134-839_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/03/SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T13:46:04.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0.zip
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:04.723    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000703-104154-557_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0/SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T13:46:08.269    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0.zip
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:08.270    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:08.271    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:08.271    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105750-888_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0/SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:46:31.720    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:31.722    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105759-299_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T13:46:35.535    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0.zip
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:35.536    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:35.537    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:35.537    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:35.537    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105734-080_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/13/SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T13:47:54.466    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0.zip
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:47:54.468    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:47:54.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:48:45.415    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 162). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000913-105742-481_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/06/SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0/SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T13:48:48.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:48:48.455    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0.zip
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:48:48.456    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103340-945_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/06/SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0/SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T13:48:51.939    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:48:51.940    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0.zip
2024-01-09T13:48:51.940    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:48:51.941    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000406-103349-223_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0/SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T13:48:55.249    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0.zip
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:48:55.251    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102130-553_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T13:50:12.342    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0.zip
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:50:12.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102136-951_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0/SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T13:52:37.039    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:52:37.040    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0.zip
2024-01-09T13:52:37.040    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:52:37.041    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102142-366_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0/SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T13:55:01.900    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:01.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0.zip
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:01.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102157-896_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T13:56:30.002    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:30.003    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0.zip
2024-01-09T13:56:30.003    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:30.004    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102201-617_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T13:58:01.494    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:58:01.495    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0.zip
2024-01-09T13:58:01.495    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:58:01.495    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:58:01.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102209-859_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/08/SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0/SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0.zip
run script
2024-01-09T13:59:01.867    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0.zip
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:59:01.869    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000608-102219-012_L1C_050-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0/SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0.zip
run script
2024-01-09T13:59:55.223    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0.zip
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:59:55.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:59:55.225    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:59:55.225    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110416-659_L1C_049-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:02:28.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:02:28.745    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:02:28.746    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:02:28.746    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:02:28.746    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110417-908_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 1 1 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:05:02.455    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:05:02.457    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110426-378_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:06:57.539    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:06:57.540    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:06:57.540    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:06:57.540    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:06:57.540    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:06:57.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:06:57.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:06:57.541    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:06:57.541    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:06:57.541    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:08:12.864    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 226). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110434-852_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:08:16.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:08:16.057    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110443-331_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:09:03.290    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:09:03.290    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:09:03.290    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:09:03.290    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:09:03.290    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:09:03.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:09:03.291    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:09:03.291    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:09:03.291    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:09:03.291    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110451-811_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/07/SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0/SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0.zip
run script
2024-01-09T14:09:15.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0.zip
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:09:15.083    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:09:15.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:09:15.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:09:15.084    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000707-110455-420_L1C_049-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/24/SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0/SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0.zip
run script
2024-01-09T14:09:18.497    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:09:18.497    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0.zip
2024-01-09T14:09:18.497    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:09:18.498    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103729-663_L1C_049-255-8_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/24/SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0/SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:11:16.549    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:16.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:16.551    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103730-710_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/24/SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0/SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0.zip
run script
2024-01-09T14:13:12.800    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0.zip
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:12.801    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:12.802    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103735-222_L1C_049-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/24/SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0/SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T14:14:53.357    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0.zip
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:53.358    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:53.359    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:53.359    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:53.359    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103752-395_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/24/SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:16:08.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:08.676    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:08.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000724-103755-270_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0/SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0.zip
run script
2024-01-09T14:17:14.900    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:14.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0.zip
2024-01-09T14:17:14.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:14.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:14.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:14.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:14.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:14.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:14.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:14.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110120-758_L1C_049-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:19:00.717    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:19:00.718    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:19:00.718    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:19:00.718    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:19:00.718    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:19:00.719    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:19:00.719    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:19:00.719    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:19:00.719    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:19:00.719    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110123-769_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0/SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0.zip
run script
2024-01-09T14:20:56.199    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0.zip
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:20:56.201    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:22:39.942    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (221 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110124-671_L1C_049-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T14:22:43.310    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:43.311    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0.zip
2024-01-09T14:22:43.311    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:43.312    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110146-353_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0/SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T14:25:48.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0.zip
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:25:48.970    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:25:48.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:25:48.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:25:48.971    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110154-829_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0/SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0.zip
run script
2024-01-09T14:27:51.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0.zip
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:27:51.196    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110201-146_L1C_050-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:29:43.690    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:43.691    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:29:43.691    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:43.691    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:43.692    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110103-519_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/18/SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0/SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0.zip
run script
2024-01-09T14:29:47.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:47.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0.zip
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:47.431    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000918-110104-421_L1C_051-254-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0/SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:29:51.206    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:29:51.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:29:51.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:29:51.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105627-327_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:32:26.314    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:32:26.316    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105635-729_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:20.547    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:20.548    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:35:31.966    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 129). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105644-139_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:35:35.602    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:35:35.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:35:35.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:35:35.603    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105652-549_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:36:29.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:36:29.703    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105700-969_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0/SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T14:36:51.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:36:51.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0.zip
2024-01-09T14:36:51.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:36:51.499    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:36:51.499    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:36:51.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:36:51.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:36:51.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:36:51.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:36:51.500    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105709-391_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/27/SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0/SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T14:36:54.575    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0.zip
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:36:54.576    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:36:54.577    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000627-105711-196_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0/SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T14:36:57.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0.zip
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:36:57.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:36:57.726    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:36:57.726    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:36:57.726    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110041-717_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0/SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0.zip
run script
2024-01-09T14:39:25.628    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0.zip
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:39:25.630    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000728-110044-424_L1C_049-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0/SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T14:41:48.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0.zip
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:41:48.561    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:41:48.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110059-684_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0/SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:43:35.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:43:35.848    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110103-627_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0/SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T14:45:41.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0.zip
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:45:41.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110112-086_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0/SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0.zip
run script
2024-01-09T14:46:40.842    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0.zip
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:40.843    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110117-500_L1C_049-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/28/SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0/SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0.zip
run script
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0.zip
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:47:21.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:47:21.025    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:47:21.025    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:47:21.025    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:47:21.025    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000728-110044-593_L1C_050-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0/SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0.zip
run script
2024-01-09T14:50:56.722    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0.zip
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:50:56.723    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:50:56.724    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104620-527_L1C_049-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:52:52.102    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:52:52.103    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:52:52.104    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104626-137_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/15/SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:54:37.870    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:54:37.871    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:54:37.872    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:54:37.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:54:37.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:55:48.122    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1066). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001115-104634-463_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0/SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:55:51.791    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:55:51.792    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105625-678_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0/SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T14:58:45.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0.zip
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:58:45.286    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:58:45.287    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:58:45.287    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:00:22.417    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 180). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105634-095_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:00:25.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:00:25.685    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:00:25.686    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105642-514_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0/SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0.zip
run script
2024-01-09T15:01:42.234    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0.zip
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:01:42.236    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105623-588_L1C_050-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/10/SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0/SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T15:04:48.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0.zip
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:48.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:48.339    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:48.339    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:48.339    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000410-105558-709_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/04/SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0/SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T15:04:51.622    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:51.623    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0.zip
2024-01-09T15:04:51.623    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:51.623    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:51.623    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:51.624    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:51.624    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:51.624    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:51.624    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:51.624    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102153-581_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/04/SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T15:07:34.246    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0.zip
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:07:34.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:07:34.249    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:07:34.249    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:09:21.090    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1642). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102201-805_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/04/SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:09:24.137    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:09:24.138    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:09:24.139    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:09:24.139    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:09:24.139    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102210-041_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/04/SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0/SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T15:11:07.287    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0.zip
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:11:07.288    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000704-102214-553_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0/SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T15:12:43.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0.zip
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:12:43.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:12:43.279    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:12:43.279    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:12:43.279    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:14:08.461    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1330). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000517-104432-480_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0/SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0.zip
run script
2024-01-09T15:14:11.768    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:14:11.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0.zip
2024-01-09T15:14:11.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:14:11.770    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104500-605_L1C_051-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0/SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:16:26.881    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:16:26.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104503-564_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/17/SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0/SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0.zip
run script
2024-01-09T15:18:23.219    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:18:23.222    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0.zip
2024-01-09T15:18:23.226    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:18:23.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000517-104505-369_L1C_051-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0/SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T15:20:10.175    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0.zip
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:20:10.176    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:20:10.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:20:10.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:20:10.177    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102606-245_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0/SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:21:32.838    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:21:32.839    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:21:32.839    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:21:32.839    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:21:32.839    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:21:32.840    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:21:32.840    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:21:32.840    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:21:32.840    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:21:32.840    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102609-072_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0/SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:22:48.915    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:22:48.916    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:22:48.917    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102617-326_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0/SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T15:23:42.146    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:42.147    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0.zip
2024-01-09T15:23:42.147    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:42.147    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:42.148    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000709-102620-034_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/27/SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0/SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0.zip
run script
2024-01-09T15:24:36.415    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0.zip
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:36.417    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-568_L1C_049-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/27/SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T15:25:28.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0.zip
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:25:28.209    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000427-102939-709_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T15:26:18.000    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:18.001    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0.zip
2024-01-09T15:26:18.001    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:18.001    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:18.001    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:18.001    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:18.002    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:18.002    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:18.002    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:18.002    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104635-321_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/03/SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:26:20.874    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:20.875    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:20.876    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:20.876    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:20.876    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000203-104638-254_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0/SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T15:26:23.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0.zip
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:23.907    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105025-170_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/08/SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:26:26.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:26.995    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000208-105028-124_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/11/SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0/SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0.zip
run script
2024-01-09T15:26:29.918    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0.zip
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:29.919    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:29.920    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:29.920    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:29.920    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102354-037_L1C_049-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/11/11/SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:26:47.485    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:47.486    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:26:47.486    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:47.486    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:47.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:47.487    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:47.487    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:47.487    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:47.487    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:47.487    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20001111-102357-782_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/17/SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0/SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:26:56.296    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:56.297    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:26:56.297    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:56.297    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:56.298    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:56.298    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:56.298    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:56.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:56.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:56.299    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000417-102221-183_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0/SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T15:26:59.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:59.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0.zip
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:59.338    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102146-978_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T15:27:02.307    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:02.308    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0.zip
2024-01-09T15:27:02.308    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:02.308    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:02.308    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:02.309    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:02.309    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:02.309    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:02.309    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:02.309    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102155-175_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0/SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T15:27:57.083    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:57.084    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0.zip
2024-01-09T15:27:57.084    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:57.084    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:57.085    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102203-384_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0/SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:30:47.262    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:47.263    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:30:47.263    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:47.263    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:47.263    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:47.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:47.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:47.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:47.264    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:47.264    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102211-602_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T15:33:48.821    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0.zip
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:33:48.822    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:33:48.823    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:35:50.687    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 506). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102219-828_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:35:53.971    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:53.972    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:35:53.972    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:53.972    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:53.972    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:53.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:53.973    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:53.973    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:53.973    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:53.973    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102228-067_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0/SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0.zip
run script
2024-01-09T15:38:17.396    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:17.397    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0.zip
2024-01-09T15:38:17.397    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:17.398    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000730-102237-218_L1C_050-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/14/SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0/SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T15:39:54.619    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0.zip
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:39:54.621    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103357-751_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/14/SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0/SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0.zip
run script
2024-01-09T15:40:45.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0.zip
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:40:45.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000214-103403-166_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0/SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T15:43:01.363    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0.zip
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:43:01.364    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101801-679_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T15:46:00.208    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:46:00.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0.zip
2024-01-09T15:46:00.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:46:00.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:46:00.210    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:48:10.055    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 538). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101804-482_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:48:13.181    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:48:13.182    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:48:13.182    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:48:13.182    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101812-709_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T15:50:33.205    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:50:33.206    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0.zip
2024-01-09T15:50:33.206    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:50:33.206    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:50:33.207    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101820-945_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T15:52:15.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:52:15.108    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0.zip
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:52:15.109    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101829-190_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/29/SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0/SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T15:53:51.054    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0.zip
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:53:51.056    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000629-101837-444_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0/SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T15:55:06.560    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0.zip
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:55:06.561    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:55:06.562    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:55:06.562    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:55:06.562    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101821-928_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T15:58:16.341    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:58:16.342    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0.zip
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:58:16.343    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:00:28.283    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 270). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101825-633_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:00:31.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:00:31.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101833-860_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0/SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T16:03:03.738    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0.zip
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:03:03.739    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:03:03.740    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:03:03.740    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000725-101835-665_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0/SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0.zip
run script
2024-01-09T16:05:25.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0.zip
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:25.941    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101850-868_L1C_054-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T16:07:41.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0.zip
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:41.240    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101855-530_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0/SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0.zip
run script
2024-01-09T16:09:42.662    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:09:42.663    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0.zip
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:09:42.664    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000725-101901-847_L1C_054-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [1 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T16:11:02.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:02.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0.zip
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:02.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102616-512_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:13:34.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:13:34.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:13:34.430    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:13:34.430    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:13:34.430    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:15:20.472    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 480). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102619-340_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:15:23.684    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:15:23.686    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102627-588_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0/SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T16:17:32.211    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0.zip
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:17:32.212    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:17:32.213    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:17:32.213    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:17:32.213    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:19:26.256    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (133 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000804-102629-392_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0/SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T16:19:29.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0.zip
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:29.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102645-930_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T16:21:18.649    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0.zip
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:21:18.651    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000804-102648-818_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T16:23:09.492    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:23:09.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0.zip
2024-01-09T16:23:09.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:23:09.493    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104932-120_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:25:49.135    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:49.136    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:27:40.311    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 228). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104935-074_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:27:43.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:43.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:43.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:43.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:43.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104943-446_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/08/SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0/SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0.zip
run script
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0.zip
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:29:32.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:29:32.827    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:29:32.827    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:29:32.827    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:29:32.827    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000808-104948-860_L1C_050-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0/SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:31:12.505    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:12.507    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103013-957_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:33:47.087    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:47.088    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:47.089    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:47.089    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:35:29.775    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 460). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103017-702_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:35:32.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:32.905    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103025-965_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0/SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0.zip
run script
2024-01-09T16:37:40.880    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0.zip
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:37:40.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:39:32.963    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (622 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000809-103028-672_L1C_050-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0/SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0.zip
run script
2024-01-09T16:39:36.167    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0.zip
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:39:36.168    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:39:38.170    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (454 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103044-010_L1C_054-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T16:39:41.056    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:39:41.057    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0.zip
2024-01-09T16:39:41.057    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:39:41.057    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:39:41.058    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103046-913_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0/SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0.zip
run script
2024-01-09T16:41:23.648    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:41:23.649    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0.zip
2024-01-09T16:41:23.649    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:41:23.649    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:41:23.649    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:41:23.649    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:41:23.650    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:41:23.650    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:41:23.650    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:41:23.650    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000809-103048-718_L1C_054-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T16:43:13.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0.zip
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:43:13.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105328-717_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:46:09.005    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:46:09.006    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:48:06.314    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 472). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105331-701_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:48:09.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:48:09.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:50:09.226    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (206 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105340-102_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/13/SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0/SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T16:50:12.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:50:12.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0.zip
2024-01-09T16:50:12.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:50:12.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:50:12.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000813-105343-712_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T16:52:16.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:52:16.877    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0.zip
2024-01-09T16:52:16.877    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:52:16.878    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103411-792_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:55:01.405    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:55:01.406    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:55:01.406    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:55:01.406    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:55:01.406    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:55:01.407    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:55:01.407    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:55:01.407    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:55:01.407    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:55:01.407    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:56:54.756    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 444). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103414-650_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0/SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T16:56:57.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:56:57.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0.zip
2024-01-09T16:56:57.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:56:57.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:56:57.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:56:57.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:56:57.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:56:57.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:56:57.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:56:57.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:59:03.509    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (474 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000814-103423-833_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0/SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0.zip
run script
2024-01-09T16:59:06.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:59:06.745    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0.zip
2024-01-09T16:59:06.745    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:06.745    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:06.745    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:59:06.745    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:06.746    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:06.746    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:06.746    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:06.746    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103439-992_L1C_054-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0/SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T17:01:21.563    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0.zip
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:01:21.564    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:01:21.565    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:01:21.565    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000814-103443-816_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/18/SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T17:03:31.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:31.482    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0.zip
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:31.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105723-720_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/18/SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:07:03.285    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:07:03.287    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:07:03.287    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:07:03.287    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:07:03.287    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:07:03.287    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:07:03.288    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:07:03.288    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:07:03.288    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:07:03.288    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105735-165_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/18/SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0/SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T17:09:19.186    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:09:19.187    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0.zip
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:09:19.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000818-105736-970_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0/SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T17:11:28.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:11:28.834    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0.zip
2024-01-09T17:11:28.834    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:28.834    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:28.835    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103806-237_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:14:03.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:03.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:14:03.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:03.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:03.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:03.885    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:03.885    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:03.885    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:03.885    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:03.885    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:15:48.966    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 438). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103810-018_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:15:51.943    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:15:51.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:15:51.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:51.952    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:51.955    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:15:51.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:51.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:51.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:51.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:51.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000819-103818-317_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/20/SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0/SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T17:17:43.741    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0.zip
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:17:43.743    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101847-203_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/20/SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0/SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:21:01.725    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:21:01.727    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:23:20.615    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 270). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101850-009_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/20/SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:23:23.754    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:23:23.756    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101858-236_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/20/SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0/SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0.zip
run script
2024-01-09T17:26:33.752    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0.zip
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:26:33.754    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000820-101900-943_L1C_050-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0/SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T17:29:28.400    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0.zip
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:29:28.401    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110117-187_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0/SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T17:33:33.438    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:33:33.439    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0.zip
2024-01-09T17:33:33.439    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:33:33.440    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:37:12.523    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 286). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110120-238_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0/SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:37:16.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:37:16.807    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:37:16.807    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:37:16.807    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:37:16.807    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:37:16.807    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:37:16.808    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:37:16.808    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:37:16.808    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:37:16.808    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:39:44.417    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (204 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110128-705_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/23/SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0/SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0.zip
run script
2024-01-09T17:39:47.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0.zip
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:39:47.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV1-XS_20000823-110131-412_L1C_050-259-3_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0/SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0.zip
run script
2024-01-09T17:42:00.738    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0.zip
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:42:00.739    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105709-273_L1C_050-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0/SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T17:44:59.251    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0.zip
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:44:59.253    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105711-391_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0/SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0.zip
run script
2024-01-09T17:47:38.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0.zip
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:47:38.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105719-831_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/23/SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0/SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T17:49:25.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:49:25.282    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0.zip
2024-01-09T17:49:25.282    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:49:25.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016134/INPUT/SPOT2-HRV2-XS_20000723-105728-274_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016134/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 17:50:49.521252061+00:00] cnes_level2/barrouz/4016134:  Account (env) = cnes_level2
[2024-01-09 17:50:49.522618696+00:00] cnes_level2/barrouz/4016134:     User (env) = barrouz
[2024-01-09 17:50:49.524028311+00:00] cnes_level2/barrouz/4016134:        GroupId = cesbio(426000053)
[2024-01-09 17:50:49.525408035+00:00] cnes_level2/barrouz/4016134:         UserId = barrouz(9134)
[2024-01-09 17:50:49.526734210+00:00] cnes_level2/barrouz/4016134:        Account = cnes_level2
[2024-01-09 17:50:49.528149784+00:00] cnes_level2/barrouz/4016134:        Account = cnes_level2
[2024-01-09 17:50:49.529616958+00:00] cnes_level2/barrouz/4016134:      Partition = cpu2022
[2024-01-09 17:50:49.531186822+00:00] cnes_level2/barrouz/4016134:            QOS = cpu_2022_1280
[2024-01-09 17:50:49.532639297+00:00] cnes_level2/barrouz/4016134:        JobName = inf_ALP_28_TCD-ONLY_AVG-1200
[2024-01-09 17:50:49.534080581+00:00] cnes_level2/barrouz/4016134:     SubmitTime = 2024-01-09T10:51:17
[2024-01-09 17:50:49.535487955+00:00] cnes_level2/barrouz/4016134:        RunTime = 06:54:43
[2024-01-09 17:50:49.536874850+00:00] cnes_level2/barrouz/4016134:      TimeLimit = 1-16:00:00
[2024-01-09 17:50:49.538443914+00:00] cnes_level2/barrouz/4016134:   EligibleTime = 2024-01-09T10:51:17
[2024-01-09 17:50:49.539857238+00:00] cnes_level2/barrouz/4016134:      StartTime = 2024-01-09T10:56:06
[2024-01-09 17:50:49.541282362+00:00] cnes_level2/barrouz/4016134:        EndTime = 2024-01-09T17:50:49
[2024-01-09 17:50:49.542727027+00:00] cnes_level2/barrouz/4016134:       ExitCode = 0:0
[2024-01-09 17:50:49.544168471+00:00] cnes_level2/barrouz/4016134:       NodeList = trex008
[2024-01-09 17:50:49.545574625+00:00] cnes_level2/barrouz/4016134:      BatchHost = trex008
[2024-01-09 17:50:49.546928780+00:00] cnes_level2/barrouz/4016134:           TRES = 
[2024-01-09 17:50:49.548288365+00:00] cnes_level2/barrouz/4016134:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 17:50:49.549659929+00:00] cnes_level2/barrouz/4016134:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 17:50:49.551129383+00:00] cnes_level2/barrouz/4016134:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_28_TCD-ONLY_AVG-1200.log
[2024-01-09 17:50:49.552537728+00:00] cnes_level2/barrouz/4016134:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_28_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016134
JobID                : 4016134
JobName              : inf_ALP_28_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex008 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:17
Start time           : 2024-01-09T10:56:06
End time             : 2024-01-09T17:50:49
Elapsed time         : 06:54:43  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 7:17:44
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_28_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_28_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T10:56:06 2024-01-09T17:50:49 06:54:43  1-06:51:48 2-07:17:44       0.20125M  177285.93M    71719.89M  99835776K          0    trex008      1 19:29:09   trex008
   extern  | extern       COMPLETED   0:0    2024-01-09T10:56:06 2024-01-09T17:50:49 06:54:43  00:00.002  2-07:17:44       0.20125M       0.00M        0.00M      1676K          0    trex008      1 00:00.001  trex008

