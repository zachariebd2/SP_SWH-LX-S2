unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/46.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/46.txt
muscate/SPOTWORLDHERITAGE/2002/11/25/SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0.zip
run script
2024-01-16T11:43:57.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0.zip
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:43:57.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T11:44:04.230    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (212 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021125-110309-058_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2002/12/01/SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0/SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0.zip
run script
2024-01-16T11:44:09.034    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0.zip
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:44:09.035    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104733-755_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/12/01/SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T11:44:27.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:44:27.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0.zip
2024-01-16T11:44:27.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:44:27.732    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:44:27.732    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:44:27.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:44:27.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:44:27.733    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:44:27.733    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:44:27.733    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104742-202_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/12/01/SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0.zip
run script
2024-01-16T11:44:51.743    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0.zip
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:44:51.744    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:44:51.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:44:51.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:44:51.745    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021201-104750-504_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/11/27/SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0/SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T11:44:56.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0.zip
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:44:56.700    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102421-170_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/27/SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0/SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T11:45:19.169    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:45:19.170    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0.zip
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:45:19.171    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102429-376_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/27/SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0/SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0.zip
run script
2024-01-16T11:46:05.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0.zip
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:46:05.523    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:46:05.524    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021127-102437-630_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/12/11/SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0/SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T11:46:44.889    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0.zip
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:46:44.891    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105530-266_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/12/11/SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0/SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0.zip
run script
2024-01-16T11:47:10.624    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0.zip
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:47:10.626    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021211-105538-592_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/08/15/SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0/SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0.zip
run script
2024-01-16T11:47:16.428    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0.zip
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:47:16.429    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020815-102418-229_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/08/13/SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0/SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0.zip
run script
2024-01-16T11:47:21.944    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0.zip
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:47:21.946    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110203-295_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/13/SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0/SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0.zip
run script
2024-01-16T11:50:13.615    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:50:13.616    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0.zip
2024-01-16T11:50:13.616    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:50:13.616    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:50:13.616    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:50:13.616    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:50:13.617    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:50:13.617    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:50:13.617    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:50:13.617    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110206-279_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/13/SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0/SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0.zip
run script
2024-01-16T11:53:45.631    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0.zip
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:53:45.633    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020813-110213-498_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0/SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0.zip
run script
2024-01-16T11:57:17.996    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:57:17.997    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0.zip
2024-01-16T11:57:17.997    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:57:17.997    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:57:17.997    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:57:17.998    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:57:17.998    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:57:17.998    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:57:17.998    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:57:17.998    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104258-561_L1C_050-256-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 2 ... 2 2 2]
 [2 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0/SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0.zip
run script
2024-01-16T11:59:52.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0.zip
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T11:59:52.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104300-535_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0/SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0.zip
run script
2024-01-16T12:02:20.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0.zip
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:02:20.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T12:03:59.490    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 189). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104308-837_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0/SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0.zip
run script
2024-01-16T12:04:04.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0.zip
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:04:04.953    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104317-139_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0/SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0.zip
run script
2024-01-16T12:05:38.623    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0.zip
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:05:38.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104344-707_L1C_050-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/14/SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0.zip
run script
2024-01-16T12:06:27.104    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:06:27.105    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0.zip
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:06:27.106    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020814-104233-857_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/07/29/SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0/SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0.zip
run script
2024-01-16T12:06:34.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0.zip
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:06:34.457    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:06:34.458    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:06:34.458    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020729-105051-320_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/04/SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0/SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0.zip
run script
2024-01-16T12:08:15.804    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:08:15.805    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0.zip
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:08:15.806    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103601-295_L1C_050-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/04/SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0/SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0.zip
run script
2024-01-16T12:08:57.044    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:08:57.045    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0.zip
2024-01-16T12:08:57.045    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:08:57.046    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020804-103603-100_L1C_050-262-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/19/SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0/SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0.zip
run script
2024-01-16T12:09:29.451    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0.zip
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:09:29.453    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:09:29.454    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104735-662_L1C_050-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/19/SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0/SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0.zip
run script
2024-01-16T12:10:18.917    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0.zip
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:10:18.919    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020819-104739-271_L1C_050-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/09/14/SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0/SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0.zip
run script
2024-01-16T12:10:48.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:10:48.392    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0.zip
2024-01-16T12:10:48.392    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:10:48.392    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:10:48.392    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:10:48.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:10:48.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:10:48.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:10:48.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:10:48.393    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104643-026_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2002/09/14/SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0/SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0.zip
run script
2024-01-16T12:10:53.331    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:10:53.332    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0.zip
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:10:53.333    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104659-676_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/09/14/SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0/SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0.zip
run script
2024-01-16T12:14:09.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0.zip
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:14:09.827    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:14:09.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:14:09.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:14:09.828    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020914-104700-590_L1C_051-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/04/SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0/SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0.zip
run script
2024-01-16T12:17:33.097    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0.zip
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:17:33.099    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110255-687_L1C_051-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/04/SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0/SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0.zip
run script
2024-01-16T12:21:58.499    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0.zip
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:21:58.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T12:26:18.834    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 213). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110258-719_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/10/04/SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0/SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0.zip
run script
2024-01-16T12:26:22.941    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0.zip
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:26:22.943    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110307-189_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/04/SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0/SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0.zip
run script
2024-01-16T12:30:50.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0.zip
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:30:50.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T12:33:32.823    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1130). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021004-110315-660_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/10/26/SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0/SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0.zip
run script
2024-01-16T12:33:37.980    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:33:37.981    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0.zip
2024-01-16T12:33:37.981    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:33:37.981    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:33:37.982    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103946-623_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 0 0 ... 1 1 1]
 [2 0 0 ... 1 1 1]
 [2 0 0 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/26/SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0/SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0.zip
run script
2024-01-16T12:37:03.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0.zip
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:37:03.095    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-103954-925_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/26/SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0.zip
run script
2024-01-16T12:40:05.872    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:40:05.873    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0.zip
2024-01-16T12:40:05.873    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:40:05.873    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:40:05.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104003-227_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 1 1 ... 2 2 2]
 [0 2 1 ... 2 2 2]
 [0 0 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/26/SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0/SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0.zip
run script
2024-01-16T12:43:09.365    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0.zip
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:43:09.367    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104011-554_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/26/SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0/SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0.zip
run script
2024-01-16T12:45:30.135    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0.zip
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:45:30.137    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021026-104017-858_L1C_051-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/22/SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0/SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0.zip
run script
2024-01-16T12:47:46.745    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:47:46.746    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0.zip
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:47:46.747    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102051-440_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/22/SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0/SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0.zip
run script
2024-01-16T12:51:17.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0.zip
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:51:17.356    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:51:17.357    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102054-255_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/22/SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0/SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0.zip
run script
2024-01-16T12:54:43.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:54:43.825    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0.zip
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:54:43.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021122-102103-424_L1C_051-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/01/SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0/SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0.zip
run script
2024-01-16T12:57:27.058    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0.zip
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T12:57:27.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102057-936_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/01/SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0/SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0.zip
run script
2024-01-16T13:00:07.383    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:00:07.384    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0.zip
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:00:07.385    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T13:02:30.097    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (126 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021001-102100-776_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/10/01/SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0/SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0.zip
run script
2024-01-16T13:02:35.871    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0.zip
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:02:35.872    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102055-254_L1C_054-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/10/01/SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0/SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0.zip
run script
2024-01-16T13:04:46.081    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0.zip
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:04:46.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:04:46.083    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:04:46.083    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:04:46.083    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021001-102057-203_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/01/SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0/SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0.zip
run script
2024-01-16T13:06:59.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0.zip
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:06:59.949    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102429-562_L1C_052-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/01/SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0/SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0.zip
run script
2024-01-16T13:09:48.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0.zip
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:09:48.861    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:09:48.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:09:48.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:09:48.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102432-402_L1C_052-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/01/SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0/SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0.zip
run script
2024-01-16T13:12:25.481    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:12:25.482    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0.zip
2024-01-16T13:12:25.482    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:12:25.483    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20021101-102440-655_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [0 2 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/01/SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0/SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0.zip
run script
2024-01-16T13:15:32.423    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0.zip
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:15:32.425    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102454-633_L1C_052-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/11/01/SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0/SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0.zip
run script
2024-01-16T13:18:45.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:18:45.487    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0.zip
2024-01-16T13:18:45.487    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:18:45.487    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:18:45.487    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:18:45.487    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:18:45.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:18:45.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:18:45.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:18:45.488    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20021101-102458-411_L1C_052-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/20/SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0/SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0.zip
run script
2024-01-16T13:21:53.227    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:21:53.228    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0.zip
2024-01-16T13:21:53.228    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:21:53.229    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102755-404_L1C_052-259-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/20/SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0/SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0.zip
run script
2024-01-16T13:24:43.136    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0.zip
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:24:43.138    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102804-765_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/20/SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0/SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0.zip
run script
2024-01-16T13:27:43.353    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0.zip
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:27:43.354    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102813-067_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/20/SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0/SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0.zip
run script
2024-01-16T13:30:18.969    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0.zip
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:30:18.971    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020820-102820-286_L1C_052-262-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/31/SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0/SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0.zip
run script
2024-01-16T13:31:46.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:31:46.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0.zip
2024-01-16T13:31:46.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:31:46.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:31:46.350    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:31:46.350    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:31:46.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:31:46.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:31:46.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:31:46.351    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T13:33:37.004    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 416). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101653-082_L1C_052-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/08/31/SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0/SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0.zip
run script
2024-01-16T13:33:42.759    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0.zip
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:33:42.760    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:33:42.761    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:33:42.761    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020831-101655-946_L1C_052-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/09/26/SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0/SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0.zip
run script
2024-01-16T13:36:41.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0.zip
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:36:41.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:36:41.812    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:36:41.812    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T13:39:51.515    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 284). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101709-734_L1C_052-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2002/09/26/SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0/SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0.zip
run script
2024-01-16T13:39:57.155    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:39:57.156    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0.zip
2024-01-16T13:39:57.156    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:39:57.156    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:39:57.156    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:39:57.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:39:57.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:39:57.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:39:57.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:39:57.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG2-XS_20020926-101713-488_L1C_052-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/05/SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0/SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0.zip
run script
2024-01-16T13:42:56.677    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0.zip
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:42:56.678    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101633-237_L1C_053-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/08/05/SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0/SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0.zip
run script
2024-01-16T13:45:38.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0.zip
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:45:38.695    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020805-101635-186_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/09/20/SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0/SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0.zip
run script
2024-01-16T13:48:18.826    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0.zip
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:48:18.827    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:48:18.828    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:48:18.828    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:48:18.828    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103220-051_L1C_055-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2002/09/20/SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0/SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0.zip
run script
2024-01-16T13:49:11.755    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0.zip
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:49:11.757    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT5-HRG1-XS_20020920-103226-380_L1C_055-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/02/27/SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0/SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0.zip
run script
2024-01-16T13:50:11.109    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0.zip
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:50:11.111    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950227-105701-127_L1C_046-263-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/04/SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0/SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0.zip
run script
2024-01-16T13:51:05.457    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0.zip
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:51:05.459    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110347-301_L1C_047-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/04/04/SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0/SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0.zip
run script
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0.zip
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:51:08.247    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:51:08.248    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110355-733_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/04/SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0/SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0.zip
run script
2024-01-16T13:51:22.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:51:22.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0.zip
2024-01-16T13:51:22.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:51:22.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:51:22.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:51:22.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:51:22.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:51:22.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:51:22.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:51:22.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950404-110357-538_L1C_047-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/23/SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0/SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0.zip
run script
2024-01-16T13:51:41.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0.zip
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:51:41.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:51:41.038    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-256_L1C_047-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/23/SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0/SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0.zip
run script
2024-01-16T13:51:51.952    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:51:51.953    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0.zip
2024-01-16T13:51:51.953    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:51:51.953    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:51:51.954    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105325-466_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/23/SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0/SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0.zip
run script
2024-01-16T13:52:03.328    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:52:03.329    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0.zip
2024-01-16T13:52:03.329    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:52:03.329    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:52:03.329    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:52:03.330    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:52:03.330    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:52:03.330    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:52:03.330    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:52:03.330    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950823-105328-174_L1C_047-255-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/05/SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0/SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0.zip
run script
2024-01-16T13:52:17.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:52:17.325    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0.zip
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:52:17.326    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950405-104439-540_L1C_047-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0/SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0.zip
run script
2024-01-16T13:52:27.996    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0.zip
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:52:27.998    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104958-969_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0/SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0.zip
run script
2024-01-16T13:52:42.091    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0.zip
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:52:42.092    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:52:42.093    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:52:42.093    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:52:42.093    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105000-773_L1C_047-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T13:52:52.238    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0.zip
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:52:52.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-104950-654_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0/SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0.zip
run script
2024-01-16T13:53:04.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:04.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0.zip
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:04.622    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105018-602_L1C_048-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0/SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0.zip
run script
2024-01-16T13:53:07.829    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0.zip
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:07.830    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105023-333_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0/SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0.zip
run script
2024-01-16T13:53:10.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0.zip
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:10.782    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105031-684_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/04/SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0/SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0.zip
run script
2024-01-16T13:53:13.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0.zip
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:13.671    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951104-105040-040_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/09/SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0/SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0.zip
run script
2024-01-16T13:53:16.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0.zip
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:16.557    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105404-811_L1C_047-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/09/SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0/SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0.zip
run script
2024-01-16T13:53:19.470    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0.zip
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:19.471    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:19.472    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:19.472    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105337-077_L1C_048-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/09/SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T13:53:22.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:22.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0.zip
2024-01-16T13:53:22.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:22.627    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105341-803_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/09/SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0/SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0.zip
run script
2024-01-16T13:53:35.424    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0.zip
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:35.425    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105423-815_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/09/SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0/SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0.zip
run script
2024-01-16T13:53:38.349    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0.zip
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:38.351    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951109-105431-293_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0/SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0.zip
run script
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0.zip
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:41.482    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:41.483    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:41.483    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:41.483    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104212-902_L1C_047-259-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0/SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0.zip
run script
2024-01-16T13:53:44.407    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0.zip
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:44.408    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104213-077_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0/SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0.zip
run script
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0.zip
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:53:47.744    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:53:47.745    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:53:47.745    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:53:47.745    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:53:47.745    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950713-104133-521_L1C_050-255-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0/SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0.zip
run script
2024-01-16T13:55:44.292    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0.zip
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:55:44.293    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104133-028_L1C_050-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0/SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0.zip
run script
2024-01-16T13:57:23.006    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:57:23.007    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0.zip
2024-01-16T13:57:23.007    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:57:23.007    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:57:23.008    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104213-675_L1C_050-260-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0/SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0.zip
run script
2024-01-16T13:58:19.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0.zip
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:58:19.764    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104218-398_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/13/SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0/SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0.zip
run script
2024-01-16T13:59:07.749    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0.zip
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:59:07.750    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:59:07.751    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:59:07.751    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:59:07.751    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950713-104222-007_L1C_050-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0/SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0.zip
run script
2024-01-16T13:59:49.888    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0.zip
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T13:59:49.890    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103703-232_L1C_048-254-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:00:00.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:00:00.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:00:00.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:00:00.811    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103705-158_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0/SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T14:00:20.575    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0.zip
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:00:20.576    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:00:20.577    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:00:20.577    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:00:20.577    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103713-414_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0/SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0.zip
run script
2024-01-16T14:01:05.175    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:01:05.176    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0.zip
2024-01-16T14:01:05.176    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:01:05.176    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:01:05.176    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:01:05.176    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:01:05.177    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:01:05.177    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:01:05.177    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:01:05.177    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T14:01:06.338    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (0 x 1548). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950421-103717-024_L1C_048-256-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0/SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0.zip
run script
2024-01-16T14:01:09.500    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0.zip
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:01:09.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-497_L1C_050-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0/SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0.zip
run script
2024-01-16T14:01:48.594    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0.zip
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:01:48.595    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:01:48.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:01:48.596    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:01:48.596    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103703-632_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0/SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0.zip
run script
2024-01-16T14:02:29.332    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0.zip
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:02:29.333    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:02:29.334    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:02:29.334    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:02:29.334    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103711-901_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/21/SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0/SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0.zip
run script
2024-01-16T14:04:23.899    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:04:23.900    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0.zip
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:04:23.901    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T14:05:53.097    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 55). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950421-103716-413_L1C_050-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0/SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0.zip
run script
2024-01-16T14:05:56.799    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:05:56.799    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0.zip
2024-01-16T14:05:56.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:05:56.800    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104453-642_L1C_048-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:06:07.977    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:06:07.978    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104454-704_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0/SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0.zip
run script
2024-01-16T14:06:20.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0.zip
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:06:20.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:06:20.905    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:06:20.905    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:06:20.905    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104522-919_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0/SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0.zip
run script
2024-01-16T14:06:45.924    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0.zip
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:06:45.925    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:06:45.926    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104526-733_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0/SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0.zip
run script
2024-01-16T14:07:01.913    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0.zip
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:01.915    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T14:07:04.330    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (203 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950501-104531-245_L1C_049-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1995/05/01/SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0/SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0.zip
run script
2024-01-16T14:07:07.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:07.464    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0.zip
2024-01-16T14:07:07.464    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:07.465    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950501-104551-137_L1C_049-261-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0/SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0.zip
run script
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0.zip
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:10.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:10.489    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-831_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0/SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0.zip
run script
2024-01-16T14:07:24.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:24.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0.zip
2024-01-16T14:07:24.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:24.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:24.332    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-660_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0/SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:07:39.601    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:39.602    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:07:39.602    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:39.603    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102929-915_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:07:53.649    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:07:53.650    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:07:53.650    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:07:53.650    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:07:53.650    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:07:53.651    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:07:53.651    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:07:53.651    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:07:53.651    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:07:53.651    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102929-744_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0/SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T14:08:09.731    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:08:09.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0.zip
2024-01-16T14:08:09.732    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:08:09.733    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102938-130_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0/SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0.zip
run script
2024-01-16T14:08:35.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:08:35.512    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0.zip
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:08:35.513    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950507-102940-837_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0/SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T14:08:57.484    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0.zip
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:08:57.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102937-962_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/07/SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0/SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0.zip
run script
2024-01-16T14:09:30.413    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:09:30.414    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0.zip
2024-01-16T14:09:30.414    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:09:30.414    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:09:30.415    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950507-102940-669_L1C_048-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0/SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0.zip
run script
2024-01-16T14:09:58.651    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0.zip
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:09:58.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:09:58.653    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:09:58.653    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:09:58.653    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-353_L1C_048-254-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0/SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:10:19.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:10:19.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:10:19.554    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104908-545_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0/SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T14:10:40.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0.zip
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:10:40.892    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:10:40.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:10:40.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104916-868_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0/SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0.zip
run script
2024-01-16T14:11:25.690    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:11:25.691    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0.zip
2024-01-16T14:11:25.691    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:11:25.691    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:11:25.691    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:11:25.692    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:11:25.692    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:11:25.692    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:11:25.692    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:11:25.692    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104922-283_L1C_048-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0/SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0.zip
run script
2024-01-16T14:12:04.491    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:12:04.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0.zip
2024-01-16T14:12:04.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:12:04.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:12:04.493    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104939-218_L1C_049-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0/SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0.zip
run script
2024-01-16T14:12:29.289    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0.zip
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:12:29.291    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104938-905_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0/SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0.zip
run script
2024-01-16T14:13:34.436    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:13:34.437    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0.zip
2024-01-16T14:13:34.437    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:13:34.437    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:13:34.437    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:13:34.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:13:34.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:13:34.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:13:34.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:13:34.438    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950627-104941-248_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0/SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0.zip
run script
2024-01-16T14:13:53.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:13:53.499    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0.zip
2024-01-16T14:13:53.499    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:13:53.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-045_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0/SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0.zip
run script
2024-01-16T14:14:56.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0.zip
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:14:56.856    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104940-947_L1C_049-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0/SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0.zip
run script
2024-01-16T14:15:58.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:15:58.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0.zip
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:15:58.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104907-534_L1C_050-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0/SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0.zip
run script
2024-01-16T14:16:55.595    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0.zip
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:16:55.596    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:16:55.597    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:16:55.597    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104914-976_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/27/SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0/SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0.zip
run script
2024-01-16T14:19:07.394    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:19:07.395    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0.zip
2024-01-16T14:19:07.395    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:19:07.395    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:19:07.395    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:19:07.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:19:07.396    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:19:07.396    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:19:07.396    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:19:07.396    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950627-104922-195_L1C_050-256-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0/SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0.zip
run script
2024-01-16T14:21:12.182    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:21:12.183    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0.zip
2024-01-16T14:21:12.192    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:21:12.192    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:21:12.192    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:21:12.193    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:21:12.193    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:21:12.193    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:21:12.193    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:21:12.193    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103746-625_L1C_048-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:21:27.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:21:27.782    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103747-650_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0/SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0.zip
run script
2024-01-16T14:21:48.011    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0.zip
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:21:48.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:21:48.014    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103752-162_L1C_048-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0/SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0.zip
run script
2024-01-16T14:22:24.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:22:24.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0.zip
2024-01-16T14:22:24.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:22:24.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:22:24.518    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-295_L1C_048-257-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0/SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0.zip
run script
2024-01-16T14:22:44.102    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0.zip
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:22:44.103    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:22:44.104    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:22:44.104    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:22:44.104    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103812-442_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0/SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0.zip
run script
2024-01-16T14:23:03.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:23:03.029    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0.zip
2024-01-16T14:23:03.029    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:23:03.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:23:03.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:23:03.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:23:03.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:23:03.030    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:23:03.030    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:23:03.030    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103830-746_L1C_052-260-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0/SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0.zip
run script
2024-01-16T14:25:19.695    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0.zip
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:25:19.696    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103832-761_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0/SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0.zip
run script
2024-01-16T14:27:36.845    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0.zip
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:27:36.847    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950803-103841-106_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0/SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0.zip
run script
2024-01-16T14:29:39.529    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0.zip
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:29:39.531    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103831-077_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0/SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0.zip
run script
2024-01-16T14:31:28.057    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:31:28.058    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0.zip
2024-01-16T14:31:28.058    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:31:28.058    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:31:28.059    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103839-433_L1C_053-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/03/SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0/SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0.zip
run script
2024-01-16T14:33:17.972    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0.zip
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:33:17.973    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950803-103830-851_L1C_054-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/15/SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0/SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0.zip
run script
2024-01-16T14:35:04.694    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0.zip
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:04.695    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110107-415_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/15/SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:35:07.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:07.816    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951215-110115-813_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/16/SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0/SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0.zip
run script
2024-01-16T14:35:24.628    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0.zip
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:24.629    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104149-672_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/12/16/SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0/SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0.zip
run script
2024-01-16T14:35:27.511    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:27.511    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0.zip
2024-01-16T14:35:27.511    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:27.512    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104157-935_L1C_048-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/12/16/SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0/SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0.zip
run script
2024-01-16T14:35:40.927    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:40.928    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0.zip
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:40.929    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951216-104158-838_L1C_048-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0/SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0.zip
run script
2024-01-16T14:35:56.521    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0.zip
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:35:56.522    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:35:56.523    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-148_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0/SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0.zip
run script
2024-01-16T14:36:40.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0.zip
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:36:40.817    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104119-298_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0/SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0.zip
run script
2024-01-16T14:37:25.154    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0.zip
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:37:25.155    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:37:25.156    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:37:25.156    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104127-579_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0/SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0.zip
run script
2024-01-16T14:37:58.302    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0.zip
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:37:58.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:37:58.304    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104135-872_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0/SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0.zip
run script
2024-01-16T14:38:12.027    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:38:12.028    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0.zip
2024-01-16T14:38:12.028    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:38:12.029    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104144-172_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0/SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0.zip
run script
2024-01-16T14:38:15.131    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0.zip
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:38:15.132    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104145-976_L1C_048-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0/SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0.zip
run script
2024-01-16T14:38:18.163    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0.zip
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:38:18.164    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:38:18.165    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:38:18.165    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:38:18.165    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104204-472_L1C_051-261-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0/SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0.zip
run script
2024-01-16T14:39:46.022    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:39:46.023    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0.zip
2024-01-16T14:39:46.023    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:39:46.024    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104205-600_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0/SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0.zip
run script
2024-01-16T14:41:10.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:41:10.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0.zip
2024-01-16T14:41:10.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:41:10.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950522-104213-960_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/22/SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0/SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0.zip
run script
2024-01-16T14:41:46.781    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0.zip
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:41:46.782    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:41:46.783    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:41:46.783    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:41:46.783    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950522-104204-190_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/19/SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0/SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0.zip
run script
2024-01-16T14:43:49.640    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0.zip
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:43:49.642    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110211-106_L1C_048-260-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/11/19/SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0/SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0.zip
run script
2024-01-16T14:43:52.733    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:43:52.734    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0.zip
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:43:52.735    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951119-110212-327_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/06/16/SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0/SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0.zip
run script
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0.zip
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:43:55.833    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110059-433_L1C_049-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/06/16/SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0/SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0.zip
run script
2024-01-16T14:44:51.665    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:44:51.666    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0.zip
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:44:51.667    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T14:45:36.406    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 96). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110101-548_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/06/16/SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0/SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0.zip
run script
2024-01-16T14:45:40.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0.zip
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:45:40.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950616-110108-767_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/06/SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0/SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0.zip
run script
2024-01-16T14:46:12.547    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0.zip
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:46:12.549    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:46:12.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:46:12.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104919-559_L1C_049-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/06/SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0/SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0.zip
run script
2024-01-16T14:46:35.072    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0.zip
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:46:35.073    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104920-687_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/06/SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0/SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0.zip
run script
2024-01-16T14:46:54.041    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0.zip
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:46:54.042    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T14:46:56.113    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1834 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950506-104927-004_L1C_049-259-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/1995/05/27/SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0/SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0.zip
run script
2024-01-16T14:46:59.498    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0.zip
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:46:59.500    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104533-161_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/05/27/SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0/SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0.zip
run script
2024-01-16T14:47:26.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0.zip
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:47:26.968    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:47:26.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:47:26.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:47:26.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950527-104536-771_L1C_049-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/12/SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0/SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0.zip
run script
2024-01-16T14:47:45.301    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:47:45.302    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0.zip
2024-01-16T14:47:45.302    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:47:45.302    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:47:45.302    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:47:45.302    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:47:45.303    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:47:45.303    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:47:45.303    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:47:45.303    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104105-645_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/01/12/SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0/SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0.zip
run script
2024-01-16T14:47:48.896    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0.zip
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:47:48.898    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104113-962_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/01/12/SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0/SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0.zip
run script
2024-01-16T14:47:51.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0.zip
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:47:51.845    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950112-104122-288_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/04/27/SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0/SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0.zip
run script
2024-01-16T14:47:55.515    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0.zip
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:47:55.517    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102221-100_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/04/27/SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0/SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0.zip
run script
2024-01-16T14:48:06.959    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0.zip
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:06.960    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102229-348_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/04/27/SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0/SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0.zip
run script
2024-01-16T14:48:10.479    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0.zip
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:10.481    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950427-102237-605_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/07/SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0/SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0.zip
run script
2024-01-16T14:48:14.485    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0.zip
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:14.487    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105747-602_L1C_049-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/07/SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0/SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0.zip
run script
2024-01-16T14:48:19.557    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:19.559    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0.zip
2024-01-16T14:48:19.559    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:19.559    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:19.559    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:19.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:19.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:19.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:19.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:19.560    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950707-105752-420_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0/SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0.zip
run script
2024-01-16T14:48:23.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:23.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0.zip
2024-01-16T14:48:23.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:23.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:23.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:23.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:23.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:23.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:23.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:23.542    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103342-806_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0/SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0.zip
run script
2024-01-16T14:48:26.789    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:48:26.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0.zip
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:48:26.791    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103351-051_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 0 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0/SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0.zip
run script
2024-01-16T14:49:16.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:49:16.346    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0.zip
2024-01-16T14:49:16.346    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:49:16.347    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950729-103419-618_L1C_051-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0/SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0.zip
run script
2024-01-16T14:51:35.994    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0.zip
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:51:35.995    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:51:35.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103438-250_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0/SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0.zip
run script
2024-01-16T14:53:51.906    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0.zip
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:53:51.907    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103446-573_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/07/29/SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0/SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0.zip
run script
2024-01-16T14:55:47.124    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0.zip
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:55:47.126    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950729-103451-987_L1C_052-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0/SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0.zip
run script
2024-01-16T14:57:10.469    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:57:10.470    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0.zip
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:57:10.471    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102212-505_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0/SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0.zip
run script
2024-01-16T14:57:13.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:57:13.645    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0.zip
2024-01-16T14:57:13.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:57:13.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:57:13.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:57:13.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:57:13.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:57:13.646    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:57:13.647    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:57:13.647    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102228-911_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0/SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0.zip
run script
2024-01-16T14:59:48.530    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T14:59:48.531    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0.zip
2024-01-16T14:59:48.531    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T14:59:48.531    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T14:59:48.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T14:59:48.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T14:59:48.532    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T14:59:48.532    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T14:59:48.532    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T14:59:48.532    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102237-128_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0/SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0.zip
run script
2024-01-16T15:02:31.831    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0.zip
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:02:31.833    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T15:04:11.011    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 251). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102245-358_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0/SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0.zip
run script
2024-01-16T15:04:15.095    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:04:15.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0.zip
2024-01-16T15:04:15.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:04:15.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:04:15.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:04:15.096    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:04:15.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:04:15.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:04:15.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:04:15.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102253-594_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0/SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0.zip
run script
2024-01-16T15:06:34.836    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0.zip
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:06:34.838    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T15:08:09.646    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (402 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102301-842_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/08/09/SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0/SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0.zip
run script
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0.zip
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:08:13.378    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:08:13.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:08:13.379    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:08:13.379    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950809-102310-999_L1C_051-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/23/SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0/SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0.zip
run script
2024-01-16T15:09:44.101    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0.zip
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:09:44.103    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:09:44.104    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105718-539_L1C_050-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/09/23/SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0/SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0.zip
run script
2024-01-16T15:09:47.437    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0.zip
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:09:47.438    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105724-245_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/23/SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0/SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0.zip
run script
2024-01-16T15:10:43.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0.zip
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:10:43.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105732-661_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/23/SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0/SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0.zip
run script
2024-01-16T15:13:41.876    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0.zip
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:13:41.878    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:13:41.879    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:13:41.879    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950923-105733-563_L1C_050-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/18/SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0/SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0.zip
run script
2024-01-16T15:16:44.904    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:16:44.905    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0.zip
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:16:44.906    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104928-930_L1C_050-255-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/08/18/SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0/SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0.zip
run script
2024-01-16T15:17:49.637    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:17:49.638    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0.zip
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:17:49.639    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950818-104934-345_L1C_050-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/10/14/SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0/SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0.zip
run script
2024-01-16T15:20:03.465    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0.zip
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:20:03.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:20:03.467    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:20:03.467    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:20:03.467    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105342-098_L1C_050-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/10/14/SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0/SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0.zip
run script
2024-01-16T15:22:00.670    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:22:00.671    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0.zip
2024-01-16T15:22:00.671    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:22:00.672    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951014-105345-708_L1C_050-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/29/SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0/SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0.zip
run script
2024-01-16T15:24:42.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:24:42.988    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0.zip
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:24:42.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104212-027_L1C_050-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/29/SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0/SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0.zip
run script
2024-01-16T15:26:39.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:26:39.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0.zip
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:26:39.055    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104217-619_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/29/SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0/SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0.zip
run script
2024-01-16T15:28:39.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0.zip
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:28:39.647    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950929-104222-131_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/10/09/SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0/SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0.zip
run script
2024-01-16T15:30:22.110    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:30:22.111    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0.zip
2024-01-16T15:30:22.111    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:30:22.111    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:30:22.111    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:30:22.111    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:30:22.112    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:30:22.112    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:30:22.112    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:30:22.112    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-104957-057_L1C_050-256-3_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/10/09/SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0/SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0.zip
run script
2024-01-16T15:32:35.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0.zip
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:32:35.100    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105002-703_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/10/09/SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0/SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0.zip
run script
2024-01-16T15:34:46.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:34:46.970    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0.zip
2024-01-16T15:34:46.970    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:34:46.970    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:34:46.970    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:34:46.970    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:34:46.971    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:34:46.971    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:34:46.971    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:34:46.971    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951009-105008-117_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0/SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0.zip
run script
2024-01-16T15:36:32.956    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0.zip
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:36:32.957    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:36:32.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:36:32.958    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103447-899_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0/SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0.zip
run script
2024-01-16T15:37:43.362    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0.zip
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:37:43.364    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103456-183_L1C_050-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0/SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0.zip
run script
2024-01-16T15:38:32.958    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0.zip
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:38:32.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103504-473_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0/SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0.zip
run script
2024-01-16T15:39:13.178    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:39:13.179    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0.zip
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:39:13.180    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950919-103506-278_L1C_050-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 0 0 ... 0 0 0]
 [2 0 0 ... 0 0 0]
 [2 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0/SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0.zip
run script
2024-01-16T15:39:49.782    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0.zip
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:39:49.783    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:39:49.784    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:39:49.784    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:39:49.784    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103446-356_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0/SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0.zip
run script
2024-01-16T15:42:08.855    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0.zip
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:42:08.856    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103454-652_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0/SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0.zip
run script
2024-01-16T15:43:54.474    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0.zip
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:43:54.476    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T15:45:31.452    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (121 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103502-954_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/09/19/SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0/SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0.zip
run script
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0.zip
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:45:34.661    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:45:34.662    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950919-103506-564_L1C_051-261-4_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/15/SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0/SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0.zip
run script
2024-01-16T15:47:12.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:47:12.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0.zip
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:47:12.509    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103902-408_L1C_050-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/15/SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0/SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0.zip
run script
2024-01-16T15:48:02.014    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:48:02.015    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0.zip
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:48:02.016    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103907-822_L1C_050-261-7_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/15/SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0/SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0.zip
run script
2024-01-16T15:48:40.370    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0.zip
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:48:40.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:48:40.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103841-198_L1C_052-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/11/15/SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0/SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0.zip
run script
2024-01-16T15:51:11.567    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0.zip
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:51:11.568    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19951115-103842-299_L1C_052-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0/SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0.zip
run script
2024-01-16T15:53:39.393    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:53:39.394    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0.zip
2024-01-16T15:53:39.394    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:53:39.394    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:53:39.394    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:53:39.395    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:53:39.395    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:53:39.395    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:53:39.395    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:53:39.395    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101703-900_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0/SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0.zip
run script
2024-01-16T15:53:42.352    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:53:42.352    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0.zip
2024-01-16T15:53:42.352    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:53:42.353    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101728-503_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0/SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0.zip
run script
2024-01-16T15:56:35.543    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0.zip
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:56:35.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:56:35.545    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:56:35.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:56:35.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-16T15:57:55.427    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 372). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101736-724_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0/SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0.zip
run script
2024-01-16T15:57:58.968    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T15:57:58.968    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0.zip
2024-01-16T15:57:58.968    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T15:57:58.969    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101744-953_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0/SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0.zip
run script
2024-01-16T16:00:47.483    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0.zip
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T16:00:47.485    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101753-195_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0/SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0.zip
run script
2024-01-16T16:03:09.900    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0.zip
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T16:03:09.901    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T16:03:09.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV1-XS_19950108-101757-707_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0/SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0.zip
run script
2024-01-16T16:05:53.082    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T16:05:53.083    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0.zip
2024-01-16T16:05:53.083    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T16:05:53.083    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T16:05:53.083    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T16:05:53.083    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T16:05:53.084    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T16:05:53.084    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T16:05:53.084    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T16:05:53.084    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101743-723_L1C_053-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0/SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0.zip
run script
2024-01-16T16:08:09.724    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0.zip
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T16:08:09.725    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T16:08:09.726    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T16:08:09.726    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T16:08:09.726    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101751-971_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4403716/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/1995/01/08/SPOT3-HRV2-XS_19950108-101757-385_L1C_053-260-6_D_V1-0/SPOT3-HRV2-XS_19950108-101757-385_L1C_053-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT3-HRV2-XS_19950108-101757-385_L1C_053-260-6_D_V1-0.zip
/tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101757-385_L1C_053-260-6_D_V1-0.zip
run script
2024-01-16T16:10:22.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4403716/INPUT/SPOT3-HRV2-XS_19950108-101757-385_L1C_053-260-6_D_V1-0.zip
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:model type : mtn
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:mask inference : None
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-16T16:10:22.284    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
