unload conda/22.11.1  : OK 
load conda/22.11.1  : OK 
envs_dirs : /work/scratch/env/barrouz/conda_env/
pkgs_dirs : /work/scratch/env/barrouz/pkgs_conda
INPUT_PATH /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/39.txt
OUTPUT_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
DEM_PATH /work/CAMPUS/etudes/Neige/DEM
TCD_PATH /work/datalake/static_aux/TreeCoverDensity
MODELS_PATH /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
KEEP_REFL 0
MASK 1
start
/home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/list_large/ALP/39.txt
muscate/SPOTWORLDHERITAGE/2013/02/13/SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:22:01.587    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:22:01.588    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:22:01.588    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:22:01.588    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:22:01.588    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:22:01.588    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:22:01.589    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:22:01.589    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:22:01.589    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:22:01.589    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091823-827_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/02/13/SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T11:25:24.878    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0.zip
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:25:24.880    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130213-091829-241_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/25/SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T11:28:31.103    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0.zip
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:28:31.104    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091527-896_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/25/SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:29:04.467    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:04.468    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:04.469    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091535-254_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/25/SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T11:29:19.703    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0.zip
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:19.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:19.705    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:19.705    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:29:22.954    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (181 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091538-863_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/03/25/SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:29:26.739    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:29:26.740    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:29:26.740    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:29:26.740    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:29:26.740    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:29:26.741    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:29:26.741    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:29:26.741    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:29:26.741    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:29:26.741    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091508-474_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/25/SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T11:32:43.714    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:32:43.715    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0.zip
2024-01-09T11:32:43.715    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:32:43.716    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130325-091513-888_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 0 ... 2 2 2]
 [1 1 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T11:35:53.900    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0.zip
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:35:53.901    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:35:53.902    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:35:53.902    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091502-017_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:36:25.485    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:25.486    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:36:25.486    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:25.486    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:25.486    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:25.486    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:25.487    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:25.487    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:25.487    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:25.487    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091509-371_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T11:36:37.824    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0.zip
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:37.826    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:36:40.728    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (181 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091512-981_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:36:43.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:36:43.949    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:36:43.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091444-267_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T11:38:14.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0.zip
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:38:14.048    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130330-091447-877_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:39:38.948    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:39:38.950    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091442-595_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/30/SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T11:42:53.903    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0.zip
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:42:53.904    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130330-091448-009_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T11:46:03.488    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:03.489    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0.zip
2024-01-09T11:46:03.489    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:03.489    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:03.489    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:03.489    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:03.490    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:03.490    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:03.490    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:03.490    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091436-691_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T11:46:34.612    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:46:34.613    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0.zip
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:46:34.614    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091413-415_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T11:48:09.520    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0.zip
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:48:09.522    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091418-041_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0/SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T11:49:38.471    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0.zip
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:49:38.473    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130404-091422-553_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T11:51:02.459    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0.zip
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:51:02.460    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091413-535_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/04/SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T11:54:18.747    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0.zip
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:54:18.748    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:54:18.749    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:54:18.749    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:54:18.749    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130404-091416-368_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/09/SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T11:57:32.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0.zip
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:57:32.991    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091410-094_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/09/SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:58:07.775    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:07.776    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:58:07.776    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:07.776    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:07.777    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091416-549_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/09/SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T11:58:24.857    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0.zip
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:24.858    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:24.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:24.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:24.859    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:58:28.563    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (356 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130409-091420-159_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T11:58:33.444    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0.zip
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:58:33.445    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:58:33.446    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:58:33.446    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091343-854_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0.zip
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:05.300    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:05.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:05.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:05.301    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091351-211_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T11:59:19.492    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0.zip
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:19.493    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T11:59:23.495    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (360 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091354-821_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0/SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0.zip
run script
2024-01-09T11:59:28.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T11:59:28.223    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0.zip
2024-01-09T11:59:28.223    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T11:59:28.223    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T11:59:28.224    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091322-386_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:01:05.622    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:01:05.624    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091326-107_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T12:02:33.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0.zip
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:02:33.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:02:33.608    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130414-091329-716_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 2 ... 1 1 1]
 [0 2 2 ... 1 1 1]
 [0 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0/SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0.zip
run script
2024-01-09T12:03:54.391    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:03:54.392    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0.zip
2024-01-09T12:03:54.392    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:03:54.392    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:03:54.392    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:03:54.392    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:03:54.393    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:03:54.393    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:03:54.393    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:03:54.393    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091322-506_L1C_051-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 [1 1 1 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:07:08.550    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:07:08.551    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:07:08.551    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:07:08.551    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:07:08.552    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091324-437_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/14/SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T12:10:24.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:10:24.862    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0.zip
2024-01-09T12:10:24.862    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:10:24.862    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:10:24.863    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130414-091329-852_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/19/SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T12:13:27.119    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:27.120    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0.zip
2024-01-09T12:13:27.120    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:27.120    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:27.120    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:27.120    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:27.121    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:27.121    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:27.121    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:27.121    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091320-864_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/19/SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:13:54.519    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:13:54.520    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:13:54.521    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091327-319_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/19/SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:14:06.771    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:06.772    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:14:06.772    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:06.772    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:06.772    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:06.773    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:06.773    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:06.773    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:06.773    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:06.773    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:14:09.499    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (183 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091330-929_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/19/SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T12:14:13.333    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:14:13.334    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0.zip
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:14:13.335    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130419-091305-959_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T12:17:15.411    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0.zip
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:15.412    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:15.413    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:15.413    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:15.413    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091255-811_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 0 2 0]
 [2 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:17:46.330    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:46.331    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091303-168_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:17:57.905    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:17:57.906    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:17:57.907    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:18:00.452    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (370 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091306-778_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T12:18:04.122    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0.zip
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:18:04.123    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091233-438_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:19:29.097    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:19:29.098    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:19:29.098    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:19:29.098    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:19:29.099    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091238-064_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T12:20:57.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0.zip
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:20:57.677    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130424-091241-674_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 2 2 ... 1 1 1]
 [0 2 2 ... 1 1 1]
 [2 2 2 ... 0 0 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T12:22:15.107    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0.zip
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:22:15.108    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:22:15.109    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091233-561_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 0 0 0]
 [1 1 1 ... 0 2 2]
 [1 1 1 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:25:29.804    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:25:29.805    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:25:29.806    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091236-392_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/04/24/SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T12:28:27.673    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0.zip
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:28:27.674    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:28:27.675    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:28:27.675    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130424-091241-806_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/09/SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T12:31:10.835    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:31:10.836    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0.zip
2024-01-09T12:31:10.836    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:31:10.836    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:31:10.837    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091140-758_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/09/SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:31:34.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:31:34.433    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130509-091148-115_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/09/SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:31:44.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:31:44.788    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091123-008_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/09/SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T12:32:59.730    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:32:59.732    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0.zip
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:32:59.733    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130509-091126-618_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/19/SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0/SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0.zip
run script
2024-01-09T12:34:10.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0.zip
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:10.641    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091048-225_L1C_049-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/19/SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:34:35.942    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:35.943    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:35.944    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091055-583_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/19/SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:34:46.708    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:46.710    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:34:49.545    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (370 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130519-091059-192_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T12:34:52.995    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0.zip
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:34:52.996    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091022-068_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:35:18.897    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:18.898    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091028-523_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:35:29.552    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:29.553    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:29.554    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:35:31.655    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (368 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091032-132_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:35:34.574    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:35:34.575    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091003-417_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T12:36:52.490    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0.zip
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:36:52.492    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130524-091007-027_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:38:03.931    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:38:03.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:38:03.933    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:38:03.933    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091001-745_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/24/SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T12:40:56.815    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:40:56.816    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0.zip
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:40:56.817    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130524-091007-159_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T12:44:04.797    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:04.798    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0.zip
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:04.799    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090954-459_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 0 2 2]
 [2 0 0 ... 0 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:44:33.156    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:33.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091000-914_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:44:50.604    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:50.605    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:44:53.548    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (183 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-091004-524_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T12:44:57.680    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0.zip
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:44:57.681    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:44:57.682    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090931-183_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T12:46:27.139    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0.zip
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:46:27.141    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090935-810_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T12:47:57.184    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0.zip
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:47:57.185    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:47:57.186    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130529-090939-419_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T12:49:18.168    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0.zip
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:49:18.169    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090931-304_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T12:52:26.606    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0.zip
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:52:26.607    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090934-137_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/05/29/SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T12:55:25.183    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0.zip
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:55:25.184    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130529-090939-551_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [2 0 0 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0/SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0.zip
run script
2024-01-09T12:58:15.957    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0.zip
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:15.958    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:15.959    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090926-464_L1C_049-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 2]
 [0 0 0 ... 0 0 2]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0/SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T12:58:46.720    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:58:46.721    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0.zip
2024-01-09T12:58:46.721    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:58:46.721    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:58:46.721    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:58:46.721    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:58:46.722    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:58:46.722    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:58:46.722    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:58:46.722    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090932-922_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0/SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0.zip
run script
2024-01-09T12:59:02.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:02.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0.zip
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:02.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T12:59:06.577    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (182 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090936-532_L1C_049-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0/SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0.zip
run script
2024-01-09T12:59:11.228    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0.zip
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T12:59:11.229    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T12:59:11.230    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090903-188_L1C_050-258-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T13:00:44.143    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0.zip
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:00:44.144    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090907-814_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0/SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0.zip
run script
2024-01-09T13:02:14.486    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:02:14.487    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0.zip
2024-01-09T13:02:14.487    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:02:14.488    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130603-090912-326_L1C_050-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T13:03:35.706    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:03:35.706    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0.zip
2024-01-09T13:03:35.706    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:03:35.707    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090903-308_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:06:44.645    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:06:44.646    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:06:44.647    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:06:44.647    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:06:44.647    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090906-142_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/03/SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T13:09:59.384    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:09:59.385    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0.zip
2024-01-09T13:09:59.385    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:09:59.385    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:09:59.385    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:09:59.385    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:09:59.386    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:09:59.386    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:09:59.386    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:09:59.386    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130603-090911-556_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/08/SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0/SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0.zip
run script
2024-01-09T13:12:59.256    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:12:59.257    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0.zip
2024-01-09T13:12:59.257    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:12:59.257    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:12:59.257    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:12:59.257    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:12:59.258    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:12:59.258    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:12:59.258    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:12:59.258    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090838-883_L1C_050-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/08/SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0/SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T13:14:35.322    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:14:35.323    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0.zip
2024-01-09T13:14:35.323    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:14:35.323    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:14:35.323    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:14:35.323    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:14:35.324    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:14:35.324    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:14:35.324    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:14:35.324    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090842-607_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/08/SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0/SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0.zip
run script
2024-01-09T13:16:01.295    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0.zip
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:16:01.296    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130608-090846-217_L1C_050-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/06/08/SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T13:18:35.094    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:18:35.095    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0.zip
2024-01-09T13:18:35.095    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:18:35.095    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:18:35.095    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:18:35.095    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:18:35.096    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:18:35.096    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:18:35.096    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:18:35.096    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130608-090846-352_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/28/SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0/SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0.zip
run script
2024-01-09T13:21:30.156    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0.zip
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:21:30.157    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR1-XS_20130128-093907-445_L1C_050-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/01/28/SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0/SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0.zip
run script
2024-01-09T13:22:15.266    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0.zip
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:22:15.267    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T13:23:40.793    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (169 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093908-068_L1C_052-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2013/01/28/SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0/SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0.zip
run script
2024-01-09T13:23:44.207    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0.zip
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:23:44.209    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130128-093911-939_L1C_052-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/20/SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0/SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0.zip
run script
2024-01-09T13:24:40.093    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0.zip
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:24:40.094    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091531-224_L1C_051-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/20/SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0/SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T13:27:43.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0.zip
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:27:43.337    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:27:43.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:27:43.338    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091534-058_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2013/03/20/SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0/SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0.zip
run script
2024-01-09T13:31:33.545    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0.zip
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:31:33.546    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT4-HRVIR2-XS_20130320-091539-472_L1C_051-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0/SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0.zip
run script
2024-01-09T13:34:26.115    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:34:26.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0.zip
2024-01-09T13:34:26.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:34:26.116    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:34:26.117    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104325-254_L1C_046-263-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0/SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0.zip
run script
2024-01-09T13:35:23.482    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0.zip
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:35:23.484    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104222-986_L1C_052-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 0]
 [2 2 2 ... 0 0 1]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 1 0 0]
 [0 0 0 ... 0 0 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0/SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0.zip
run script
2024-01-09T13:38:19.277    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0.zip
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:38:19.278    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104227-498_L1C_052-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 [2 2 2 ... 1 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 2 2]
 [2 2 2 ... 1 1 2]
 [2 2 2 ... 1 1 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0/SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0.zip
run script
2024-01-09T13:41:24.199    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0.zip
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:41:24.201    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104246-430_L1C_053-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0/SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0.zip
run script
2024-01-09T13:43:49.217    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0.zip
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:43:49.218    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104254-798_L1C_053-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0/SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0.zip
run script
2024-01-09T13:46:31.641    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:46:31.642    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0.zip
2024-01-09T13:46:31.642    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:46:31.642    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:46:31.642    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:46:31.643    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:46:31.643    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:46:31.643    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:46:31.643    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:46:31.643    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000619-104304-072_L1C_053-262-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0/SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0.zip
run script
2024-01-09T13:48:59.348    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0.zip
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:48:59.350    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104253-285_L1C_054-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0/SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T13:51:02.977    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0.zip
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:51:02.978    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:51:02.979    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104301-672_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/19/SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0/SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0.zip
run script
2024-01-09T13:53:02.050    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0.zip
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:53:02.051    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:53:02.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:53:02.052    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000619-104304-379_L1C_054-262-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/08/SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0/SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0.zip
run script
2024-01-09T13:55:01.176    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:01.177    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0.zip
2024-01-09T13:55:01.177    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:01.178    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000508-104920-428_L1C_047-254-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0/SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T13:55:04.702    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:04.703    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0.zip
2024-01-09T13:55:04.703    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:04.703    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:04.703    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:04.703    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:04.704    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:04.704    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:04.704    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:04.704    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110204-226_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0/SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:55:27.883    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:27.884    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110208-116_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0/SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:55:42.429    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:42.430    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:55:42.430    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:42.430    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:42.430    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:42.430    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:42.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:42.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:42.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:42.431    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110216-526_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/09/SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0/SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:46.585    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:46.586    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:46.586    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:46.586    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:46.586    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000809-110224-936_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0/SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0.zip
run script
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0.zip
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:55:50.116    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110559-506_L1C_047-255-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0/SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0.zip
run script
2024-01-09T13:56:13.514    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:13.515    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0.zip
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:13.516    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110603-432_L1C_047-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0/SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:56:30.810    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:30.811    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:30.812    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110611-875_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/14/SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0/SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:56:34.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:34.233    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:34.234    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000814-110620-322_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0/SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0.zip
run script
2024-01-09T13:56:37.456    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:37.457    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0.zip
2024-01-09T13:56:37.457    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:37.458    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102732-558_L1C_047-256-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0/SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:56:40.884    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:40.886    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102739-868_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0/SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T13:56:44.106    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0.zip
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:44.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:44.108    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102748-089_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/11/SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0/SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0.zip
run script
2024-01-09T13:56:47.540    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0.zip
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:47.541    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:47.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:47.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:47.542    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000911-102754-406_L1C_047-258-7_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/12/SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0/SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:56:50.809    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:50.810    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104516-848_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/12/SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0/SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0.zip
run script
2024-01-09T13:56:54.050    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:54.051    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0.zip
2024-01-09T13:56:54.051    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:54.051    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:54.051    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:54.051    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:54.052    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:54.052    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:54.052    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:54.052    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104518-652_L1C_047-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/12/SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0/SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0.zip
run script
2024-01-09T13:56:57.389    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0.zip
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:56:57.411    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104448-494_L1C_050-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/12/SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0/SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0.zip
run script
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0.zip
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:00.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:00.641    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000312-104453-006_L1C_050-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/17/SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0/SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0.zip
run script
2024-01-09T13:57:04.059    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0.zip
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:04.081    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:04.082    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104907-396_L1C_047-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/17/SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0/SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0.zip
run script
2024-01-09T13:57:07.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:07.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0.zip
2024-01-09T13:57:07.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:07.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:07.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:07.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:07.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:07.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:07.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:07.338    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000317-104911-006_L1C_047-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/03/17/SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0/SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0.zip
run script
2024-01-09T13:57:10.611    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:57:10.612    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0.zip
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:57:10.613    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104931-893_L1C_051-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/03/17/SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0/SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T13:59:39.373    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0.zip
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T13:59:39.374    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T13:59:39.375    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T13:59:39.375    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T13:59:39.375    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:01:50.556    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (256 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104935-776_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/03/17/SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T14:01:53.732    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0.zip
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:01:53.733    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:01:53.734    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:01:53.734    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:01:53.734    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000317-104944-181_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/04/SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0/SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0.zip
run script
2024-01-09T14:03:32.516    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0.zip
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:32.517    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110230-633_L1C_047-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/04/SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0/SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T14:03:35.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0.zip
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:35.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:35.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:35.964    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000904-110233-629_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0/SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0.zip
run script
2024-01-09T14:03:39.372    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0.zip
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:39.373    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:39.374    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105827-604_L1C_047-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0/SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T14:03:42.708    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:42.709    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0.zip
2024-01-09T14:03:42.709    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:42.709    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:42.709    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:42.709    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:42.710    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:42.710    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:42.710    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:42.710    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105835-994_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0/SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:03:46.908    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:46.909    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:46.910    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105844-392_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/04/SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0/SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0.zip
run script
2024-01-09T14:03:50.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0.zip
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:50.188    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:03:51.777    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (406 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000804-105819-218_L1C_048-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0/SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0.zip
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:55.209    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111016-420_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0/SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T14:03:58.975    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:03:58.975    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0.zip
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:03:58.976    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111022-201_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/19/SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0/SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0.zip
run script
2024-01-09T14:04:02.218    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:02.219    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0.zip
2024-01-09T14:04:02.219    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:02.220    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000819-111024-006_L1C_047-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0/SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0.zip
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:05.668    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:05.669    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105453-128_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0/SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0.zip
run script
2024-01-09T14:04:08.854    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0.zip
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:08.856    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105458-780_L1C_047-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0/SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0.zip
run script
2024-01-09T14:04:11.769    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:11.770    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0.zip
2024-01-09T14:04:11.770    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:11.770    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:11.770    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:11.771    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:11.771    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:11.771    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:11.771    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:11.771    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105500-584_L1C_047-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0/SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0.zip
run script
2024-01-09T14:04:15.047    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:15.048    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0.zip
2024-01-09T14:04:15.048    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:15.048    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:15.048    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:15.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:15.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:15.049    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:15.049    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:15.049    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-491_L1C_048-255-9_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0/SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0.zip
run script
2024-01-09T14:04:33.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0.zip
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:33.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:33.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:33.544    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:33.544    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105433-714_L1C_048-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/25/SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0/SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0.zip
run script
2024-01-09T14:04:52.494    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0.zip
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:04:52.496    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000825-105435-519_L1C_048-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/26/SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0/SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0.zip
run script
2024-01-09T14:05:05.933    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:05:05.934    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0.zip
2024-01-09T14:05:05.934    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:05:05.934    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:05:05.934    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:05:05.935    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:05:05.935    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:05:05.935    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:05:05.935    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:05:05.935    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103534-976_L1C_047-258-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/26/SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:05:09.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:05:09.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:05:09.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:05:09.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:05:09.249    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103454-837_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/26/SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0/SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T14:05:12.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0.zip
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:05:12.283    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103503-094_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/26/SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0/SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0.zip
run script
2024-01-09T14:06:03.237    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0.zip
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:06:03.238    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:06:03.239    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:06:03.239    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:06:03.239    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103511-357_L1C_051-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/26/SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0/SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0.zip
run script
2024-01-09T14:08:42.531    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:08:42.532    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0.zip
2024-01-09T14:08:42.532    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:08:42.533    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000826-103516-771_L1C_051-256-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0/SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T14:11:53.076    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:53.077    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0.zip
2024-01-09T14:11:53.077    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:53.078    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102627-648_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0/SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:11:56.247    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:56.248    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000408-102632-277_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0/SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T14:11:59.676    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0.zip
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:11:59.677    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102627-579_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:12:03.295    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:03.296    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102631-314_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:06.847    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:06.848    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:06.848    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:06.848    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102639-568_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0/SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0.zip
run script
2024-01-09T14:12:10.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0.zip
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:10.465    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102647-831_L1C_048-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0/SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T14:12:14.478    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0.zip
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:14.479    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102540-606_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0/SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T14:12:17.860    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:12:17.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0.zip
2024-01-09T14:12:17.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:12:17.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:12:17.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102548-808_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0/SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0.zip
run script
2024-01-09T14:13:10.105    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:13:10.106    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0.zip
2024-01-09T14:13:10.106    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:13:10.106    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:13:10.106    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:13:10.106    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:13:10.107    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:13:10.107    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:13:10.107    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:13:10.107    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102550-613_L1C_049-255-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/08/SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0/SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0.zip
run script
2024-01-09T14:14:24.336    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0.zip
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:14:24.337    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:14:24.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:14:24.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:14:24.338    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000408-102607-055_L1C_049-257-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [0 0 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/22/SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0/SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T14:16:29.142    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0.zip
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:29.143    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105735-021_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/22/SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0/SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:16:32.785    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:32.786    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:16:32.786    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:32.787    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000422-105739-807_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/22/SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0/SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T14:16:36.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0.zip
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:36.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:36.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:36.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:36.406    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105734-579_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/22/SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:16:39.820    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:39.820    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:16:39.820    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:39.821    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105738-475_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/04/22/SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0/SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:16:42.937    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:42.938    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:42.939    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000422-105746-888_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/02/SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0/SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0.zip
run script
2024-01-09T14:16:46.299    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:46.300    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0.zip
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:46.301    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110527-060_L1C_047-259-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/02/SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0/SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:16:49.675    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:49.676    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:16:49.676    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:49.676    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:49.676    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:49.676    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:49.677    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:49.677    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:49.677    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:49.677    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000502-110530-104_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/19/SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0/SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0.zip
run script
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0.zip
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:52.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:52.770    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:52.770    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:52.770    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000519-103829-267_L1C_047-259-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/05/SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0/SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0.zip
run script
2024-01-09T14:16:55.939    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0.zip
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:55.940    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110655-610_L1C_047-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/05/SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0/SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:16:59.288    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:16:59.288    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:16:59.289    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001005-110703-167_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/11/05/SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0/SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0.zip
run script
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0.zip
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:02.626    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:02.627    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20001105-111058-243_L1C_047-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/14/SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0/SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0.zip
run script
2024-01-09T14:17:05.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:05.699    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0.zip
2024-01-09T14:17:05.699    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:05.699    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:05.699    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:05.700    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:05.700    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:05.700    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:05.700    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:05.700    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103349-967_L1C_048-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/14/SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0/SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0.zip
run script
2024-01-09T14:17:09.052    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0.zip
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:09.053    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000514-103352-674_L1C_048-254-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/01/SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0/SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0.zip
run script
2024-01-09T14:17:12.324    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0.zip
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:12.326    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104306-598_L1C_048-254-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/10/01/SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0/SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T14:17:15.655    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0.zip
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:17:15.657    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104326-030_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/10/01/SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T14:20:23.790    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0.zip
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:20:23.791    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:20:23.792    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:20:23.792    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:20:23.792    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:21:46.048    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 320). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20001001-104331-648_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0/SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0.zip
run script
2024-01-09T14:21:49.430    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0.zip
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:21:49.431    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:21:49.432    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104212-804_L1C_048-257-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [0 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0/SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0.zip
run script
2024-01-09T14:22:16.620    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:16.621    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0.zip
2024-01-09T14:22:16.621    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:16.621    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:16.621    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:16.621    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:16.622    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:16.622    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:16.622    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:16.622    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104217-484_L1C_048-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0/SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T14:22:30.857    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:30.858    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0.zip
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:30.859    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104225-783_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0/SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:22:34.279    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:34.280    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:22:34.280    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:34.280    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:34.281    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104234-091_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0/SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0.zip
run script
2024-01-09T14:22:37.495    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0.zip
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:37.497    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104239-506_L1C_048-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T14:22:40.590    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0.zip
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:40.591    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104141-015_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/05/24/SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0/SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0.zip
run script
2024-01-09T14:22:44.629    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:22:44.630    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0.zip
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:22:44.631    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000524-104149-314_L1C_051-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0/SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0.zip
run script
2024-01-09T14:23:36.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:36.790    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0.zip
2024-01-09T14:23:36.793    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:36.795    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:36.799    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:36.801    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:36.804    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:36.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:36.809    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:36.812    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-402_L1C_048-258-9_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0/SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0.zip
run script
2024-01-09T14:23:40.222    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0.zip
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:40.224    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103552-543_L1C_048-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:23:43.533    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:43.535    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103600-812_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0/SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0.zip
run script
2024-01-09T14:23:46.751    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:46.752    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0.zip
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:46.753    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103601-715_L1C_048-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0/SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0.zip
run script
2024-01-09T14:23:49.940    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:23:49.941    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0.zip
2024-01-09T14:23:49.941    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:23:49.941    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:23:49.942    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000921-103620-415_L1C_050-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/21/SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0/SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0.zip
run script
2024-01-09T14:24:20.643    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.644    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0.zip
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:20.645    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000921-103620-247_L1C_050-262-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/05/SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0/SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0.zip
run script
2024-01-09T14:24:53.887    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0.zip
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:53.888    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103508-663_L1C_048-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/05/SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:24:57.460    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:24:57.461    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103512-423_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/05/SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:25:01.012    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:25:01.013    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103520-704_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/05/SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0/SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T14:25:04.752    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0.zip
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:25:04.753    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103446-746_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/05/SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0/SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0.zip
run script
2024-01-09T14:28:13.369    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0.zip
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:28:13.370    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:28:13.371    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:28:13.371    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:28:13.371    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000705-103450-356_L1C_051-257-7_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 0 1 1]
 [2 2 2 ... 0 0 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/13/SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:31:19.267    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:19.267    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:31:19.267    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:19.267    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:19.268    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105817-143_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/13/SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0/SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0.zip
run script
2024-01-09T14:31:22.337    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0.zip
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:22.338    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000613-105821-655_L1C_048-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/23/SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0/SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0.zip
run script
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0.zip
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:25.756    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:25.757    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:25.757    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110559-522_L1C_048-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]
 ...
 [2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/23/SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0/SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0.zip
run script
2024-01-09T14:31:33.614    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:33.615    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0.zip
2024-01-09T14:31:33.615    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:33.615    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:33.615    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:33.616    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:33.616    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:33.616    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:33.616    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:33.616    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110604-034_L1C_048-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/06/23/SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0/SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:31:36.784    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:31:36.785    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110534-092_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/23/SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T14:33:18.501    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0.zip
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:33:18.502    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000623-110551-042_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0/SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0.zip
run script
2024-01-09T14:34:00.098    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:00.099    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0.zip
2024-01-09T14:34:00.099    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:00.099    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:00.099    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:00.100    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:00.100    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:00.100    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:00.100    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:00.100    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-030_L1C_048-260-9_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:34:03.787    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:03.788    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:34:03.788    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:03.788    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:03.788    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:03.788    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:03.789    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:03.789    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:03.789    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:03.789    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102748-162_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T14:34:07.339    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0.zip
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:07.341    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102756-428_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0/SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0.zip
run script
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0.zip
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:10.625    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:34:13.434    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 918). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102654-331_L1C_050-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T14:34:16.457    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0.zip
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:34:16.458    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102657-125_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T14:35:09.425    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0.zip
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:35:09.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102705-343_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T14:37:53.297    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:37:53.298    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0.zip
2024-01-09T14:37:53.298    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:37:53.298    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:37:53.298    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:37:53.299    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:37:53.299    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:37:53.299    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:37:53.299    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:37:53.299    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102713-570_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T14:40:39.635    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0.zip
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:40:39.637    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:42:29.015    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1866). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102721-809_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T14:42:32.195    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0.zip
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:42:32.196    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:42:32.197    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:42:32.197    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-057_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/21/SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0/SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T14:44:55.153    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0.zip
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:44:55.154    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000721-102730-959_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/13/SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0/SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0.zip
run script
2024-01-09T14:46:38.355    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0.zip
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:38.356    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000413-103032-486_L1C_048-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0/SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0.zip
run script
2024-01-09T14:46:41.591    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0.zip
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:41.592    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:41.593    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:41.593    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:41.593    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105835-641_L1C_048-261-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0/SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0.zip
run script
2024-01-09T14:46:44.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:44.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0.zip
2024-01-09T14:46:44.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:44.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:44.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:44.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:44.702    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:44.702    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:44.702    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:44.702    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105840-153_L1C_048-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0/SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0.zip
run script
2024-01-09T14:46:47.880    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0.zip
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:46:47.881    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:46:47.882    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000709-105815-073_L1C_051-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/09/SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0/SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0.zip
run script
2024-01-09T14:50:39.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0.zip
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:50:39.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000709-105815-536_L1C_053-259-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/21/SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0/SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0.zip
run script
2024-01-09T14:53:55.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:55.431    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0.zip
2024-01-09T14:53:55.431    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:55.431    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:55.432    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102907-103_L1C_049-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/21/SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0/SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0.zip
run script
2024-01-09T14:53:58.489    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:53:58.490    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0.zip
2024-01-09T14:53:58.490    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:53:58.490    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:53:58.490    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:53:58.490    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:53:58.491    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:53:58.491    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:53:58.491    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:53:58.491    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102915-318_L1C_049-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/21/SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0/SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0.zip
run script
2024-01-09T14:54:37.925    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0.zip
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:54:37.926    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T14:55:58.498    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (3356 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000221-102923-544_L1C_049-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0/SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T14:56:01.990    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:56:01.991    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0.zip
2024-01-09T14:56:01.991    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:56:01.991    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:56:01.991    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:56:01.991    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:56:01.992    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:56:01.992    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:56:01.992    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:56:01.992    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103041-721_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0/SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T14:57:53.556    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0.zip
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T14:57:53.558    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103048-155_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0/SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T15:00:01.406    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0.zip
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:00:01.408    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103056-403_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:01:11.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:01:11.508    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:01:11.509    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:01:11.509    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:01:11.509    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103104-660_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:02:14.378    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:02:14.379    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103112-923_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/30/SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0/SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0.zip
run script
2024-01-09T15:02:58.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0.zip
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:02:58.427    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000630-103121-198_L1C_049-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0/SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0.zip
run script
2024-01-09T15:03:29.949    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:03:29.951    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0.zip
2024-01-09T15:03:29.954    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:03:29.956    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:03:29.959    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:03:29.959    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:03:29.959    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:03:29.959    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:03:29.959    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:03:29.960    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:04:54.865    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (3372 x 0). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103924-956_L1C_049-256-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0/SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0.zip
run script
2024-01-09T15:04:57.805    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0.zip
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:04:57.806    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103931-420_L1C_049-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0/SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0.zip
run script
2024-01-09T15:06:13.982    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0.zip
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:06:13.983    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:06:13.984    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:06:13.984    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103939-698_L1C_049-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0/SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0.zip
run script
2024-01-09T15:07:10.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:07:10.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0.zip
2024-01-09T15:07:10.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:07:10.964    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000926-103940-601_L1C_049-258-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0/SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0.zip
run script
2024-01-09T15:08:03.964    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:03.965    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0.zip
2024-01-09T15:08:03.965    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:03.965    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:03.965    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:03.966    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:03.966    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:03.966    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:03.966    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:03.966    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:08:05.430    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 93). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103924-652_L1C_051-256-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0/SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0.zip
run script
2024-01-09T15:08:08.339    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:08:08.340    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0.zip
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:08:08.341    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103928-436_L1C_051-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T15:11:11.126    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:11:11.127    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0.zip
2024-01-09T15:11:11.127    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:11:11.127    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:11:11.127    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:11:11.128    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:11:11.128    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:11:11.128    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:11:11.128    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:11:11.128    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:12:23.978    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 290). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103936-741_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0/SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0.zip
run script
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0.zip
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:12:27.143    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:12:27.144    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:12:27.144    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:12:27.144    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103941-253_L1C_051-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0/SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0.zip
run script
2024-01-09T15:15:22.692    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0.zip
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:15:22.693    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:15:22.694    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:15:22.694    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:15:22.694    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-103958-790_L1C_051-260-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0/SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0.zip
run script
2024-01-09T15:17:48.808    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0.zip
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:17:48.809    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:17:48.810    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:17:48.810    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104001-702_L1C_051-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T15:20:07.431    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0.zip
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:20:07.432    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:20:07.433    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:21:53.634    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (208 x 1). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104010-034_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/26/SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0/SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0.zip
run script
2024-01-09T15:21:56.464    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0.zip
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:21:56.466    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000926-104018-155_L1C_051-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/03/SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0/SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T15:22:41.404    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0.zip
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:22:41.405    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:22:41.406    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:22:41.406    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:22:41.406    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104600-133_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/03/SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:23:41.778    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:23:41.779    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:23:41.780    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104603-051_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/03/SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:24:31.599    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:31.600    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:31.601    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104611-389_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/03/SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0/SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0.zip
run script
2024-01-09T15:24:57.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:24:57.917    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0.zip
2024-01-09T15:24:57.917    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:24:57.917    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:24:57.917    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:24:57.917    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:24:57.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:24:57.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:24:57.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:24:57.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000503-104614-096_L1C_049-260-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0/SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T15:25:23.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:25:23.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0.zip
2024-01-09T15:25:23.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:25:23.077    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110135-975_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:26:43.048    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:26:43.049    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:26:43.050    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:26:43.050    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:26:43.050    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110139-916_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:27:47.543    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:27:47.544    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:27:47.545    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:27:47.545    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110148-368_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/05/23/SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0/SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0.zip
run script
2024-01-09T15:28:23.916    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0.zip
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:28:23.918    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000523-110152-880_L1C_049-260-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/03/SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0/SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0.zip
run script
2024-01-09T15:28:47.825    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:28:47.826    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0.zip
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:28:47.827    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105017-206_L1C_049-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/03/SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:29:53.608    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:29:53.609    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:29:53.610    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:29:53.610    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:29:53.610    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105020-153_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/03/SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:30:53.639    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:30:53.640    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105028-519_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/03/SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0/SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0.zip
run script
2024-01-09T15:31:27.709    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:31:27.710    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0.zip
2024-01-09T15:31:27.710    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:31:27.710    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:31:27.711    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105029-421_L1C_049-260-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/03/SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0/SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0.zip
run script
2024-01-09T15:31:59.872    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0.zip
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:31:59.874    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000603-105045-658_L1C_052-262-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0/SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0.zip
run script
2024-01-09T15:33:56.983    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0.zip
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:33:56.985    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105431-528_L1C_049-258-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:35:21.502    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:35:21.504    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105435-406_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/30/SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0/SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0.zip
run script
2024-01-09T15:36:28.345    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0.zip
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:36:28.346    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000730-105443-801_L1C_049-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/04/27/SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0/SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0.zip
run script
2024-01-09T15:37:11.206    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:37:11.207    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0.zip
2024-01-09T15:37:11.207    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:37:11.207    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:37:11.207    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:37:11.207    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:37:11.208    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:37:11.208    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:37:11.208    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:37:11.208    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000427-110124-776_L1C_049-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/04/SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0/SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0.zip
run script
2024-01-09T15:38:14.194    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0.zip
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:14.195    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:14.196    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:14.196    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105725-704_L1C_049-261-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/02/04/SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0/SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0.zip
run script
2024-01-09T15:38:17.028    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0.zip
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:17.030    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:17.031    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:17.031    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:17.031    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000204-105728-718_L1C_049-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0/SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0.zip
run script
2024-01-09T15:38:20.151    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0.zip
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:20.152    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:20.153    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:20.153    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:20.153    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102318-892_L1C_050-254-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T15:38:28.966    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0.zip
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:38:28.967    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102321-671_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0/SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0.zip
run script
2024-01-09T15:39:26.318    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0.zip
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:39:26.319    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102329-877_L1C_050-256-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0/SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0.zip
run script
2024-01-09T15:42:09.541    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0.zip
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:42:09.542    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102338-095_L1C_050-257-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T15:44:54.569    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0.zip
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:44:54.570    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T15:46:44.545    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1946). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102346-319_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T15:46:47.602    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0.zip
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:46:47.604    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102354-555_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0/SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T15:48:37.700    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0.zip
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:48:37.701    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102355-457_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0/SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0.zip
run script
2024-01-09T15:50:23.650    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0.zip
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:50:23.652    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102412-137_L1C_054-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/11/SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T15:52:32.171    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0.zip
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:52:32.173    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000811-102415-906_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/06/SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0/SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0.zip
run script
2024-01-09T15:54:36.907    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0.zip
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:54:36.908    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:54:36.909    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101750-090_L1C_050-255-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/02/06/SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0/SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0.zip
run script
2024-01-09T15:55:34.187    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:55:34.188    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0.zip
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:55:34.189    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000206-101756-407_L1C_050-255-7_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/18/SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0/SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T15:58:09.930    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T15:58:09.931    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0.zip
2024-01-09T15:58:09.931    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T15:58:09.931    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T15:58:09.931    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T15:58:09.931    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T15:58:09.932    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T15:58:09.932    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T15:58:09.932    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T15:58:09.932    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000618-110146-896_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:01:40.130    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:01:40.131    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102701-210_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:04:04.507    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:04:04.508    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:04:04.508    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:04:04.508    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:04:04.509    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:05:49.736    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1874). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102704-937_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:05:52.813    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:05:52.814    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:05:52.814    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:05:52.814    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:05:52.814    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:05:52.814    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:05:52.815    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:05:52.815    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:05:52.815    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:05:52.815    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102713-182_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0/SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0.zip
run script
2024-01-09T16:07:33.282    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0.zip
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:07:33.283    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:07:33.284    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:07:33.284    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102730-719_L1C_051-261-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0/SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0.zip
run script
2024-01-09T16:09:26.987    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0.zip
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:09:26.989    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102737-192_L1C_051-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/06/25/SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0/SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0.zip
run script
2024-01-09T16:10:53.379    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:10:53.380    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0.zip
2024-01-09T16:10:53.380    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:10:53.380    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:10:53.380    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:10:53.381    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:10:53.381    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:10:53.381    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:10:53.381    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:10:53.381    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000625-102745-476_L1C_051-263-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [2 2 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/10/SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:11:26.375    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:11:26.376    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:11:26.376    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:11:26.376    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:11:26.376    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:11:26.377    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:11:26.377    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:11:26.377    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:11:26.377    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:11:26.377    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104301-306_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 2 0]
 [2 2 2 ... 0 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/10/SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:13:39.962    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:13:39.963    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:15:21.200    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1778). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104305-105_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/10/SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:15:24.232    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:15:24.233    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:15:24.234    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000810-104313-425_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/15/SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:16:59.120    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:16:59.121    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:16:59.121    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:16:59.121    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:16:59.121    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:16:59.121    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:16:59.122    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:16:59.122    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:16:59.122    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:16:59.122    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104656-528_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/15/SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:19:31.663    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:19:31.664    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:19:31.664    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:19:31.665    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:21:13.238    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 450). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104700-354_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/15/SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:21:16.371    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:21:16.372    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000815-104708-698_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0/SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0.zip
run script
2024-01-09T16:22:59.970    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:22:59.971    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0.zip
2024-01-09T16:22:59.971    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:22:59.971    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:22:59.971    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:22:59.972    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:22:59.972    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:22:59.972    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:22:59.972    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:22:59.972    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102738-990_L1C_050-257-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:25:29.397    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:25:29.402    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:25:29.405    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:25:29.408    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:25:29.408    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:25:29.408    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:25:29.409    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:25:29.409    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:25:29.409    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:25:29.409    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:27:13.521    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 962). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102741-814_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/16/SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0/SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T16:27:16.518    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0.zip
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:27:16.519    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:29:05.418    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (118 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000816-102750-965_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/21/SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0/SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0.zip
run script
2024-01-09T16:29:08.542    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0.zip
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:29:08.543    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:29:08.544    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103132-450_L1C_050-257-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 0]
 [2 2 2 ... 2 0 0]
 [2 2 2 ... 2 0 0]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/21/SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:31:20.200    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:31:20.202    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:32:59.904    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 1850). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103136-192_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/21/SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:33:02.763    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:33:02.764    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:33:02.764    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:33:02.764    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:33:02.765    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103144-452_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/21/SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0/SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0.zip
run script
2024-01-09T16:34:40.036    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0.zip
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:34:40.037    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000821-103216-619_L1C_051-262-9_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/25/SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:35:08.699    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:35:08.702    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:35:08.702    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:35:08.702    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:35:08.702    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:35:08.702    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:35:08.703    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:35:08.703    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:35:08.703    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:35:08.703    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:36:59.040    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (1 x 230). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000725-105031-796_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/05/SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0/SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:37:01.843    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:37:01.845    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:37:01.848    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:37:01.850    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:37:01.854    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:37:01.857    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:37:01.860    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:37:01.863    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:37:01.865    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:37:01.868    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:38:36.681    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 440). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103907-643_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/05/SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0/SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0.zip
run script
2024-01-09T16:38:39.263    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0.zip
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:38:39.264    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:38:39.265    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:38:39.265    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:40:27.806    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (242 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000805-103916-845_L1C_050-259-1_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0/SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0.zip
run script
2024-01-09T16:40:30.426    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:40:30.427    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0.zip
2024-01-09T16:40:30.427    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:40:30.428    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:42:32.432    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (2 x 538). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101948-556_L1C_050-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0/SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:42:35.053    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:42:35.054    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101956-783_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0/SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0.zip
run script
2024-01-09T16:44:58.529    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:44:58.530    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0.zip
2024-01-09T16:44:58.530    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:44:58.530    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:44:58.531    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-101958-588_L1C_050-259-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[0 0 2 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0/SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0.zip
run script
2024-01-09T16:47:09.445    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:47:09.446    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0.zip
2024-01-09T16:47:09.446    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:47:09.446    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:47:09.447    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102014-855_L1C_054-261-5_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0/SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0.zip
run script
2024-01-09T16:49:20.420    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0.zip
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:49:20.421    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:49:20.422    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102018-612_L1C_054-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/08/06/SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0/SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0.zip
run script
2024-01-09T16:51:30.113    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0.zip
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:51:30.114    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000806-102020-417_L1C_054-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0/SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0.zip
run script
2024-01-09T16:53:41.901    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0.zip
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:53:41.902    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:53:41.903    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:53:41.903    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103149-673_L1C_050-258-6_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0/SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0.zip
run script
2024-01-09T16:55:38.403    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0.zip
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:55:38.404    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T16:57:25.921    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (204 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103152-522_L1C_050-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0/SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0.zip
run script
2024-01-09T16:57:28.989    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:57:28.989    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0.zip
2024-01-09T16:57:28.989    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:57:28.989    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:57:28.990    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103209-069_L1C_050-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0/SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0.zip
run script
2024-01-09T16:58:43.882    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0.zip
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:58:43.883    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103217-356_L1C_050-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0/SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0.zip
run script
2024-01-09T16:59:36.727    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T16:59:36.728    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0.zip
2024-01-09T16:59:36.728    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T16:59:36.729    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000916-103219-161_L1C_050-262-2_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0/SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0.zip
run script
2024-01-09T17:00:26.080    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:00:26.081    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0.zip
2024-01-09T17:00:26.081    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:00:26.081    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:00:26.081    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:00:26.081    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:00:26.082    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:00:26.082    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:00:26.082    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:00:26.082    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103150-019_L1C_051-258-8_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0/SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T17:03:13.891    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0.zip
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:03:13.892    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:03:13.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103151-072_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 [1 1 1 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0/SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0.zip
run script
2024-01-09T17:06:01.216    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:06:01.217    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0.zip
2024-01-09T17:06:01.217    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:06:01.217    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:06:01.218    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103159-353_L1C_051-260-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0/SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0.zip
run script
2024-01-09T17:08:25.589    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0.zip
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:08:25.590    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103207-643_L1C_052-261-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0/SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0.zip
run script
2024-01-09T17:11:07.768    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0.zip
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:11:07.769    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103215-939_L1C_052-262-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/09/16/SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0/SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0.zip
run script
2024-01-09T17:13:04.548    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0.zip
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:13:04.550    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
2024-01-09T17:14:43.669    ERROR:run_snow_swh.py::main:Calculated padded input size per channel: (738 x 2). Kernel size: (3 x 3). Kernel size can't be greater than actual input size
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000916-103219-549_L1C_052-262-4_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
geo data
copy to output
TOTO
muscate/SPOTWORLDHERITAGE/2000/05/20/SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0/SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T17:14:46.856    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0.zip
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:46.857    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:46.858    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:46.858    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:46.858    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000520-101822-003_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/20/SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0/SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0.zip
run script
2024-01-09T17:14:49.912    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0.zip
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:49.913    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:49.914    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:49.914    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:49.914    INFO:run_snow_swh.py::main:Launch snow detection.
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104606-336_L1C_051-254-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
INPUT SWH SCENE DOES NOT OVERLAP ANY S2 TILE WITH AVAILABLE MODEL
muscate/SPOTWORLDHERITAGE/2000/07/20/SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0/SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0.zip
run script
2024-01-09T17:14:52.861    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:14:52.861    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0.zip
2024-01-09T17:14:52.861    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:14:52.861    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:14:52.862    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV2-XS_20000720-104613-555_L1C_051-254-8_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/20/SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0/SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0.zip
run script
2024-01-09T17:15:33.075    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0.zip
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:15:33.076    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104633-252_L1C_051-257-3_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 1 0 0]
 [2 2 2 ... 1 1 0]
 [2 2 2 ... 1 1 1]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]
 [2 2 2 ... 1 1 1]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/20/SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0/SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0.zip
run script
2024-01-09T17:18:58.558    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:18:58.559    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0.zip
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:18:58.560    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104638-901_L1C_051-258-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
muscate/SPOTWORLDHERITAGE/2000/07/20/SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0/SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0.zip
activate s3 conda env
start s2 script
get credentials
get s3filesystem
download
SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0.zip
/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0.zip
run script
2024-01-09T17:22:05.892    INFO:run_snow_swh.py::main:output directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:input file : /tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0.zip
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:dem directory : /work/CAMPUS/etudes/Neige/DEM
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:tree cover density directory : /work/datalake/static_aux/TreeCoverDensity
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:model directory : /work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:model type : mtn
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:keep merged bands : None
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:mask inference : None
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:no data buffer : 2000
2024-01-09T17:22:05.893    INFO:run_snow_swh.py::main:Launch snow detection.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
0...10...20...30...40...50...60...70...80...90...100 - done.
/work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /work/scratch/env/barrouz/conda_env/pl_lightning/lib/python3.8/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSs
  warn(f"Failed to load image Python extension: {e}")
Namespace(buffer=None, dem_dir='/work/CAMPUS/etudes/Neige/DEM', input_file='/tmp/slurm-4016145/INPUT/SPOT1-HRV1-XS_20000720-104647-260_L1C_051-259-0_D_V1-0.zip', job_dir='/tmp/slurm-4016145/OUTPUT', json_config_file=None, keep='0', log_level=None, mask='1', model_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/MODELS/TCD-ONLY_AVG-1200', model_type='mtn', output_dir='/work/CAMPUS/etudes/Neige/CoSIMS/zacharie/TIMESERIES_PROJECT/SWH_INFERENCE/ALP/TCD-ONLY_AVG-1200', tcd_dir='/work/datalake/static_aux/TreeCoverDensity')
DEVICE cpu
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 2 2 ... 0 2 2]
 [2 2 2 ... 0 0 2]
 [2 2 2 ... 0 0 0]]
geo data
copy to output
TOTO
[[0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 ...
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]]
geo data
copy to output
TOTO
[[2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 [2 2 2 ... 2 2 2]
 ...
 [2 0 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]
 [0 2 0 ... 2 2 2]]
geo data
copy to output
end
[2024-01-09 17:25:18.645804674+00:00] cnes_level2/barrouz/4016145:  Account (env) = cnes_level2
[2024-01-09 17:25:18.647435904+00:00] cnes_level2/barrouz/4016145:     User (env) = barrouz
[2024-01-09 17:25:18.648964926+00:00] cnes_level2/barrouz/4016145:        GroupId = cesbio(426000053)
[2024-01-09 17:25:18.650190199+00:00] cnes_level2/barrouz/4016145:         UserId = barrouz(9134)
[2024-01-09 17:25:18.651439111+00:00] cnes_level2/barrouz/4016145:        Account = cnes_level2
[2024-01-09 17:25:18.652766614+00:00] cnes_level2/barrouz/4016145:        Account = cnes_level2
[2024-01-09 17:25:18.654039897+00:00] cnes_level2/barrouz/4016145:      Partition = cpu2022
[2024-01-09 17:25:18.655293949+00:00] cnes_level2/barrouz/4016145:            QOS = cpu_2022_1280
[2024-01-09 17:25:18.656563002+00:00] cnes_level2/barrouz/4016145:        JobName = inf_ALP_39_TCD-ONLY_AVG-1200
[2024-01-09 17:25:18.657754575+00:00] cnes_level2/barrouz/4016145:     SubmitTime = 2024-01-09T10:51:19
[2024-01-09 17:25:18.659026318+00:00] cnes_level2/barrouz/4016145:        RunTime = 06:03:27
[2024-01-09 17:25:18.660346410+00:00] cnes_level2/barrouz/4016145:      TimeLimit = 1-16:00:00
[2024-01-09 17:25:18.661635423+00:00] cnes_level2/barrouz/4016145:   EligibleTime = 2024-01-09T10:51:19
[2024-01-09 17:25:18.662842416+00:00] cnes_level2/barrouz/4016145:      StartTime = 2024-01-09T11:21:51
[2024-01-09 17:25:18.664073209+00:00] cnes_level2/barrouz/4016145:        EndTime = 2024-01-09T17:25:18
[2024-01-09 17:25:18.665316912+00:00] cnes_level2/barrouz/4016145:       ExitCode = 0:0
[2024-01-09 17:25:18.666487895+00:00] cnes_level2/barrouz/4016145:       NodeList = trex011
[2024-01-09 17:25:18.667787948+00:00] cnes_level2/barrouz/4016145:      BatchHost = trex011
[2024-01-09 17:25:18.669068180+00:00] cnes_level2/barrouz/4016145:           TRES = 
[2024-01-09 17:25:18.670335823+00:00] cnes_level2/barrouz/4016145:        Command = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
[2024-01-09 17:25:18.671627146+00:00] cnes_level2/barrouz/4016145:        WorkDir = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code
[2024-01-09 17:25:18.672900198+00:00] cnes_level2/barrouz/4016145:         StdErr = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_39_TCD-ONLY_AVG-1200.log
[2024-01-09 17:25:18.674151781+00:00] cnes_level2/barrouz/4016145:         StdOut = /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_39_TCD-ONLY_AVG-1200.log

#########################################
#        EVIDEN - CNES                  #
#        Job Accounting                 #
#########################################
Cluster              : trex
JobIDRaw             : 4016145
JobID                : 4016145
JobName              : inf_ALP_39_TCD-ONLY_AVG-1200
Account              : cnes_level2
User                 : barrouz(9134), cesbio(426000053)
Partition            : cpu2022
QOS                  : cpu_2022_1280
Nodelist             : trex011 (1)
State                : COMPLETED  (Exitcode=0:0, DerivedExitCode=0:0, Restarts=0)
Submit date          : 2024-01-09T10:51:19
Start time           : 2024-01-09T11:21:51
End time             : 2024-01-09T17:25:18
Elapsed time         : 06:03:27  (Timelimit=1-16:00:00, Suspended=00:00:00)
TEI                  : 2 days, 0:27:36
Command              : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_unet/run_snow_swh_job.sh
StdOut               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_39_TCD-ONLY_AVG-1200.log
StdErr               : /home/ad/barrouz/WORKSPACE/TIMESERIES_PROJECT/inference_code/logs/inf_ALP_39_TCD-ONLY_AVG-1200.log

STEP(s) : 2
--------- 
   StepID  | JobName      State       Exit   Start               End                 Elapsed   TotalCPU   CPUTime    ConsumedEnergy MaxDiskRead MaxDiskWrite     MaxRSS MaxRSSTask MaxRSSNode NNodes UserCPU    NodeList
   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
   batch   | batch        COMPLETED   0:0    2024-01-09T11:21:51 2024-01-09T17:25:18 06:03:27  1-05:53:34 2-00:27:36         0.175M  179549.97M    71575.21M  90380296K          0    trex011      1 21:41:55   trex011
   extern  | extern       COMPLETED   0:0    2024-01-09T11:21:51 2024-01-09T17:25:18 06:03:27  00:00.001  2-00:27:36         0.175M       0.00M        0.00M      1672K          0    trex011      1 00:00:00   trex011

